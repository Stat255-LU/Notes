<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Bootstrap Interval Estimation | Stat 255: Statistics for Data Science Notes</title>
  <meta name="description" content="Chapter 4 Bootstrap Interval Estimation | Stat 255: Statistics for Data Science Notes" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Bootstrap Interval Estimation | Stat 255: Statistics for Data Science Notes" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Bootstrap Interval Estimation | Stat 255: Statistics for Data Science Notes" />
  
  
  

<meta name="author" content="Andrew Sage - Lawrence University" />


<meta name="date" content="2023-10-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="hypothesis-testing-via-permutation.html"/>
<link rel="next" href="normal-error-regression-model.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STAT 255 Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>1</b> Exploratory Data Analysis</a>
<ul>
<li class="chapter" data-level="1.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#getting-started-in-r"><i class="fa fa-check"></i><b>1.1</b> Getting Started in R</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#previewing-the-data"><i class="fa fa-check"></i><b>1.1.1</b> Previewing the Data</a></li>
<li class="chapter" data-level="1.1.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#modifying-the-data"><i class="fa fa-check"></i><b>1.1.2</b> Modifying the Data</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#data-visualization"><i class="fa fa-check"></i><b>1.2</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#histogram"><i class="fa fa-check"></i><b>1.2.1</b> Histogram</a></li>
<li class="chapter" data-level="1.2.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#density-plot"><i class="fa fa-check"></i><b>1.2.2</b> Density Plot</a></li>
<li class="chapter" data-level="1.2.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#boxplot"><i class="fa fa-check"></i><b>1.2.3</b> Boxplot</a></li>
<li class="chapter" data-level="1.2.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#violin-plot"><i class="fa fa-check"></i><b>1.2.4</b> Violin Plot</a></li>
<li class="chapter" data-level="1.2.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#scatterplot"><i class="fa fa-check"></i><b>1.2.5</b> Scatterplot</a></li>
<li class="chapter" data-level="1.2.6" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#bar-graph"><i class="fa fa-check"></i><b>1.2.6</b> Bar Graph</a></li>
<li class="chapter" data-level="1.2.7" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#stacked-and-side-by-side-bar-graphs"><i class="fa fa-check"></i><b>1.2.7</b> Stacked and Side-by-Side Bar Graphs</a></li>
<li class="chapter" data-level="1.2.8" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#correlation-plot"><i class="fa fa-check"></i><b>1.2.8</b> Correlation Plot</a></li>
<li class="chapter" data-level="1.2.9" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#scatterplot-matrix"><i class="fa fa-check"></i><b>1.2.9</b> Scatterplot Matrix</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#summary-tables"><i class="fa fa-check"></i><b>1.3</b> Summary Tables</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#calculating-summary-statistics"><i class="fa fa-check"></i><b>1.3.1</b> Calculating Summary Statistics</a></li>
<li class="chapter" data-level="1.3.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#grouped-summaries"><i class="fa fa-check"></i><b>1.3.2</b> Grouped Summaries</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html"><i class="fa fa-check"></i><b>2</b> Introduction to Statistical Models</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#fitting-models-to-data"><i class="fa fa-check"></i><b>2.1</b> Fitting Models to Data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#terminology"><i class="fa fa-check"></i><b>2.1.1</b> Terminology</a></li>
<li class="chapter" data-level="2.1.2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#model-with-quantitative-explanatory-variable"><i class="fa fa-check"></i><b>2.1.2</b> Model with Quantitative Explanatory Variable</a></li>
<li class="chapter" data-level="2.1.3" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#model-with-categorical-variable"><i class="fa fa-check"></i><b>2.1.3</b> Model with Categorical Variable</a></li>
<li class="chapter" data-level="2.1.4" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#model-with-multiple-explanatory-variables"><i class="fa fa-check"></i><b>2.1.4</b> Model with Multiple Explanatory Variables</a></li>
<li class="chapter" data-level="2.1.5" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#model-with-no-explanatory-variable"><i class="fa fa-check"></i><b>2.1.5</b> Model with No Explanatory Variable</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#variability-explained-by-a-model"><i class="fa fa-check"></i><b>2.2</b> Variability Explained by a Model</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#quantifying-variability"><i class="fa fa-check"></i><b>2.2.1</b> Quantifying Variability</a></li>
<li class="chapter" data-level="2.2.2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#total-variability"><i class="fa fa-check"></i><b>2.2.2</b> Total Variability</a></li>
<li class="chapter" data-level="2.2.3" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#residuals"><i class="fa fa-check"></i><b>2.2.3</b> Residuals</a></li>
<li class="chapter" data-level="2.2.4" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#variability-explained-by-sq.-ft.-model"><i class="fa fa-check"></i><b>2.2.4</b> Variability Explained by Sq. Ft. Model</a></li>
<li class="chapter" data-level="2.2.5" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#linear-correlation-coefficient"><i class="fa fa-check"></i><b>2.2.5</b> Linear Correlation Coefficient</a></li>
<li class="chapter" data-level="2.2.6" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#variability-explained-by-waterfront-model"><i class="fa fa-check"></i><b>2.2.6</b> Variability Explained by Waterfront Model</a></li>
<li class="chapter" data-level="2.2.7" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#variability-explained-by-multiple-regression-model"><i class="fa fa-check"></i><b>2.2.7</b> Variability Explained by Multiple Regression Model</a></li>
<li class="chapter" data-level="2.2.8" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#summary-sst-ssr-ssm-r2"><i class="fa fa-check"></i><b>2.2.8</b> Summary: SST, SSR, SSM, <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="2.2.9" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#r2-visually"><i class="fa fa-check"></i><b>2.2.9</b> <span class="math inline">\(R^2\)</span> Visually</a></li>
<li class="chapter" data-level="2.2.10" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#model-comparison-summary"><i class="fa fa-check"></i><b>2.2.10</b> Model Comparison Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#models-with-interaction"><i class="fa fa-check"></i><b>2.3</b> Models with Interaction</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#definition-of-interaction"><i class="fa fa-check"></i><b>2.3.1</b> Definition of Interaction</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#interaction-term"><i class="fa fa-check"></i><b>2.3.2</b> Interaction Term</a></li>
<li class="chapter" data-level="2.3.3" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#interaction-models-in-r"><i class="fa fa-check"></i><b>2.3.3</b> Interaction Models in R</a></li>
<li class="chapter" data-level="2.3.4" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#r2-for-interaction-model"><i class="fa fa-check"></i><b>2.3.4</b> <span class="math inline">\(R^2\)</span> for Interaction Model</a></li>
<li class="chapter" data-level="2.3.5" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#considerations-for-using-interactions"><i class="fa fa-check"></i><b>2.3.5</b> Considerations for Using Interactions</a></li>
<li class="chapter" data-level="2.3.6" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#interaction-vs-correlation"><i class="fa fa-check"></i><b>2.3.6</b> Interaction vs Correlation</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#least-squares-estimation-lse"><i class="fa fa-check"></i><b>2.4</b> Least Squares Estimation (LSE)</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#estimating-regression-coefficients"><i class="fa fa-check"></i><b>2.4.1</b> Estimating Regression Coefficients</a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#mathematics-of-lse-for-slr"><i class="fa fa-check"></i><b>2.4.2</b> Mathematics of LSE for SLR</a></li>
<li class="chapter" data-level="2.4.3" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#lse-for-categorical-variable"><i class="fa fa-check"></i><b>2.4.3</b> LSE for Categorical Variable</a></li>
<li class="chapter" data-level="2.4.4" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#lse-more-generally"><i class="fa fa-check"></i><b>2.4.4</b> LSE More Generally</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#analysis-of-variance"><i class="fa fa-check"></i><b>2.5</b> ANalysis Of VAriance</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#submodels"><i class="fa fa-check"></i><b>2.5.1</b> Submodels</a></li>
<li class="chapter" data-level="2.5.2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#f-statistics"><i class="fa fa-check"></i><b>2.5.2</b> F-Statistics</a></li>
<li class="chapter" data-level="2.5.3" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#comparing-3-or-more-categories"><i class="fa fa-check"></i><b>2.5.3</b> Comparing 3 or More Categories</a></li>
<li class="chapter" data-level="2.5.4" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#f-statistic-illustration"><i class="fa fa-check"></i><b>2.5.4</b> F-Statistic Illustration</a></li>
<li class="chapter" data-level="2.5.5" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#alternative-f-statistic-formula"><i class="fa fa-check"></i><b>2.5.5</b> Alternative F-Statistic Formula</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html"><i class="fa fa-check"></i><b>3</b> Hypothesis Testing via Permutation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#test-for-difference-in-means"><i class="fa fa-check"></i><b>3.1</b> Test for Difference in Means</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#mercury-levels-in-florida-lakes"><i class="fa fa-check"></i><b>3.1.1</b> Mercury Levels in Florida Lakes</a></li>
<li class="chapter" data-level="3.1.2" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#model-for-mercury-level"><i class="fa fa-check"></i><b>3.1.2</b> Model for Mercury Level</a></li>
<li class="chapter" data-level="3.1.3" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#hypotheses-and-key-question"><i class="fa fa-check"></i><b>3.1.3</b> Hypotheses and Key Question</a></li>
<li class="chapter" data-level="3.1.4" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#permutation-test-for-difference-in-means"><i class="fa fa-check"></i><b>3.1.4</b> Permutation Test for Difference in Means</a></li>
<li class="chapter" data-level="3.1.5" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#five-permutations-in-r"><i class="fa fa-check"></i><b>3.1.5</b> Five Permutations in R</a></li>
<li class="chapter" data-level="3.1.6" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#r-code-for-permutation-test"><i class="fa fa-check"></i><b>3.1.6</b> R Code for Permutation Test</a></li>
<li class="chapter" data-level="3.1.7" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#p-values"><i class="fa fa-check"></i><b>3.1.7</b> p-values</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#general-permutation-tests"><i class="fa fa-check"></i><b>3.2</b> General Permutation Tests</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#other-test-statistics"><i class="fa fa-check"></i><b>3.2.1</b> Other Test Statistics</a></li>
<li class="chapter" data-level="3.2.2" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#general-permutation-test-procedure"><i class="fa fa-check"></i><b>3.2.2</b> General Permutation Test Procedure</a></li>
<li class="chapter" data-level="3.2.3" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#difference-in-standard-deviation"><i class="fa fa-check"></i><b>3.2.3</b> Difference in Standard Deviation</a></li>
<li class="chapter" data-level="3.2.4" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#permutation-test-for-slope"><i class="fa fa-check"></i><b>3.2.4</b> Permutation Test for Slope</a></li>
<li class="chapter" data-level="3.2.5" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#f-statistic"><i class="fa fa-check"></i><b>3.2.5</b> F-Statistic</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#responsible-hypothesis-testing"><i class="fa fa-check"></i><b>3.3</b> Responsible Hypothesis Testing</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html"><i class="fa fa-check"></i><b>4</b> Bootstrap Interval Estimation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#sampling-distributions"><i class="fa fa-check"></i><b>4.1</b> Sampling Distributions</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#sampling-from-a-population"><i class="fa fa-check"></i><b>4.1.1</b> Sampling From a Population</a></li>
<li class="chapter" data-level="4.1.2" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#confidence-intervals"><i class="fa fa-check"></i><b>4.1.2</b> Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#bootstrapping"><i class="fa fa-check"></i><b>4.2</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#mercury-levels-in-florida-lakes-1"><i class="fa fa-check"></i><b>4.2.1</b> Mercury Levels in Florida Lakes</a></li>
<li class="chapter" data-level="4.2.2" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#bootstrap-sampling"><i class="fa fa-check"></i><b>4.2.2</b> Bootstrap Sampling</a></li>
<li class="chapter" data-level="4.2.3" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#bootstrap-samples-of-lakes"><i class="fa fa-check"></i><b>4.2.3</b> Bootstrap Samples of Lakes</a></li>
<li class="chapter" data-level="4.2.4" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#bootstrap-distribution"><i class="fa fa-check"></i><b>4.2.4</b> Bootstrap Distribution</a></li>
<li class="chapter" data-level="4.2.5" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#bootstrap-se-confidence-interval"><i class="fa fa-check"></i><b>4.2.5</b> Bootstrap SE Confidence Interval</a></li>
<li class="chapter" data-level="4.2.6" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#bootstrap-distribution-vs-sampling-distribution"><i class="fa fa-check"></i><b>4.2.6</b> Bootstrap Distribution vs Sampling Distribution</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#bootstrap-confidence-interval-example"><i class="fa fa-check"></i><b>4.3</b> Bootstrap Confidence Interval Example</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#bootstrapping-other-statistics"><i class="fa fa-check"></i><b>4.3.1</b> Bootstrapping Other Statistics</a></li>
<li class="chapter" data-level="4.3.2" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#ci-for-mean"><i class="fa fa-check"></i><b>4.3.2</b> CI for Mean</a></li>
<li class="chapter" data-level="4.3.3" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#ci-for-standard-deviation"><i class="fa fa-check"></i><b>4.3.3</b> CI for Standard Deviation</a></li>
<li class="chapter" data-level="4.3.4" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#ci-for-median"><i class="fa fa-check"></i><b>4.3.4</b> CI for Median</a></li>
<li class="chapter" data-level="4.3.5" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#ci-for-difference-in-means"><i class="fa fa-check"></i><b>4.3.5</b> CI for Difference in Means</a></li>
<li class="chapter" data-level="4.3.6" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#ci-for-regression-slope"><i class="fa fa-check"></i><b>4.3.6</b> CI for Regression Slope</a></li>
<li class="chapter" data-level="4.3.7" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#ci-for-regression-response"><i class="fa fa-check"></i><b>4.3.7</b> CI for Regression Response</a></li>
<li class="chapter" data-level="4.3.8" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#more-cis-in-regression"><i class="fa fa-check"></i><b>4.3.8</b> More CI’s in Regression</a></li>
<li class="chapter" data-level="4.3.9" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#bootstrapping-cautions"><i class="fa fa-check"></i><b>4.3.9</b> Bootstrapping Cautions</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#estimating-standard-error"><i class="fa fa-check"></i><b>4.4</b> Estimating Standard Error</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#standard-error-vs-standard-deviation"><i class="fa fa-check"></i><b>4.4.1</b> Standard Error vs Standard Deviation</a></li>
<li class="chapter" data-level="4.4.2" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#sample-size-and-standard-error"><i class="fa fa-check"></i><b>4.4.2</b> Sample Size and Standard Error</a></li>
<li class="chapter" data-level="4.4.3" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#standard-error-formulas"><i class="fa fa-check"></i><b>4.4.3</b> Standard Error Formulas</a></li>
<li class="chapter" data-level="4.4.4" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#one-sample-mean-example"><i class="fa fa-check"></i><b>4.4.4</b> One-Sample Mean Example</a></li>
<li class="chapter" data-level="4.4.5" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#difference-in-means-example"><i class="fa fa-check"></i><b>4.4.5</b> Difference in Means Example</a></li>
<li class="chapter" data-level="4.4.6" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#regression-example"><i class="fa fa-check"></i><b>4.4.6</b> Regression Example</a></li>
<li class="chapter" data-level="4.4.7" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#theory-based-confidence-intervals"><i class="fa fa-check"></i><b>4.4.7</b> Theory-Based Confidence Intervals</a></li>
<li class="chapter" data-level="4.4.8" data-path="bootstrap-interval-estimation.html"><a href="bootstrap-interval-estimation.html#ci-method-comparison"><i class="fa fa-check"></i><b>4.4.8</b> CI Method Comparison</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html"><i class="fa fa-check"></i><b>5</b> Normal Error Regression Model</a>
<ul>
<li class="chapter" data-level="5.1" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#the-normal-error-regression-model"><i class="fa fa-check"></i><b>5.1</b> The Normal Error Regression Model</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#example-ice-cream-dispenser"><i class="fa fa-check"></i><b>5.1.1</b> Example: Ice Cream dispenser</a></li>
<li class="chapter" data-level="5.1.2" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#signal-and-noise"><i class="fa fa-check"></i><b>5.1.2</b> Signal and Noise</a></li>
<li class="chapter" data-level="5.1.3" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#normal-distribution"><i class="fa fa-check"></i><b>5.1.3</b> Normal Distribution</a></li>
<li class="chapter" data-level="5.1.4" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#signal-and-noise-in-icecream-example"><i class="fa fa-check"></i><b>5.1.4</b> Signal and Noise in Icecream Example</a></li>
<li class="chapter" data-level="5.1.5" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#normal-error-regression-model-1"><i class="fa fa-check"></i><b>5.1.5</b> Normal Error Regression Model</a></li>
<li class="chapter" data-level="5.1.6" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#examples-of-normal-error-regression-model"><i class="fa fa-check"></i><b>5.1.6</b> Examples of Normal Error Regression Model</a></li>
<li class="chapter" data-level="5.1.7" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#implications-of-normal-error-regression-model"><i class="fa fa-check"></i><b>5.1.7</b> Implications of Normal Error Regression Model</a></li>
<li class="chapter" data-level="5.1.8" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#philosophical-question"><i class="fa fa-check"></i><b>5.1.8</b> Philosophical Question</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#inference-in-normal-error-regression-model"><i class="fa fa-check"></i><b>5.2</b> Inference in Normal Error Regression Model</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#lm-summary-output"><i class="fa fa-check"></i><b>5.2.1</b> <code>lm</code> <code>summary</code> Output</a></li>
<li class="chapter" data-level="5.2.2" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#t-distribution"><i class="fa fa-check"></i><b>5.2.2</b> t-distribution</a></li>
<li class="chapter" data-level="5.2.3" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#difference-in-means-example-1"><i class="fa fa-check"></i><b>5.2.3</b> Difference in Means Example</a></li>
<li class="chapter" data-level="5.2.4" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#simple-linear-regression-example"><i class="fa fa-check"></i><b>5.2.4</b> Simple Linear Regression Example</a></li>
<li class="chapter" data-level="5.2.5" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#multiple-regression-example"><i class="fa fa-check"></i><b>5.2.5</b> Multiple Regression Example</a></li>
<li class="chapter" data-level="5.2.6" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#mr-with-interaction-example"><i class="fa fa-check"></i><b>5.2.6</b> MR with Interaction Example</a></li>
<li class="chapter" data-level="5.2.7" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#limitations"><i class="fa fa-check"></i><b>5.2.7</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#f-distributions"><i class="fa fa-check"></i><b>5.3</b> F-Distributions</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#f-distribution"><i class="fa fa-check"></i><b>5.3.1</b> F-Distribution</a></li>
<li class="chapter" data-level="5.3.2" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#house-condition-example"><i class="fa fa-check"></i><b>5.3.2</b> House Condition Example</a></li>
<li class="chapter" data-level="5.3.3" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#interaction-example"><i class="fa fa-check"></i><b>5.3.3</b> Interaction Example</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#regression-model-assumptions"><i class="fa fa-check"></i><b>5.4</b> Regression Model Assumptions</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#regression-assumptions"><i class="fa fa-check"></i><b>5.4.1</b> Regression Assumptions</a></li>
<li class="chapter" data-level="5.4.2" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#checking-model-assumptions"><i class="fa fa-check"></i><b>5.4.2</b> Checking Model Assumptions</a></li>
<li class="chapter" data-level="5.4.3" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#summary-of-checks-for-model-assumptions"><i class="fa fa-check"></i><b>5.4.3</b> Summary of Checks for Model Assumptions</a></li>
<li class="chapter" data-level="5.4.4" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#example-n-v-s-lakes"><i class="fa fa-check"></i><b>5.4.4</b> Example: N v S Lakes</a></li>
<li class="chapter" data-level="5.4.5" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#example-ph-model"><i class="fa fa-check"></i><b>5.4.5</b> Example: pH Model</a></li>
<li class="chapter" data-level="5.4.6" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#example-house-prices"><i class="fa fa-check"></i><b>5.4.6</b> Example: House Prices</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#intervals-for-expected-response"><i class="fa fa-check"></i><b>5.5</b> Intervals for Expected Response</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#parameter-values-and-expected-responses"><i class="fa fa-check"></i><b>5.5.1</b> Parameter Values and Expected Responses</a></li>
<li class="chapter" data-level="5.5.2" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#estimation-and-prediction"><i class="fa fa-check"></i><b>5.5.2</b> Estimation and Prediction</a></li>
<li class="chapter" data-level="5.5.3" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#estimation-and-prediction-in-slr"><i class="fa fa-check"></i><b>5.5.3</b> Estimation and Prediction in SLR</a></li>
<li class="chapter" data-level="5.5.4" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#intervals-in-r"><i class="fa fa-check"></i><b>5.5.4</b> Intervals in R</a></li>
<li class="chapter" data-level="5.5.5" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#slr-calculations-optional"><i class="fa fa-check"></i><b>5.5.5</b> SLR Calculations (Optional)</a></li>
<li class="chapter" data-level="5.5.6" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#car-price-and-acceleration-time"><i class="fa fa-check"></i><b>5.5.6</b> Car Price and Acceleration Time</a></li>
<li class="chapter" data-level="5.5.7" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#florida-lakes-est.-and-pred."><i class="fa fa-check"></i><b>5.5.7</b> Florida Lakes Est. and Pred.</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#transformations"><i class="fa fa-check"></i><b>5.6</b> Transformations</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#cars-assumptions-check"><i class="fa fa-check"></i><b>5.6.1</b> Cars Assumptions Check</a></li>
<li class="chapter" data-level="5.6.2" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#log-transformation"><i class="fa fa-check"></i><b>5.6.2</b> Log Transformation</a></li>
<li class="chapter" data-level="5.6.3" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#log-transform-for-car-prices"><i class="fa fa-check"></i><b>5.6.3</b> Log Transform for Car Prices</a></li>
<li class="chapter" data-level="5.6.4" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#log-model-predictions"><i class="fa fa-check"></i><b>5.6.4</b> Log Model Predictions</a></li>
<li class="chapter" data-level="5.6.5" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#log-model-interpretations"><i class="fa fa-check"></i><b>5.6.5</b> Log Model Interpretations</a></li>
<li class="chapter" data-level="5.6.6" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#log-model-ci-for-beta_0-beta_1"><i class="fa fa-check"></i><b>5.6.6</b> Log Model CI for <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span></a></li>
<li class="chapter" data-level="5.6.7" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#log-model-ci-for-expected-response"><i class="fa fa-check"></i><b>5.6.7</b> Log Model CI for Expected Response</a></li>
<li class="chapter" data-level="5.6.8" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#log-model-prediction-interval"><i class="fa fa-check"></i><b>5.6.8</b> Log Model Prediction Interval</a></li>
<li class="chapter" data-level="5.6.9" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#confidence-interval-comparison"><i class="fa fa-check"></i><b>5.6.9</b> Confidence Interval Comparison</a></li>
<li class="chapter" data-level="5.6.10" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#prediction-interval-comparison"><i class="fa fa-check"></i><b>5.6.10</b> Prediction Interval Comparison</a></li>
<li class="chapter" data-level="5.6.11" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#log-model-visualization"><i class="fa fa-check"></i><b>5.6.11</b> Log Model Visualization</a></li>
<li class="chapter" data-level="5.6.12" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#comments-on-transformations"><i class="fa fa-check"></i><b>5.6.12</b> Comments on Transformations</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#case-studies"><i class="fa fa-check"></i><b>5.7</b> Case Studies</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#flights-from-ny-to-chi"><i class="fa fa-check"></i><b>5.7.1</b> Flights from NY to CHI</a></li>
<li class="chapter" data-level="5.7.2" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#smoking-during-pregnancy"><i class="fa fa-check"></i><b>5.7.2</b> Smoking During Pregnancy</a></li>
<li class="chapter" data-level="5.7.3" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#smoking-during-pregnancy-cont"><i class="fa fa-check"></i><b>5.7.3</b> Smoking During Pregnancy (cont)</a></li>
<li class="chapter" data-level="5.7.4" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#exam-scores"><i class="fa fa-check"></i><b>5.7.4</b> Exam Scores</a></li>
<li class="chapter" data-level="5.7.5" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#simulating-the-regression-effect"><i class="fa fa-check"></i><b>5.7.5</b> Simulating the Regression Effect</a></li>
<li class="chapter" data-level="5.7.6" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#nfl-wins"><i class="fa fa-check"></i><b>5.7.6</b> NFL Wins</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="normal-error-regression-model.html"><a href="normal-error-regression-model.html#impact-of-model-assumption-violations"><i class="fa fa-check"></i><b>5.8</b> Impact of Model Assumption Violations</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="building-models-for-interpretation.html"><a href="building-models-for-interpretation.html"><i class="fa fa-check"></i><b>6</b> Building Models for Interpretation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="building-models-for-interpretation.html"><a href="building-models-for-interpretation.html#model-building---sat-scores"><i class="fa fa-check"></i><b>6.1</b> Model Building - SAT Scores</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="building-models-for-interpretation.html"><a href="building-models-for-interpretation.html#modeling-for-interpretation"><i class="fa fa-check"></i><b>6.1.1</b> Modeling for Interpretation</a></li>
<li class="chapter" data-level="6.1.2" data-path="building-models-for-interpretation.html"><a href="building-models-for-interpretation.html#sat-scores-dataset"><i class="fa fa-check"></i><b>6.1.2</b> SAT Scores Dataset</a></li>
<li class="chapter" data-level="6.1.3" data-path="building-models-for-interpretation.html"><a href="building-models-for-interpretation.html#research-question"><i class="fa fa-check"></i><b>6.1.3</b> Research Question</a></li>
<li class="chapter" data-level="6.1.4" data-path="building-models-for-interpretation.html"><a href="building-models-for-interpretation.html#teacher-salary-and-sat-score"><i class="fa fa-check"></i><b>6.1.4</b> Teacher Salary and SAT score</a></li>
<li class="chapter" data-level="6.1.5" data-path="building-models-for-interpretation.html"><a href="building-models-for-interpretation.html#a-deeper-investigation"><i class="fa fa-check"></i><b>6.1.5</b> A Deeper Investigation</a></li>
<li class="chapter" data-level="6.1.6" data-path="building-models-for-interpretation.html"><a href="building-models-for-interpretation.html#student-to-teacher-ratio"><i class="fa fa-check"></i><b>6.1.6</b> Student-to-Teacher Ratio</a></li>
<li class="chapter" data-level="6.1.7" data-path="building-models-for-interpretation.html"><a href="building-models-for-interpretation.html#multicollinearity"><i class="fa fa-check"></i><b>6.1.7</b> Multicollinearity</a></li>
<li class="chapter" data-level="6.1.8" data-path="building-models-for-interpretation.html"><a href="building-models-for-interpretation.html#check-model-assumptions"><i class="fa fa-check"></i><b>6.1.8</b> Check Model Assumptions</a></li>
<li class="chapter" data-level="6.1.9" data-path="building-models-for-interpretation.html"><a href="building-models-for-interpretation.html#quadratic-term"><i class="fa fa-check"></i><b>6.1.9</b> Quadratic Term</a></li>
<li class="chapter" data-level="6.1.10" data-path="building-models-for-interpretation.html"><a href="building-models-for-interpretation.html#account-for-region"><i class="fa fa-check"></i><b>6.1.10</b> Account for Region?</a></li>
<li class="chapter" data-level="6.1.11" data-path="building-models-for-interpretation.html"><a href="building-models-for-interpretation.html#predictions-and-intervals"><i class="fa fa-check"></i><b>6.1.11</b> Predictions and Intervals</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="building-models-for-interpretation.html"><a href="building-models-for-interpretation.html#modeling-car-price"><i class="fa fa-check"></i><b>6.2</b> Modeling Car Price</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="building-models-for-interpretation.html"><a href="building-models-for-interpretation.html#model-for-price-of-2015-cars"><i class="fa fa-check"></i><b>6.2.1</b> Model for Price of 2015 Cars</a></li>
<li class="chapter" data-level="6.2.2" data-path="building-models-for-interpretation.html"><a href="building-models-for-interpretation.html#acc.-and-qrt.-mile-time"><i class="fa fa-check"></i><b>6.2.2</b> Acc. and Qrt. Mile Time</a></li>
<li class="chapter" data-level="6.2.3" data-path="building-models-for-interpretation.html"><a href="building-models-for-interpretation.html#adding-weight-to-model"><i class="fa fa-check"></i><b>6.2.3</b> Adding Weight to Model</a></li>
<li class="chapter" data-level="6.2.4" data-path="building-models-for-interpretation.html"><a href="building-models-for-interpretation.html#adding-more-variables"><i class="fa fa-check"></i><b>6.2.4</b> Adding More Variables</a></li>
<li class="chapter" data-level="6.2.5" data-path="building-models-for-interpretation.html"><a href="building-models-for-interpretation.html#check-of-model-assumptions"><i class="fa fa-check"></i><b>6.2.5</b> Check of Model Assumptions</a></li>
<li class="chapter" data-level="6.2.6" data-path="building-models-for-interpretation.html"><a href="building-models-for-interpretation.html#coefficients-and-exponentiation"><i class="fa fa-check"></i><b>6.2.6</b> Coefficients and Exponentiation</a></li>
<li class="chapter" data-level="6.2.7" data-path="building-models-for-interpretation.html"><a href="building-models-for-interpretation.html#confidence-and-prediction-intevals"><i class="fa fa-check"></i><b>6.2.7</b> Confidence and Prediction Intevals</a></li>
<li class="chapter" data-level="6.2.8" data-path="building-models-for-interpretation.html"><a href="building-models-for-interpretation.html#model-building-summary"><i class="fa fa-check"></i><b>6.2.8</b> Model Building Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="predictive-modeling.html"><a href="predictive-modeling.html"><i class="fa fa-check"></i><b>7</b> Predictive Modeling</a>
<ul>
<li class="chapter" data-level="7.1" data-path="predictive-modeling.html"><a href="predictive-modeling.html#modeling-for-prediction"><i class="fa fa-check"></i><b>7.1</b> Modeling for Prediction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="predictive-modeling.html"><a href="predictive-modeling.html#overview"><i class="fa fa-check"></i><b>7.1.1</b> Overview</a></li>
<li class="chapter" data-level="7.1.2" data-path="predictive-modeling.html"><a href="predictive-modeling.html#illustration-of-predictive-modeling"><i class="fa fa-check"></i><b>7.1.2</b> Illustration of Predictive Modeling</a></li>
<li class="chapter" data-level="7.1.3" data-path="predictive-modeling.html"><a href="predictive-modeling.html#predicting-new-data"><i class="fa fa-check"></i><b>7.1.3</b> Predicting New Data</a></li>
<li class="chapter" data-level="7.1.4" data-path="predictive-modeling.html"><a href="predictive-modeling.html#evaluating-predictions---rmspe"><i class="fa fa-check"></i><b>7.1.4</b> Evaluating Predictions - RMSPE</a></li>
<li class="chapter" data-level="7.1.5" data-path="predictive-modeling.html"><a href="predictive-modeling.html#training-data-error"><i class="fa fa-check"></i><b>7.1.5</b> Training Data Error</a></li>
<li class="chapter" data-level="7.1.6" data-path="predictive-modeling.html"><a href="predictive-modeling.html#graph-of-rmspe"><i class="fa fa-check"></i><b>7.1.6</b> Graph of RMSPE</a></li>
<li class="chapter" data-level="7.1.7" data-path="predictive-modeling.html"><a href="predictive-modeling.html#best-model"><i class="fa fa-check"></i><b>7.1.7</b> Best Model</a></li>
<li class="chapter" data-level="7.1.8" data-path="predictive-modeling.html"><a href="predictive-modeling.html#model-complexity-training-error-and-test-error"><i class="fa fa-check"></i><b>7.1.8</b> Model Complexity, Training Error, and Test Error</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="predictive-modeling.html"><a href="predictive-modeling.html#variance-bias-tradeoff"><i class="fa fa-check"></i><b>7.2</b> Variance-Bias Tradeoff</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="predictive-modeling.html"><a href="predictive-modeling.html#what-contributes-to-prediction-error"><i class="fa fa-check"></i><b>7.2.1</b> What Contributes to Prediction Error?</a></li>
<li class="chapter" data-level="7.2.2" data-path="predictive-modeling.html"><a href="predictive-modeling.html#variance-and-bias"><i class="fa fa-check"></i><b>7.2.2</b> Variance and Bias</a></li>
<li class="chapter" data-level="7.2.3" data-path="predictive-modeling.html"><a href="predictive-modeling.html#variance-bias-tradeoff-1"><i class="fa fa-check"></i><b>7.2.3</b> Variance-Bias Tradeoff</a></li>
<li class="chapter" data-level="7.2.4" data-path="predictive-modeling.html"><a href="predictive-modeling.html#modeling-for-prediction-1"><i class="fa fa-check"></i><b>7.2.4</b> Modeling for Prediction</a></li>
<li class="chapter" data-level="7.2.5" data-path="predictive-modeling.html"><a href="predictive-modeling.html#cross-validation"><i class="fa fa-check"></i><b>7.2.5</b> Cross-Validation</a></li>
<li class="chapter" data-level="7.2.6" data-path="predictive-modeling.html"><a href="predictive-modeling.html#cross-validation-illustration"><i class="fa fa-check"></i><b>7.2.6</b> Cross-Validation Illustration</a></li>
<li class="chapter" data-level="7.2.7" data-path="predictive-modeling.html"><a href="predictive-modeling.html#cv-in-r"><i class="fa fa-check"></i><b>7.2.7</b> CV in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="classification-and-logistic-regression.html"><a href="classification-and-logistic-regression.html"><i class="fa fa-check"></i><b>8</b> Classification and Logistic Regression</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stat 255: Statistics for Data Science Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bootstrap-interval-estimation" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Bootstrap Interval Estimation<a href="bootstrap-interval-estimation.html#bootstrap-interval-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>Learning Outcomes:</strong></p>
<ol style="list-style-type: decimal">
<li>Explain the impact of sampling variability on interval estimation.<br />
</li>
<li>Define sampling distribution and standard error.<br />
</li>
<li>Interpret confidence intervals, or explain why it is inappropriate to do so.<br />
</li>
<li>Explain the purpose of bootstrapping.<br />
</li>
<li>Explain how to obtain a bootstrap distribution for a statistic (such as a sample mean, median, standard deviation, proportion, difference in means or proportions, or regression coefficient).<br />
</li>
<li>Determine when it is appropriate to use standard error and percentile confidence intervals.<br />
</li>
<li>Explain whether or not the results of a confidence interval are consistent with the conclusion of a hypothesis test.</li>
<li>Interpret confidence intervals, or explain why it is inappropriate to do so.<br />
</li>
<li>Define standard error of a statistic and interpret it in context.<br />
</li>
<li>Explain how sample size and level of confidence impact the width of a confidence interval.<br />
</li>
<li>Explain how sample size impacts variability in individual observations, and the sampling distribution for a test statistic.<br />
</li>
<li>Define standard error of a statistic and interpret it in context.<br />
</li>
<li>Explain when it is appropriate to use “theory-based” standard error formulas.</li>
</ol>
<div id="sampling-distributions" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Sampling Distributions<a href="bootstrap-interval-estimation.html#sampling-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sampling-from-a-population" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Sampling From a Population<a href="bootstrap-interval-estimation.html#sampling-from-a-population" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In statistics, we often do not have the time, money, or means to collect data on all individuals or units on which we want to draw conclusions. Instead, we might collect data on only a subset of the individuals, and then make inferences about all individuals we are interested in, using the information we collected.</p>
<p><strong>Vocabulary:</strong></p>
<ol style="list-style-type: decimal">
<li>A <strong>population</strong> is the entire set of individuals that we want to draw conclusions about.</li>
<li>A <strong>sample</strong> is a subset of a population</li>
<li>A <strong>parameter</strong> is a numerical quantity pertaining to an entire population<br />
</li>
<li>A <strong>statistic</strong> is a numerical quantity calculated from a sample</li>
</ol>
<p>We’ll work with a dataset containing information on all 20,591 flights from New York to Chicago in 2013. Our population of interest is all 20,591 flights.</p>
<p>In this situation, we have information on the entire population, but suppose temporarily that we didn’t. Instead, suppose we had only information on a random sample of 75 flights.</p>
<p>The parameter of interest is the proportion of on-time arrivals out of all flights in the population of 20,591. When the parameter is proportion, we’ll denote it with the letter <span class="math inline">\(p\)</span>.</p>
<p>We take a sample of 75 flights. The first 6 flights in the sample are shown below. The <code>ontime</code> variable tells whether or not the flight arrived on time.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="bootstrap-interval-estimation.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">08082023</span>)</span>
<span id="cb217-2"><a href="bootstrap-interval-estimation.html#cb217-2" aria-hidden="true" tabindex="-1"></a>S1 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(Flights_NY_CHI, <span class="dv">75</span>)</span>
<span id="cb217-3"><a href="bootstrap-interval-estimation.html#cb217-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(S1)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 9
##    year month   day carrier origin dest  sched_dep_time arr_delay ontime
##   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;          &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt; 
## 1  2013     3     8 AA      LGA    ORD             1720       106 N     
## 2  2013    12    15 AA      JFK    ORD             1715       -24 Y     
## 3  2013    10    22 UA      EWR    ORD             1300       -12 Y     
## 4  2013     8    26 UA      EWR    ORD             2110        15 N     
## 5  2013     7    23 AA      LGA    ORD             1359        66 N     
## 6  2013     5    13 UA      EWR    ORD              900       -21 Y</code></pre>
<p>We’ll calculate the number, and proportion of flights that arrived on time.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="bootstrap-interval-estimation.html#cb219-1" aria-hidden="true" tabindex="-1"></a>num_ontime <span class="ot">&lt;-</span> <span class="fu">sum</span>(S1<span class="sc">$</span>ontime <span class="sc">==</span> <span class="st">&quot;Y&quot;</span>) <span class="co"># count number of on-time arrivals</span></span></code></pre></div>
<p>Number of on-time arrivals in the sample.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="bootstrap-interval-estimation.html#cb220-1" aria-hidden="true" tabindex="-1"></a>num_ontime</span></code></pre></div>
<pre><code>## [1] 39</code></pre>
<p>Proportion of on-time arrivals in the sample.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="bootstrap-interval-estimation.html#cb222-1" aria-hidden="true" tabindex="-1"></a>p_hat <span class="ot">&lt;-</span> num_ontime<span class="sc">/</span><span class="dv">75</span></span>
<span id="cb222-2"><a href="bootstrap-interval-estimation.html#cb222-2" aria-hidden="true" tabindex="-1"></a>p_hat</span></code></pre></div>
<pre><code>## [1] 0.52</code></pre>
<p>In out sample 52 percent of flights arrived on-time. We’ll denote this quantity <span class="math inline">\(\hat{p}\)</span>, keeping with our convention of using the <span class="math inline">\(\hat{}\)</span> symbol to represent a quantity that is calculated from data (like the predictions and estimates we saw in the previous chapter). The sample statistic <span class="math inline">\(\hat{p}\)</span> is an estimate of the population proportion <span class="math inline">\(p\)</span>.</p>
<p>Of course, this was just one sample of 75 flights. We should not expect the proportion of on-time flights in our sample (<span class="math inline">\(\hat{p}\)</span>) to exactly match the proportion of on-time flights in the entire population (<span class="math inline">\(p\)</span>). Nevertheless we can use the sample to estimate the proportion of all flights in the population that arrive on time. Perhaps, we could say that we would expect between 42 and 62 percent of all 2013 flights from New York to arrive on time. Or, perhaps we could be more precise and estimate that the percentage of on-time flights to be between 47 and 57. We’ll need to figure out how precise we can make our range, while still being confident that it does, in fact, contain the true population parameter.</p>
<p>To summarize:</p>
<ul>
<li>The population is all 20,591 flights from New York to Chicago in 2013.</li>
<li>The sample is the flights that we randomly selected.<br />
</li>
<li>The parameter <span class="math inline">\(p\)</span> is the proportion of on-time arrivals among all 2013 flights from New York to Chicago, which we do not know (though in this particular example, we could find it, since we have data on all flights in the population.)<br />
</li>
<li>The sample statistic is the proportion of flights in our sample that arrived on time, which we know to be <span class="math inline">\(\hat{p}\)</span> = 0.52.</li>
</ul>
<p>Now, let’s take a different sample of 75 flights and see how the proportion of on-time arrivals compares.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="bootstrap-interval-estimation.html#cb224-1" aria-hidden="true" tabindex="-1"></a>S2 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(Flights_NY_CHI, <span class="dv">75</span>)</span>
<span id="cb224-2"><a href="bootstrap-interval-estimation.html#cb224-2" aria-hidden="true" tabindex="-1"></a>num_ontime2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(S2<span class="sc">$</span>ontime <span class="sc">==</span> <span class="st">&quot;Y&quot;</span>) <span class="co"># count number of on-time arrivals</span></span>
<span id="cb224-3"><a href="bootstrap-interval-estimation.html#cb224-3" aria-hidden="true" tabindex="-1"></a>p_hat2 <span class="ot">&lt;-</span> num_ontime2<span class="sc">/</span><span class="dv">75</span></span>
<span id="cb224-4"><a href="bootstrap-interval-estimation.html#cb224-4" aria-hidden="true" tabindex="-1"></a>p_hat2</span></code></pre></div>
<pre><code>## [1] 0.5066667</code></pre>
<p>By studying the behavior of the proportion of on-time arrivals in different samples we can gauge how close the proportion in a given sample is likely be to the unknown population parameter. If all of our samples produce very similar estimates, then it is likely that the population parameter is close to these estimates. If the sample proportion varies considerably from sample to sample, then it is possible that the proportion in any given sample might be very different than the population parameter.</p>
<p>Let’s take 10,000 more random samples of 75 flights and record the proportion of on-time arrivals in each sample.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="bootstrap-interval-estimation.html#cb226-1" aria-hidden="true" tabindex="-1"></a>nreps <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># number of repetitions</span></span>
<span id="cb226-2"><a href="bootstrap-interval-estimation.html#cb226-2" aria-hidden="true" tabindex="-1"></a>p_hat_val <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nreps) <span class="co"># create vector to hold proportion of on-time arrivals</span></span>
<span id="cb226-3"><a href="bootstrap-interval-estimation.html#cb226-3" aria-hidden="true" tabindex="-1"></a>Sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>nreps</span>
<span id="cb226-4"><a href="bootstrap-interval-estimation.html#cb226-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-5"><a href="bootstrap-interval-estimation.html#cb226-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nreps){</span>
<span id="cb226-6"><a href="bootstrap-interval-estimation.html#cb226-6" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(Flights_NY_CHI, <span class="dv">75</span>) <span class="co"># take sample of 75</span></span>
<span id="cb226-7"><a href="bootstrap-interval-estimation.html#cb226-7" aria-hidden="true" tabindex="-1"></a>N_ontime <span class="ot">&lt;-</span> <span class="fu">sum</span>(S<span class="sc">$</span>ontime <span class="sc">==</span> <span class="st">&quot;Y&quot;</span>) <span class="co"># count number of on-time arrivals</span></span>
<span id="cb226-8"><a href="bootstrap-interval-estimation.html#cb226-8" aria-hidden="true" tabindex="-1"></a>p_hat_val[i] <span class="ot">&lt;-</span> N_ontime<span class="sc">/</span><span class="dv">75</span> <span class="co"># record proportion on-time</span></span>
<span id="cb226-9"><a href="bootstrap-interval-estimation.html#cb226-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb226-10"><a href="bootstrap-interval-estimation.html#cb226-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-11"><a href="bootstrap-interval-estimation.html#cb226-11" aria-hidden="true" tabindex="-1"></a>Samples_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Sample, p_hat_val) <span class="co"># store results in a data frame</span></span></code></pre></div>
<p>The table shows the proportion of on-time arrivals in the first 20 samples of 75 flights.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="bootstrap-interval-estimation.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(Samples_df, <span class="dv">20</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Sample</th>
<th align="right">p_hat_val</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.6533333</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.5333333</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.5866667</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0.6933333</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">0.5866667</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">0.6666667</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">0.6133333</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">0.5866667</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">0.6533333</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">0.6533333</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">0.6133333</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">0.5866667</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="right">0.6133333</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">0.4800000</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">0.6000000</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">0.4400000</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">0.4933333</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">0.5733333</td>
</tr>
<tr class="odd">
<td align="right">19</td>
<td align="right">0.6400000</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="right">0.5600000</td>
</tr>
</tbody>
</table>
<p>The histogram below shows the distribution of the proportion of on-time arrivals in the 10,000 different samples.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="bootstrap-interval-estimation.html#cb228-1" aria-hidden="true" tabindex="-1"></a>Prop_Samp_Dist<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Samples_df, <span class="fu">aes</span>(<span class="at">x=</span>p_hat_val)) <span class="sc">+</span></span>
<span id="cb228-2"><a href="bootstrap-interval-estimation.html#cb228-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb228-3"><a href="bootstrap-interval-estimation.html#cb228-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Sampling Distribution for Proportion On Time&quot;</span>) <span class="sc">+</span> </span>
<span id="cb228-4"><a href="bootstrap-interval-estimation.html#cb228-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Prop. on time in sample&quot;</span>)</span>
<span id="cb228-5"><a href="bootstrap-interval-estimation.html#cb228-5" aria-hidden="true" tabindex="-1"></a>Prop_Samp_Dist</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-186-1.png" width="672" /></p>
<p>We notice that most of our 10,000 samples yielded proportions of on-time arrivals between 0.5 and 0.7, The distribution of proportion of on-time arrivals is roughly symmetric and bell-shaped.</p>
<p>The distribution shown in this histogram is called the <strong>sampling distribution for <span class="math inline">\(\hat{p}\)</span></strong>. We can gauge how much the proportion of on-time arrivals varies between samples by calculating the standard deviation of this sampling distribution. The standard deviation of a sampling distribution for a statistic is also called the <strong>standard error</strong> of the statistic. In this case it represents the standard error <span class="math inline">\(\hat{p}\)</span> (the proportion of on-time arrivals), and is denoted <span class="math inline">\(\text{SE}(\hat{p})\)</span>. This standard error is shown below.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="bootstrap-interval-estimation.html#cb229-1" aria-hidden="true" tabindex="-1"></a>SE_p_hat <span class="ot">&lt;-</span> <span class="fu">sd</span>(Samples_df<span class="sc">$</span>p_hat_val)</span>
<span id="cb229-2"><a href="bootstrap-interval-estimation.html#cb229-2" aria-hidden="true" tabindex="-1"></a>SE_p_hat</span></code></pre></div>
<pre><code>## [1] 0.05659102</code></pre>
<p><strong>Vocabulary:</strong></p>
<ul>
<li>The <strong>sampling distribution</strong> of a statistic is the distribution of values the statistic takes on across many different samples of a given size.<br />
</li>
<li>The <strong>standard error</strong> of a statistic is the standard deviation of that statistic’s sampling distribution. It measures how much the statistic varies between different samples of a given size.</li>
</ul>
<p>In this rare situation, we actually have data on all 20,591 flights from New York to Chicago in 2013 (our entire population), Let’s calculate the true value of the population parameter <span class="math inline">\(p\)</span>, the proportion of flights that arrived on-time in our actual population.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="bootstrap-interval-estimation.html#cb231-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sum</span>(Flights_NY_CHI<span class="sc">$</span>ontime <span class="sc">==</span> <span class="st">&quot;Y&quot;</span>)<span class="sc">/</span><span class="dv">20591</span></span>
<span id="cb231-2"><a href="bootstrap-interval-estimation.html#cb231-2" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.6079841</code></pre>
<p>In fact, just over 60% of all flights in the population arrived on time.</p>
<p>The sampling distribution for the proportion of on-time flights is shown again below. The true proportion of on-time flights is marked by the green dotted line. The gold bar at the bottom of the histogram represents the range of sample proportions that lie within <span class="math inline">\(\pm 2\)</span> standard errors of the true population proportion of flights that arrived on time.</p>
<p>0.6079841 - 2(0.056591) to 0.6079841 + 2(0.056591)</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="bootstrap-interval-estimation.html#cb233-1" aria-hidden="true" tabindex="-1"></a>Prop_Samp_Dist<span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span>p, <span class="at">color=</span><span class="st">&quot;green&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>, <span class="at">linewidth=</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>p <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat,<span class="at">xend=</span>p <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), <span class="at">color=</span><span class="st">&quot;gold&quot;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-189-1.png" width="672" /></p>
<p>We calculate the proportion of samples whose proportion of on-time arrivals lies within <span class="math inline">\(\pm 2\)</span> standard errors of the true proportion.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="bootstrap-interval-estimation.html#cb234-1" aria-hidden="true" tabindex="-1"></a>Lower <span class="ot">&lt;-</span> p <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat</span>
<span id="cb234-2"><a href="bootstrap-interval-estimation.html#cb234-2" aria-hidden="true" tabindex="-1"></a>Upper <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat</span>
<span id="cb234-3"><a href="bootstrap-interval-estimation.html#cb234-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((Samples_df<span class="sc">$</span>p_hat_val <span class="sc">&gt;=</span>Lower) <span class="sc">&amp;</span> (Samples_df<span class="sc">$</span>p_hat_val <span class="sc">&lt;=</span> Upper))</span></code></pre></div>
<pre><code>## [1] 9539</code></pre>
<p>Approximately 95% 10,000 samples produced proportions within <span class="math inline">\(\pm 2\)</span> standard errors of the true population proportion of on-time flights.</p>
</div>
<div id="confidence-intervals" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Confidence Intervals<a href="bootstrap-interval-estimation.html#confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In a real situation, we won’t have access to the entire population of flights, only the flights in a single sample. For example, recall our original sample of 75 flights, in which we observed a proportion of on-time arrivals of <span class="math inline">\(\hat{p}=\)</span> 0.52.</p>
<p>Since we now know that 95% of all samples produce proportions that lie within two standard errors of the population proportion, we can obtain an estimate of the population proportion <span class="math inline">\(p\)</span> by adding and subtracting <span class="math inline">\(2\times \text{SE}(\hat{p})\)</span> from our observed sample proportion <span class="math inline">\(\hat{p}\)</span>. Such an interval is called an approximate 95% <strong>confidence interval</strong> for the true population proportion <span class="math inline">\(p\)</span>.</p>
<p><strong>Approximate 95% Confidence Interval for <span class="math inline">\(\hat{p}\)</span></strong></p>
<p><span class="math display">\[
\hat{p} \pm 2\times \text{SE}(\hat{p})
\]</span></p>
<p>The confidence interval, based on our original sample, is calculated below.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="bootstrap-interval-estimation.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(p_hat <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat, p_hat <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat) </span></code></pre></div>
<pre><code>## [1] 0.406818 0.633182</code></pre>
<p>Based on our sample of 75 flights, we can be 95% confident that the true proportion of on-time arrivals among all 2013 flights from New York to Chicago is between 0.406818 and <code>p_hat + 2*SE_p_hat</code>.</p>
<p>In fact, knowing what we do about the true value of the population parameter <span class="math inline">\(p\)</span>, we can see that our confidence interval does indeed contain this value. Of course, in a real situation, we won’t know the true value of the population parameter, so we won’t know for sure whether or not our confidence interval contains this true parameter value.</p>
<p>A pertinent question at this stage would be ``What does 95% confidence mean?“. To answer that, let’s explore what happens when we calculate confidence intervals based on estimates many different samples. For each of our 10,000 different samples taken from our population, we’ll add and subtract two standard errors from the sample proportion <span class="math inline">\(\hat{p}\)</span> corresponding to that sample.</p>
<p>The table below displays the value of <span class="math inline">\(\hat{p}\)</span>, for the first 20 samples we took, along with the lower and upper bounds of the confidence interval, and whether or not the confidence interval contains the true parameter value <span class="math inline">\(p\)</span> (either <code>TRUE</code> or <code>FALSE</code>).</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="bootstrap-interval-estimation.html#cb238-1" aria-hidden="true" tabindex="-1"></a>Samples_df <span class="ot">&lt;-</span> Samples_df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>( <span class="at">Lower =</span> p_hat_val <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat, </span>
<span id="cb238-2"><a href="bootstrap-interval-estimation.html#cb238-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">Upper =</span> p_hat_val <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat,</span>
<span id="cb238-3"><a href="bootstrap-interval-estimation.html#cb238-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">Contains =</span> p <span class="sc">&gt;=</span> Lower <span class="sc">&amp;</span> p <span class="sc">&lt;=</span> Upper)</span>
<span id="cb238-4"><a href="bootstrap-interval-estimation.html#cb238-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(Samples_df, <span class="dv">20</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Sample</th>
<th align="right">p_hat_val</th>
<th align="right">Lower</th>
<th align="right">Upper</th>
<th align="left">Contains</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.6533333</td>
<td align="right">0.5401513</td>
<td align="right">0.7665154</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.5333333</td>
<td align="right">0.4201513</td>
<td align="right">0.6465154</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.5866667</td>
<td align="right">0.4734846</td>
<td align="right">0.6998487</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0.6933333</td>
<td align="right">0.5801513</td>
<td align="right">0.8065154</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">0.5866667</td>
<td align="right">0.4734846</td>
<td align="right">0.6998487</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">0.6666667</td>
<td align="right">0.5534846</td>
<td align="right">0.7798487</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">0.6133333</td>
<td align="right">0.5001513</td>
<td align="right">0.7265154</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">0.5866667</td>
<td align="right">0.4734846</td>
<td align="right">0.6998487</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">0.6533333</td>
<td align="right">0.5401513</td>
<td align="right">0.7665154</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">0.6533333</td>
<td align="right">0.5401513</td>
<td align="right">0.7665154</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">0.6133333</td>
<td align="right">0.5001513</td>
<td align="right">0.7265154</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">0.5866667</td>
<td align="right">0.4734846</td>
<td align="right">0.6998487</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="right">0.6133333</td>
<td align="right">0.5001513</td>
<td align="right">0.7265154</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">0.4800000</td>
<td align="right">0.3668180</td>
<td align="right">0.5931820</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">0.6000000</td>
<td align="right">0.4868180</td>
<td align="right">0.7131820</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">0.4400000</td>
<td align="right">0.3268180</td>
<td align="right">0.5531820</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">0.4933333</td>
<td align="right">0.3801513</td>
<td align="right">0.6065154</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">0.5733333</td>
<td align="right">0.4601513</td>
<td align="right">0.6865154</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="right">19</td>
<td align="right">0.6400000</td>
<td align="right">0.5268180</td>
<td align="right">0.7531820</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="right">0.5600000</td>
<td align="right">0.4468180</td>
<td align="right">0.6731820</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<p>The graphic below visualizes the confidence intervals produced using the estimates from the first 100 samples. The green dotted line indicates the true value of <span class="math inline">\(p\)</span>. The black dots indicate the value of <span class="math inline">\(\hat{p}\)</span> for each sample. Intervals that do in fact contain the true value of <span class="math inline">\(p\)</span> are shown in blue, and intervals that do not contain the true value of <span class="math inline">\(p\)</span> are shown in green.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="bootstrap-interval-estimation.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Samples_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,], <span class="fu">aes</span>(<span class="at">y=</span>Sample, <span class="at">x=</span>p_hat_val)) <span class="sc">+</span>    </span>
<span id="cb239-2"><a href="bootstrap-interval-estimation.html#cb239-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb239-3"><a href="bootstrap-interval-estimation.html#cb239-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Lower, <span class="at">xmax =</span> Upper, <span class="at">color=</span>Contains))  <span class="sc">+</span> </span>
<span id="cb239-4"><a href="bootstrap-interval-estimation.html#cb239-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Confidence Interval&quot;</span>) <span class="sc">+</span> </span>
<span id="cb239-5"><a href="bootstrap-interval-estimation.html#cb239-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Sample&quot;</span>) <span class="sc">+</span> </span>
<span id="cb239-6"><a href="bootstrap-interval-estimation.html#cb239-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> p, <span class="at">color=</span><span class="st">&quot;green&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-193-1.png" width="960" /></p>
<p>Out of these 100 samples, 93 contain the true value of the population parameter <span class="math inline">\(p\)</span>. This is close to the 95% confidence level.</p>
<p>The picture shows confidence intervals produced by the first 100 samples, but we actually took 10,000 different samples of 75 flights. Let’s calculate how many of these samples produced confidence intervals that contain the true value of <span class="math inline">\(p\)</span>.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="bootstrap-interval-estimation.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(Samples_df<span class="sc">$</span>Contains <span class="sc">==</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 9539</code></pre>
<p>Again, notice that close to 95% of the samples produced confidence intervals contain the true population parameter <span class="math inline">\(p\)</span>. Note that for the red intervals that do not contain <span class="math inline">\(p\)</span> nothing was done incorrectly. The sample was taken at random, and the confidence interval was calculated using the correct formula. It just happened that by chance, we obtained a sample proportion <span class="math inline">\(\hat{p}\)</span> that was unusually high or low, leading to an interval that did not capture the true population parameter. This, of course, happens rarely, and approximately 95% of the samples do, in fact, result in intervals that contain the true value of <span class="math inline">\(p\)</span>.</p>
<p>This brings us back to the question “what does 95% confidence mean?”. An approximate 95% confidence interval means that if we take a large number of samples and calculate confidence intervals from each of them, then approximately 95% of the samples will produce intervals containing the true population parameter. In reality, we’ll only have on sample, and won’t know whether or not our interval contains the true parameter value. Assuming we have taken the sample and calculated the interval correctly, we can rest assured in the knowledge that that 95% of all intervals taken would contain the true parameter value, and hope that ours is among that 95%.</p>
<p>We calculated the confidence interval by taking our sample statistic <span class="math inline">\(\hat{p}\)</span> plus/minus two standard errors. Confidence intervals that are calculated by adding and subtracting a certain number of standard errors from the sample statistic are called <strong>standard error confidence intervals</strong>. This approach will work as long as the sampling distribution is symmetric and bell-shaped. Probability theory tells us that in a symmetric and bell-shaped distribution, approximately 95% of the area lies within two standard errors of the center of the distribution, given by the true parameter value. We will, however, see that this approach will not work in all cases. Not all statistics produce sampling distributions that are symmetric and bell-shaped, and we will need an alternative way to calculate confidence intervals in these situations.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="bootstrap-interval-estimation.html#cb242-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;Emp_Rule.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-195"></span>
<img src="Emp_Rule.png" alt="Image from https://openintro-ims.netlify.app/foundations-mathematical" width="1800" />
<p class="caption">
Figure 4.1: Image from <a href="https://openintro-ims.netlify.app/foundations-mathematical" class="uri">https://openintro-ims.netlify.app/foundations-mathematical</a>
</p>
</div>
<p>If we want to use a level of confidence that is different than 95%, we can adjust the value we multiply the standard error by. In general, a standard error confidence interval has the form</p>
<p><span class="math display">\[
\text{Statistic } \pm m\times \text{Standard Error},
\]</span></p>
<p>where the value of <span class="math inline">\(m\)</span> depends on the desired level of confidence.</p>
<p>Of course, you might ask why we needed to calculate a confidence interval for the proportion of on-time flights in the first place, since we actually have data on all 20,591 flights in the population and already know the true proportion of on-time arrivals to be 0.608. The answer is that we don’t. But, in most real situations, we will only have data from a single sample, not the entire population, and we won’t know the true population parameter. We’ll be able to build on the ideas of sampling distributions and standard error that we learned about in this section to calculate confidence intervals in those scenarios.</p>
</div>
</div>
<div id="bootstrapping" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Bootstrapping<a href="bootstrap-interval-estimation.html#bootstrapping" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="mercury-levels-in-florida-lakes-1" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Mercury Levels in Florida Lakes<a href="bootstrap-interval-estimation.html#mercury-levels-in-florida-lakes-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A 2004 study by Lange, T., Royals, H. and Connor, L. examined Mercury accumulation in large-mouth bass, taken from a sample of 53 Florida Lakes. If Mercury accumulation exceeds 0.5 ppm, then there are environmental concerns. In fact, the legal safety limit in Canada is 0.5 ppm, although it is 1 ppm in the United States.</p>
<p>Recall that our data come from a sample of 53 lakes, out of more then 30,000 in the entire state of Florida.</p>
<p>The mercury levels of the first 10 lakes in the sample are shown in the table below.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="bootstrap-interval-estimation.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;FloridaLakes&quot;</span>)</span>
<span id="cb243-2"><a href="bootstrap-interval-estimation.html#cb243-2" aria-hidden="true" tabindex="-1"></a>FloridaLakes <span class="ot">&lt;-</span> FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Mercury =</span> AvgMercury)</span></code></pre></div>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="bootstrap-interval-estimation.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, Lake, Mercury), <span class="dv">10</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">ID</th>
<th align="left">Lake</th>
<th align="right">Mercury</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">Alligator</td>
<td align="right">1.23</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">Annie</td>
<td align="right">1.33</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">Apopka</td>
<td align="right">0.04</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">Blue Cypress</td>
<td align="right">0.44</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">Brick</td>
<td align="right">1.20</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">Bryant</td>
<td align="right">0.27</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="left">Cherry</td>
<td align="right">0.48</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="left">Crescent</td>
<td align="right">0.19</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="left">Deer Point</td>
<td align="right">0.83</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="left">Dias</td>
<td align="right">0.81</td>
</tr>
</tbody>
</table>
<p>The histogram shows the distribution of mercury levels in the 53 lakes in the sample. Lakes exceeding the US standard of 1 ppm are shown in red.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="bootstrap-interval-estimation.html#cb245-1" aria-hidden="true" tabindex="-1"></a>Lakes_Hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>FloridaLakes, <span class="fu">aes</span>(<span class="at">x=</span>Mercury)) <span class="sc">+</span> </span>
<span id="cb245-2"><a href="bootstrap-interval-estimation.html#cb245-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill=</span>Mercury<span class="sc">&lt;=</span><span class="dv">1</span>), <span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">binwidth =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb245-3"><a href="bootstrap-interval-estimation.html#cb245-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Mercury Levels in Sample of 53 Florida Lakes&quot;</span>) <span class="sc">+</span> </span>
<span id="cb245-4"><a href="bootstrap-interval-estimation.html#cb245-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mercury Level&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb245-5"><a href="bootstrap-interval-estimation.html#cb245-5" aria-hidden="true" tabindex="-1"></a>Lakes_Hist</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-198-1.png" width="672" /></p>
<p>The proportion of lakes with mercury levels exceeding 1 ppm is calculated below.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="bootstrap-interval-estimation.html#cb246-1" aria-hidden="true" tabindex="-1"></a>p_hat <span class="ot">&lt;-</span> <span class="fu">sum</span>(FloridaLakes<span class="sc">$</span>Mercury <span class="sc">&gt;</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">53</span></span>
<span id="cb246-2"><a href="bootstrap-interval-estimation.html#cb246-2" aria-hidden="true" tabindex="-1"></a>p_hat</span></code></pre></div>
<pre><code>## [1] 0.1132075</code></pre>
<p>We see that in our sample of 53 lakes, approximately 11% have mercury levels exceeding the US standard of 1 ppm. Suppose we want to estimate the proportion of all Florida Lakes whose mercury level exceeds this standard. As we saw in the previous section, we would not expect the population proportion to exactly match the sample, due to random variability between samples. We can use the sample proportion as an estimate (<span class="math inline">\(\hat{p} = 0.1132\)</span>), and construct a confidence interval for the unknown population proportion <span class="math inline">\(p\)</span>.</p>
<p>In order to construct the confidence interval, we need to know how much the sample proportion of lakes exceeding 1 ppm <span class="math inline">\(\hat{p}\)</span> could vary between different samples of size 53. That is, we need to know the standard error of <span class="math inline">\(\hat{p}\)</span>. In the previous section, we calculated the standard error by taking 10,000 different samples of the same size as ours from the population, calculating the proportion for each sample, and then calculating the standard deviation of the proportions obtained from these 10,000 different samples. This procedure will not work here, however, because unlike the previous example where we really did have data on the entire population of all flights from New York to Chicago, we do not have data on all 30,000+ lakes in Florida. We cannot take a lot of different samples of size 53 from the population of all lakes, and thus, cannot obtain the sampling distribution for the the proportion of lakes exceeding 1 ppm, or estimate the standard error of <span class="math inline">\(\hat{p}\)</span>.</p>
</div>
<div id="bootstrap-sampling" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Bootstrap Sampling<a href="bootstrap-interval-estimation.html#bootstrap-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All we have is a single sample of 53 lakes. We need to figure out how much the proportion of lakes with mercury levels exceeding 1 ppm would vary between different samples of size 53, using only the information contained in our one sample.</p>
<p>To do this, we’ll implement a popular simulation-based strategy, known as <strong>bootstrapping</strong>.</p>
<p>Let’s assume our sample is representative of all Florida lakes. Then, we’ll duplicate the sample many times to create a large set that will look like the population of all Florida Lakes. We can then draw samples of 53 from that large population, and record the mean mercury level for each sample of 53.</p>
<p>An illustration of the bootstrapping procedure is shown below, using a sample of 12 colored dots, instead of the 53 lakes.</p>
<p><img src="Bootstrap_Idea.png" width="100%" /></p>
<p>In fact, duplicating the sample many times and selecting new samples of size <span class="math inline">\(n\)</span> has the same effect as drawing samples of size <span class="math inline">\(n\)</span> from the original sample, by putting the item drawn back in each time, a procedure called <strong>sampling with replacement</strong>. Thus, we can skip the step of copying/pasting the sample many times, and instead draw our samples with replacement.</p>
<p>This means that in each new sample, some lakes will be drawn multiple times and others not at all. It also ensures that each sample is different, allowing us to estimate variability in the sample mean between the different samples of size 53.</p>
<p>An illustration of the concept of bootstrapping, using sampling with replacement is shown below.</p>
<p><img src="Bootstrap.png" width="100%" /></p>
<p>The variability in sample means in our newly drawn samples is used to approximate the variability in proportion <span class="math inline">\(\hat{p}\)</span> that would occur between different samples of 53 lakes, drawn from the population of all Florida Lakes.</p>
<p>The point of bootstrapping is to observe how much a statistic (in this case the proportion of lakes with Mercury levels exceeding 1 ppm) varies between bootstrap samples. This can act as an estimate of how much that statistic would vary between different samples of size <span class="math inline">\(n\)</span>, drawn from the population.</p>
<p>The steps of bootstrap sampling can be summarized in the following algorithm.</p>
<p><strong>Bootstrap Algorithm</strong></p>
<p>For an original sample of size <span class="math inline">\(n\)</span>:</p>
<ol style="list-style-type: decimal">
<li><p>Take a sample size <span class="math inline">\(n\)</span> by randomly sampling from the original, with replacement. Thus, some observations will show up multiple times, and others not at all. This sample is called a <strong>bootstrap sample</strong>.</p></li>
<li><p>Calculate the statistic of interest in the bootstrap sample (in this case <span class="math inline">\(\hat{p}\)</span>, the proportion of lakes whose mercury levels exceed 1 ppm).</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, keeping track of the statistic of interest that is calculated in each bootstrap sample.</p></li>
<li><p>Look at the distribution of the statistic across bootstrap samples. The variability in this bootstrap distribution can be used to approximate the variability in the sampling distribution for the statistic of interest.</p></li>
</ol>
</div>
<div id="bootstrap-samples-of-lakes" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Bootstrap Samples of Lakes<a href="bootstrap-interval-estimation.html#bootstrap-samples-of-lakes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>sample_n()</code> function samples the specified number rows from a data frame, with or without replacement.</p>
<p>The lakes in the first sample are shown below. Notice that some lakes occur multiple times, and others not at all.</p>
<p><strong>Bootstrap Sample 1</strong></p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="bootstrap-interval-estimation.html#cb248-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Lake)</span>
<span id="cb248-2"><a href="bootstrap-interval-estimation.html#cb248-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, Lake, Mercury)</span></code></pre></div>
<pre><code>## # A tibble: 53 × 3
##       ID Lake       Mercury
##    &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;
##  1     1 Alligator     1.23
##  2     2 Annie         1.33
##  3     3 Apopka        0.04
##  4     5 Brick         1.2 
##  5     5 Brick         1.2 
##  6     6 Bryant        0.27
##  7     7 Cherry        0.48
##  8     9 Deer Point    0.83
##  9     9 Deer Point    0.83
## 10    12 Down          0.5 
## # ℹ 43 more rows</code></pre>
<p>We calculate the proportion of lakes with mercury levels exceeding 1 ppm in this bootstrap sample. Note that if a lake shows up more than once in the bootstrap sample, then it is counted however many times it shows up.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="bootstrap-interval-estimation.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(BootstrapSample1<span class="sc">$</span>Mercury <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">53</span></span></code></pre></div>
<pre><code>## [1] 0.0754717</code></pre>
<p><strong>Bootstrap Sample #2</strong></p>
<p>We take a second bootstrap sample. Notice that the lakes chosen and omitted differ from the first sample.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="bootstrap-interval-estimation.html#cb252-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Lake)</span>
<span id="cb252-2"><a href="bootstrap-interval-estimation.html#cb252-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, Lake, Mercury)</span></code></pre></div>
<pre><code>## # A tibble: 53 × 3
##       ID Lake      Mercury
##    &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;
##  1     1 Alligator    1.23
##  2     2 Annie        1.33
##  3     2 Annie        1.33
##  4     2 Annie        1.33
##  5     2 Annie        1.33
##  6     3 Apopka       0.04
##  7     6 Bryant       0.27
##  8    11 Dorr         0.71
##  9    11 Dorr         0.71
## 10    11 Dorr         0.71
## # ℹ 43 more rows</code></pre>
<p>Proportion exceeding 1 ppm:</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="bootstrap-interval-estimation.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(BootstrapSample2<span class="sc">$</span>Mercury <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">53</span></span></code></pre></div>
<pre><code>## [1] 0.1698113</code></pre>
<p><strong>Bootstrap Sample #3</strong></p>
<p>We’ll take one more bootstrap sample and calculate the proportion of lakes with mercury levels exceeding 1 ppm.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="bootstrap-interval-estimation.html#cb256-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Lake)</span>
<span id="cb256-2"><a href="bootstrap-interval-estimation.html#cb256-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, Lake, Mercury)</span></code></pre></div>
<pre><code>## # A tibble: 53 × 3
##       ID Lake       Mercury
##    &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;
##  1     1 Alligator     1.23
##  2     1 Alligator     1.23
##  3     2 Annie         1.33
##  4     3 Apopka        0.04
##  5     3 Apopka        0.04
##  6     5 Brick         1.2 
##  7     6 Bryant        0.27
##  8     7 Cherry        0.48
##  9     9 Deer Point    0.83
## 10     9 Deer Point    0.83
## # ℹ 43 more rows</code></pre>
<p>Proportion exceeding 1 ppm:</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="bootstrap-interval-estimation.html#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(BootstrapSample3<span class="sc">$</span>Mercury <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">53</span></span></code></pre></div>
<pre><code>## [1] 0.09433962</code></pre>
</div>
<div id="bootstrap-distribution" class="section level3 hasAnchor" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Bootstrap Distribution<a href="bootstrap-interval-estimation.html#bootstrap-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we have seen how bootstrap sampling works, we’ll take a large number (10,000) different bootstrap samples and examine how the proportion of lakes with mercury levels exceeding 1 ppm varies between samples.</p>
<p>We’ll use a <code>for-loop</code> to take many different bootstrap samples and record the observed proportion in a vector called <code>p_hat_b</code></p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="bootstrap-interval-estimation.html#cb260-1" aria-hidden="true" tabindex="-1"></a>p_hat <span class="ot">&lt;-</span> <span class="fu">sum</span>(FloridaLakes<span class="sc">$</span>Mercury <span class="sc">&gt;</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">53</span> <span class="co">#calculate sample statistic</span></span>
<span id="cb260-2"><a href="bootstrap-interval-estimation.html#cb260-2" aria-hidden="true" tabindex="-1"></a>Bootstrap_prop <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">10000</span>)   <span class="co">#setup vector to hold bootstrap statistics</span></span>
<span id="cb260-3"><a href="bootstrap-interval-estimation.html#cb260-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-4"><a href="bootstrap-interval-estimation.html#cb260-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>){</span>
<span id="cb260-5"><a href="bootstrap-interval-estimation.html#cb260-5" aria-hidden="true" tabindex="-1"></a>BootstrapSample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="co">#take bootstrap sample</span></span>
<span id="cb260-6"><a href="bootstrap-interval-estimation.html#cb260-6" aria-hidden="true" tabindex="-1"></a>Bootstrap_prop[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(BootstrapSample<span class="sc">$</span>Mercury <span class="sc">&gt;</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">53</span> <span class="co"># calc. prop exceeding 1</span></span>
<span id="cb260-7"><a href="bootstrap-interval-estimation.html#cb260-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb260-8"><a href="bootstrap-interval-estimation.html#cb260-8" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Prop <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Bootstrap_prop)  <span class="co">#store values in a dataframe</span></span></code></pre></div>
<p>The distribution of proportions observed in the 10,000 different bootstrap samples is shown below. This distribution is called the <strong>bootstrap distribution.</strong></p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="bootstrap-interval-estimation.html#cb261-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Prop_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_Bootstrap_Prop, <span class="fu">aes</span>(<span class="at">x=</span>Bootstrap_prop)) <span class="sc">+</span>  </span>
<span id="cb261-2"><a href="bootstrap-interval-estimation.html#cb261-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb261-3"><a href="bootstrap-interval-estimation.html#cb261-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Prop &gt; 1 in Bootstrap Sample &quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb261-4"><a href="bootstrap-interval-estimation.html#cb261-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Bootstrap Distribution for Prop. of Lakes Exeeding 1 ppm Hg&quot;</span>) <span class="sc">+</span> </span>
<span id="cb261-5"><a href="bootstrap-interval-estimation.html#cb261-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb261-6"><a href="bootstrap-interval-estimation.html#cb261-6" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Prop_plot</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-209-1.png" width="672" /></p>
</div>
<div id="bootstrap-se-confidence-interval" class="section level3 hasAnchor" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> Bootstrap SE Confidence Interval<a href="bootstrap-interval-estimation.html#bootstrap-se-confidence-interval" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We calculate the standard deviation of this bootstrap distribution, which is an estimate of the standard error of <span class="math inline">\(\hat{p}\)</span>.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="bootstrap-interval-estimation.html#cb262-1" aria-hidden="true" tabindex="-1"></a>SE_p_hat <span class="ot">&lt;-</span> <span class="fu">sd</span>(Lakes_Bootstrap_Prop<span class="sc">$</span>Bootstrap_prop)</span></code></pre></div>
<p>Since the bootstrap distribution is roughly symmetric and bell-shaped, we can calculate a 95% confidence interval for the proportion of all Florida lakes with mercury levels exceeding 1 ppm, using bootstrap standard error confidence interval method</p>
<p><span class="math display">\[
\hat{p} \pm 2\times\text{SE}(\hat{p})
\]</span></p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="bootstrap-interval-estimation.html#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(p_hat <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat, p_hat <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat)</span></code></pre></div>
<pre><code>## [1] 0.02684504 0.19957005</code></pre>
<p>We are 95% confident that the proportion of all Florida lakes with mercury levels exceeding 1 ppm is between 0.026845 and 0.1995701.</p>
<p>The gold bar at the bottom of the bootstrap distribution represents this 95% confidence interval.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="bootstrap-interval-estimation.html#cb265-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Prop_plot <span class="sc">+</span> </span>
<span id="cb265-2"><a href="bootstrap-interval-estimation.html#cb265-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>p_hat <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat,<span class="at">xend=</span>p_hat <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>),</span>
<span id="cb265-3"><a href="bootstrap-interval-estimation.html#cb265-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;gold&quot;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-212-1.png" width="672" /></p>
</div>
<div id="bootstrap-distribution-vs-sampling-distribution" class="section level3 hasAnchor" number="4.2.6">
<h3><span class="header-section-number">4.2.6</span> Bootstrap Distribution vs Sampling Distribution<a href="bootstrap-interval-estimation.html#bootstrap-distribution-vs-sampling-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We stated that the standard error of the bootstrap distribution is meant to give us and estimate of the standard error of the statistic of interest (<span class="math inline">\(\hat{p}\)</span> in this case). We do note, however, that the bootstrap distribution is not the same as the sampling distribution for a statistic illustrated in the previous section. The sampling distribution shows the distribution of values the statistic would take on accross many different samples drawn from the population. As such, it will be centered at the true population parameter (<span class="math inline">\(p\)</span> in this case). The bootstrap distribution, on the other hand, shows us the distribution of values the statistic takes on across different bootstrap samples drawn from the original sample, using replacement. Since it comes entirely from the original sample, rather than the population, it will be centered at the sample statistic ( in this case <span class="math inline">\(\hat{p}\)</span>), rather than the unknown <span class="math inline">\(p\)</span>. Nevertheless, the amount of variability in a statistic, calculated between different bootstrap samples, is often a reasonable approximation of the amount of variability we would observe in that statistic if we could take many samples of the same size from the entire population.</p>
</div>
</div>
<div id="bootstrap-confidence-interval-example" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Bootstrap Confidence Interval Example<a href="bootstrap-interval-estimation.html#bootstrap-confidence-interval-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="bootstrapping-other-statistics" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Bootstrapping Other Statistics<a href="bootstrap-interval-estimation.html#bootstrapping-other-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ve seen how to use bootstrapping to calculate confidence intervals for an unknown population parameter <span class="math inline">\(p\)</span>, using an estimate <span class="math inline">\(\hat{p}\)</span>, calculated from a sample of size <span class="math inline">\(n\)</span>. This procedure can be applied to calculate confidence intervals for a wide range of population parameters, using statistics calculated from a sample.</p>
<p>For example, we could calculate confidence intervals any of the following parameters, using the corresponding sample statistic.</p>
<table>
<colgroup>
<col width="35%" />
<col width="32%" />
<col width="32%" />
</colgroup>
<thead>
<tr class="header">
<th>Context</th>
<th>Parameter</th>
<th>Statistic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Proportion</td>
<td><span class="math inline">\(p\)</span></td>
<td><span class="math inline">\(\hat{p}\)</span></td>
</tr>
<tr class="even">
<td>Mean</td>
<td><span class="math inline">\(\mu\)</span></td>
<td><span class="math inline">\(\bar{x}\)</span></td>
</tr>
<tr class="odd">
<td>Standard Deviation</td>
<td><span class="math inline">\(\sigma\)</span></td>
<td><span class="math inline">\(s\)</span></td>
</tr>
<tr class="even">
<td>Median</td>
<td>no comon abbreviations</td>
<td></td>
</tr>
<tr class="odd">
<td>Difference in Means</td>
<td><span class="math inline">\(\mu_2-\mu_1\)</span></td>
<td><span class="math inline">\(\bar{x}_2 - \bar{x}_1\)</span></td>
</tr>
<tr class="even">
<td>Regression Coefficient</td>
<td><span class="math inline">\(\beta_j\)</span></td>
<td><span class="math inline">\(b_j\)</span></td>
</tr>
<tr class="odd">
<td>Estimated Regression Response</td>
<td><span class="math inline">\(\beta_0 + \beta_1x_{i1} + \ldots + \beta_px_{ip}\)</span></td>
<td><span class="math inline">\(b_0 + b_1x_{i1} + \ldots + b_px_{ip}\)</span></td>
</tr>
</tbody>
</table>
<p>We follow the same algorithm as we did when working with a proportion, and simply calculate whatever statistic we are interested in step 2, in place of <span class="math inline">\(\hat{p}\)</span>, as we did previously.</p>
<p>The bootstrap algorithm is given again, below.</p>
<p><strong>Bootstrap Algorithm</strong></p>
<p>For an original sample of size <span class="math inline">\(n\)</span>:</p>
<ol style="list-style-type: decimal">
<li><p>Take a sample of size <span class="math inline">\(n\)</span> by randomly sampling from the original sample with replacement. (Thus some observations will show up multiple times and others not at all.)</p></li>
<li><p>Calculate the statistic of interest in the bootstrap sample.</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, keeping track of the statistic of interest that is calculated in each bootstrap sample.</p></li>
<li><p>Look at the distribution of the statistic across bootstrap samples. The variability in this bootstrap distribution can be used to approximate the variability in the sampling distribution for the statistic of interest.</p></li>
</ol>
<p>We’ll now go through examples, calculating bootstrap confidence intervals for each of the parameters listed above.</p>
</div>
<div id="ci-for-mean" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> CI for Mean<a href="bootstrap-interval-estimation.html#ci-for-mean" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The histogram shows the distribution of mercury levels of the 53 lakes in our sample. The mean and standard deviation in mercury levels for these 53 lakes is shown.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="bootstrap-interval-estimation.html#cb266-1" aria-hidden="true" tabindex="-1"></a>Lakes_Hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>FloridaLakes, <span class="fu">aes</span>(<span class="at">x=</span>Mercury)) <span class="sc">+</span> </span>
<span id="cb266-2"><a href="bootstrap-interval-estimation.html#cb266-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>, <span class="at">binwidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb266-3"><a href="bootstrap-interval-estimation.html#cb266-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Mercury Levels in Sample of Florida Lakes&quot;</span>) <span class="sc">+</span> </span>
<span id="cb266-4"><a href="bootstrap-interval-estimation.html#cb266-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mercury Level&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) </span>
<span id="cb266-5"><a href="bootstrap-interval-estimation.html#cb266-5" aria-hidden="true" tabindex="-1"></a>Lakes_Hist</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-213-1.png" width="672" /></p>
<p>We’ll calculate the mean and median mercury level for the 53 lakes in the sample.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="bootstrap-interval-estimation.html#cb267-1" aria-hidden="true" tabindex="-1"></a>Lakes_Stats <span class="ot">&lt;-</span> FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">MeanHg =</span> <span class="fu">mean</span>(Mercury), </span>
<span id="cb267-2"><a href="bootstrap-interval-estimation.html#cb267-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">StDevHG =</span> <span class="fu">sd</span>(Mercury),</span>
<span id="cb267-3"><a href="bootstrap-interval-estimation.html#cb267-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">N=</span><span class="fu">n</span>())</span>
<span id="cb267-4"><a href="bootstrap-interval-estimation.html#cb267-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Lakes_Stats)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">MeanHg</th>
<th align="right">StDevHG</th>
<th align="right">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.5271698</td>
<td align="right">0.3410356</td>
<td align="right">53</td>
</tr>
</tbody>
</table>
<p>We want to calculate a 95% confidence interval for the mean mercury level among all Florida lakes.
We’ll use bootstrapping again, this time using the sample mean, rather than the proportion exceeding 1 ppm, as our statistic of interest.</p>
<p><strong>Bootstrap Steps</strong></p>
<ol style="list-style-type: decimal">
<li><p>Take a sample of 53 lakes by randomly sampling from the original sample of 53 lakes, with replacement.</p></li>
<li><p>Calculate the mean mercury level in the bootstrap sample.</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, keeping track of the mean mercury level in each bootstrap sample.</p></li>
<li><p>Look at the distribution of the mean across bootstrap samples. The variability in this bootstrap distribution can be used to approximate the variability in the sampling distribution for the mean mercury level.</p></li>
</ol>
<p>We’ll illustrate the procedure on 3 bootstrap samples.</p>
<p><strong>Bootstrap Sample 1</strong></p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="bootstrap-interval-estimation.html#cb268-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Lake)</span>
<span id="cb268-2"><a href="bootstrap-interval-estimation.html#cb268-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, Lake, Mercury)</span></code></pre></div>
<pre><code>## # A tibble: 53 × 3
##       ID Lake         Mercury
##    &lt;int&gt; &lt;chr&gt;          &lt;dbl&gt;
##  1     1 Alligator       1.23
##  2     1 Alligator       1.23
##  3     3 Apopka          0.04
##  4     4 Blue Cypress    0.44
##  5     4 Blue Cypress    0.44
##  6     6 Bryant          0.27
##  7     6 Bryant          0.27
##  8     6 Bryant          0.27
##  9     7 Cherry          0.48
## 10     8 Crescent        0.19
## # ℹ 43 more rows</code></pre>
<p>We calculate the mean mercury level among the lakes in the bootstrap sample.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="bootstrap-interval-estimation.html#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(BootstrapSample1<span class="sc">$</span>Mercury)</span></code></pre></div>
<pre><code>## [1] 0.4986792</code></pre>
<p><strong>Bootstrap Sample #2</strong></p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="bootstrap-interval-estimation.html#cb272-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Lake)</span>
<span id="cb272-2"><a href="bootstrap-interval-estimation.html#cb272-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, Lake, Mercury)</span></code></pre></div>
<pre><code>## # A tibble: 53 × 3
##       ID Lake         Mercury
##    &lt;int&gt; &lt;chr&gt;          &lt;dbl&gt;
##  1     1 Alligator       1.23
##  2     3 Apopka          0.04
##  3     4 Blue Cypress    0.44
##  4     6 Bryant          0.27
##  5     6 Bryant          0.27
##  6     7 Cherry          0.48
##  7     7 Cherry          0.48
##  8     8 Crescent        0.19
##  9     8 Crescent        0.19
## 10     8 Crescent        0.19
## # ℹ 43 more rows</code></pre>
<p>Mean Mercury Level:</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="bootstrap-interval-estimation.html#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(BootstrapSample2<span class="sc">$</span>Mercury)</span></code></pre></div>
<pre><code>## [1] 0.5192453</code></pre>
<p><strong>Bootstrap Sample #3</strong></p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="bootstrap-interval-estimation.html#cb276-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Lake)</span>
<span id="cb276-2"><a href="bootstrap-interval-estimation.html#cb276-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, Lake, Mercury)</span></code></pre></div>
<pre><code>## # A tibble: 53 × 3
##       ID Lake         Mercury
##    &lt;int&gt; &lt;chr&gt;          &lt;dbl&gt;
##  1     1 Alligator       1.23
##  2     2 Annie           1.33
##  3     4 Blue Cypress    0.44
##  4     6 Bryant          0.27
##  5     6 Bryant          0.27
##  6     8 Crescent        0.19
##  7    12 Down            0.5 
##  8    12 Down            0.5 
##  9    12 Down            0.5 
## 10    13 Eaton           0.49
## # ℹ 43 more rows</code></pre>
<p>Mean Mercury Level:</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="bootstrap-interval-estimation.html#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(BootstrapSample3<span class="sc">$</span>Mercury)</span></code></pre></div>
<pre><code>## [1] 0.445283</code></pre>
<p>Now, we’ll take 10,000 bootstrap samples, and record the mean mercury concentration in each sample.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="bootstrap-interval-estimation.html#cb280-1" aria-hidden="true" tabindex="-1"></a>mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(FloridaLakes<span class="sc">$</span>Mercury)  <span class="co">#calculate sample statistic</span></span>
<span id="cb280-2"><a href="bootstrap-interval-estimation.html#cb280-2" aria-hidden="true" tabindex="-1"></a>Bootstrap_Mean <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">10000</span>) <span class="co"># setup vector to hold bootstrap statistics</span></span>
<span id="cb280-3"><a href="bootstrap-interval-estimation.html#cb280-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-4"><a href="bootstrap-interval-estimation.html#cb280-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>){</span>
<span id="cb280-5"><a href="bootstrap-interval-estimation.html#cb280-5" aria-hidden="true" tabindex="-1"></a>BootstrapSample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="co"># take bootstrap sample</span></span>
<span id="cb280-6"><a href="bootstrap-interval-estimation.html#cb280-6" aria-hidden="true" tabindex="-1"></a>Bootstrap_Mean[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BootstrapSample<span class="sc">$</span>Mercury) <span class="co"># calculate mean in bootstrap sample</span></span>
<span id="cb280-7"><a href="bootstrap-interval-estimation.html#cb280-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb280-8"><a href="bootstrap-interval-estimation.html#cb280-8" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Results_Mean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Bootstrap_Mean)  <span class="co">#store results in data frame</span></span></code></pre></div>
<p>The bootstrap distribution for the mean mercury level is shown below, along with its standard error.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="bootstrap-interval-estimation.html#cb281-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Mean_Plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_Bootstrap_Results_Mean, </span>
<span id="cb281-2"><a href="bootstrap-interval-estimation.html#cb281-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">aes</span>(<span class="at">x=</span>Bootstrap_Mean)) <span class="sc">+</span>  </span>
<span id="cb281-3"><a href="bootstrap-interval-estimation.html#cb281-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb281-4"><a href="bootstrap-interval-estimation.html#cb281-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mean Mercury in Bootstrap Sample &quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb281-5"><a href="bootstrap-interval-estimation.html#cb281-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Bootstrap Distribution for Sample Mean in Florida Lakes&quot;</span>) <span class="sc">+</span> </span>
<span id="cb281-6"><a href="bootstrap-interval-estimation.html#cb281-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) </span>
<span id="cb281-7"><a href="bootstrap-interval-estimation.html#cb281-7" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Mean_Plot </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-222-1.png" width="672" /></p>
<p>We’ll calculate the standard error of the mean. This is a measure of how much the mean varies between samples.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="bootstrap-interval-estimation.html#cb282-1" aria-hidden="true" tabindex="-1"></a>SE_mean <span class="ot">&lt;-</span> <span class="fu">sd</span>(Lakes_Bootstrap_Results_Mean<span class="sc">$</span>Bootstrap_Mean)</span>
<span id="cb282-2"><a href="bootstrap-interval-estimation.html#cb282-2" aria-hidden="true" tabindex="-1"></a>SE_mean</span></code></pre></div>
<pre><code>## [1] 0.04655744</code></pre>
<p>Notice that the standard error of the mean is much less than the sample standard deviation of 0.341.</p>
<p><strong>Interpretations of sample standard deviation and standard error of the mean</strong></p>
<ul>
<li>The sample standard deviation measures the amount of variability in mercury levels between the 53 individual lakes in our sample.<br />
</li>
<li>The standard error of the mean measures the amount of variability in sample mean mercury levels between different samples of size 53.</li>
</ul>
<p>There is more variability between mercury levels in individual lakes than there is between average mercury levels in different samples of size 53.</p>
<p>Since the bootstrap distribution is roughly symmetric and bell-shaped, we can use the bootstrap standard error method to calculate an approximate 95% confidence interval for the mean mercury level among all Florida lakes.</p>
<p><span class="math display">\[
\text{Statistic} \pm 2\times\text{Standard Error}
\]</span></p>
<p>In this case, the statistic of interest is the sample mean <span class="math inline">\(\bar{x}=0.527\)</span>. The confidence interval is</p>
<p><span class="math display">\[
\begin{aligned}
&amp; \bar{x} \pm 2\times\text{SE}(\bar{x}) \\
&amp; = 0.527 \pm 2\times\text{0.0465574}
\end{aligned}
\]</span></p>
<p>95% Confidence Interval:</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="bootstrap-interval-estimation.html#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(mean <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_mean, mean <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_mean) </span></code></pre></div>
<pre><code>## [1] 0.4340549 0.6202847</code></pre>
<p>The 95% confidence interval is shown by the gold bar on the graph of the bootstrap distribution below.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="bootstrap-interval-estimation.html#cb286-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Mean_Plot <span class="sc">+</span> </span>
<span id="cb286-2"><a href="bootstrap-interval-estimation.html#cb286-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>mean <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_mean,<span class="at">xend=</span>mean <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_mean, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb286-3"><a href="bootstrap-interval-estimation.html#cb286-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;gold&quot;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-225-1.png" width="672" /></p>
<p>We are 95% confident that the average mercury level among all Florida lakes is between 0.4340549 and 0.6202847 parts per million.</p>
<p>It is important to note that we are not saying that we are 95% confident that an individual lake lie in this range, or that 95% of all individual lakes lie in this range. We are only saying that we are confident that the <em>average</em> mercury level among all lakes lies in this range. A confidence interval is a statement about a population parameter (in this case the average mercury level), rather than about individual lakes in the population. Since there is more variability about individual lakes than overall averages, we’ll need to make a wider interval when talking about the mercury level for an individual lake.</p>
</div>
<div id="ci-for-standard-deviation" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> CI for Standard Deviation<a href="bootstrap-interval-estimation.html#ci-for-standard-deviation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now, we’ll calculate a confidence interval for the standard deviation in mercury levels among all Florida lakes. Recall that the sample standard deviation (<span class="math inline">\(s\)</span>) was:</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="bootstrap-interval-estimation.html#cb287-1" aria-hidden="true" tabindex="-1"></a>Sample_SD <span class="ot">&lt;-</span> <span class="fu">sd</span>(FloridaLakes<span class="sc">$</span>Mercury)</span>
<span id="cb287-2"><a href="bootstrap-interval-estimation.html#cb287-2" aria-hidden="true" tabindex="-1"></a>Sample_SD</span></code></pre></div>
<pre><code>## [1] 0.3410356</code></pre>
<p>We’ll use this estimate to calculate a confidence interval for the population standard deviation <span class="math inline">\(\sigma\)</span>.</p>
<p>This time, our statistic of interest is the sample standard deviation <span class="math inline">\(s\)</span>.</p>
<p><strong>Bootstrap Steps</strong></p>
<ol style="list-style-type: decimal">
<li><p>Take a sample of 53 lakes by randomly sampling from the original sample of 53 lakes, with replacement.</p></li>
<li><p>Calculate the standard deviation in mercury level in the bootstrap sample.</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, keeping track of the standard deviation mercury level in each bootstrap sample.</p></li>
<li><p>Look at the distribution of the standard deviations across bootstrap samples. The variability in this bootstrap distribution can be used to approximate the variability in the sampling distribution for the standard deviation in mercury level.</p></li>
</ol>
<p>We’ll illustrate the procedure on 3 bootstrap samples.</p>
<p><strong>Bootstrap Sample 1</strong></p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="bootstrap-interval-estimation.html#cb289-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Lake)</span>
<span id="cb289-2"><a href="bootstrap-interval-estimation.html#cb289-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, Lake, Mercury)</span></code></pre></div>
<pre><code>## # A tibble: 53 × 3
##       ID Lake       Mercury
##    &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;
##  1     2 Annie         1.33
##  2     3 Apopka        0.04
##  3     3 Apopka        0.04
##  4     5 Brick         1.2 
##  5     6 Bryant        0.27
##  6     7 Cherry        0.48
##  7     7 Cherry        0.48
##  8     8 Crescent      0.19
##  9     8 Crescent      0.19
## 10     9 Deer Point    0.83
## # ℹ 43 more rows</code></pre>
<p>We calculate the standard deviation in mercury levels among the lakes in the bootstrap sample.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="bootstrap-interval-estimation.html#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(BootstrapSample1<span class="sc">$</span>Mercury)</span></code></pre></div>
<pre><code>## [1] 0.3169752</code></pre>
<p><strong>Bootstrap Sample #2</strong></p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="bootstrap-interval-estimation.html#cb293-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Lake)</span>
<span id="cb293-2"><a href="bootstrap-interval-estimation.html#cb293-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, Lake, Mercury)</span></code></pre></div>
<pre><code>## # A tibble: 53 × 3
##       ID Lake       Mercury
##    &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;
##  1     2 Annie         1.33
##  2     2 Annie         1.33
##  3     3 Apopka        0.04
##  4     5 Brick         1.2 
##  5     5 Brick         1.2 
##  6     8 Crescent      0.19
##  7     8 Crescent      0.19
##  8     9 Deer Point    0.83
##  9     9 Deer Point    0.83
## 10    12 Down          0.5 
## # ℹ 43 more rows</code></pre>
<p>Standard Deviation in Mercury Level:</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="bootstrap-interval-estimation.html#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(BootstrapSample2<span class="sc">$</span>Mercury)</span></code></pre></div>
<pre><code>## [1] 0.3927499</code></pre>
<p><strong>Bootstrap Sample #3</strong></p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="bootstrap-interval-estimation.html#cb297-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Lake)</span>
<span id="cb297-2"><a href="bootstrap-interval-estimation.html#cb297-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, Lake, Mercury)</span></code></pre></div>
<pre><code>## # A tibble: 53 × 3
##       ID Lake       Mercury
##    &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;
##  1     2 Annie         1.33
##  2     2 Annie         1.33
##  3     5 Brick         1.2 
##  4     5 Brick         1.2 
##  5     6 Bryant        0.27
##  6     6 Bryant        0.27
##  7     9 Deer Point    0.83
##  8     9 Deer Point    0.83
##  9     9 Deer Point    0.83
## 10     9 Deer Point    0.83
## # ℹ 43 more rows</code></pre>
<p>Standard Deviation Mercury Level:</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="bootstrap-interval-estimation.html#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(BootstrapSample3<span class="sc">$</span>Mercury)</span></code></pre></div>
<pre><code>## [1] 0.3589536</code></pre>
<p>Now, we’ll take 10,000 bootstrap samples, and record the standard deviation in mercury concentration in each sample.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="bootstrap-interval-estimation.html#cb301-1" aria-hidden="true" tabindex="-1"></a>Sample_SD <span class="ot">&lt;-</span> <span class="fu">sd</span>(FloridaLakes<span class="sc">$</span>Mercury)  <span class="co">#calculate sample statistic</span></span>
<span id="cb301-2"><a href="bootstrap-interval-estimation.html#cb301-2" aria-hidden="true" tabindex="-1"></a>Bootstrap_SD <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">10000</span>) <span class="co"># setup vector to hold bootstrap statistics</span></span>
<span id="cb301-3"><a href="bootstrap-interval-estimation.html#cb301-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-4"><a href="bootstrap-interval-estimation.html#cb301-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>){</span>
<span id="cb301-5"><a href="bootstrap-interval-estimation.html#cb301-5" aria-hidden="true" tabindex="-1"></a>BootstrapSample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="co"># take bootstrap sample</span></span>
<span id="cb301-6"><a href="bootstrap-interval-estimation.html#cb301-6" aria-hidden="true" tabindex="-1"></a>Bootstrap_SD[i] <span class="ot">&lt;-</span> <span class="fu">sd</span>(BootstrapSample<span class="sc">$</span>Mercury) <span class="co"># calculate standard deviation in bootstrap sample</span></span>
<span id="cb301-7"><a href="bootstrap-interval-estimation.html#cb301-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb301-8"><a href="bootstrap-interval-estimation.html#cb301-8" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Results_SD <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Bootstrap_SD)  <span class="co">#store results in data frame</span></span></code></pre></div>
<p>The bootstrap distribution for the mean mercury level is shown below, along with its standard error.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="bootstrap-interval-estimation.html#cb302-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_SD_Plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_Bootstrap_Results_SD, </span>
<span id="cb302-2"><a href="bootstrap-interval-estimation.html#cb302-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">aes</span>(<span class="at">x=</span>Bootstrap_SD)) <span class="sc">+</span>  </span>
<span id="cb302-3"><a href="bootstrap-interval-estimation.html#cb302-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb302-4"><a href="bootstrap-interval-estimation.html#cb302-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;SD in Mercury in Bootstrap Sample &quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb302-5"><a href="bootstrap-interval-estimation.html#cb302-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Bootstrap Distribution for Sample SD in Florida Lakes&quot;</span>) <span class="sc">+</span> </span>
<span id="cb302-6"><a href="bootstrap-interval-estimation.html#cb302-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) </span>
<span id="cb302-7"><a href="bootstrap-interval-estimation.html#cb302-7" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_SD_Plot </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-234-1.png" width="672" /></p>
<p>We’ll calculate the standard error of the standard deviation. This is a measure of how much the standard deviation varies between samples.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="bootstrap-interval-estimation.html#cb303-1" aria-hidden="true" tabindex="-1"></a>SE_SD <span class="ot">&lt;-</span> <span class="fu">sd</span>(Lakes_Bootstrap_Results_SD<span class="sc">$</span>Bootstrap_SD)</span>
<span id="cb303-2"><a href="bootstrap-interval-estimation.html#cb303-2" aria-hidden="true" tabindex="-1"></a>SE_SD</span></code></pre></div>
<pre><code>## [1] 0.02869572</code></pre>
<p>Since the bootstrap distribution is roughly symmetric and bell-shaped, we can use the bootstrap standard error method to calculate an approximate 95% confidence interval for the standard deviation in mercury levels among all Florida lakes.</p>
<p><span class="math display">\[
\text{Statistic} \pm 2\times\text{Standard Error}
\]</span></p>
<p>In this case, the statistic of interest is the sample standard deviation <span class="math inline">\(s=0.341\)</span>. The confidence interval is</p>
<p><span class="math display">\[
\begin{aligned}
&amp; s \pm 2\times\text{SE}(s) \\
&amp; = 0.341 \pm 2\times{0.029}
\end{aligned}
\]</span>
95% Confidence Interval:</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="bootstrap-interval-estimation.html#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(Sample_SD <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_SD, Sample_SD <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_SD        ) </span></code></pre></div>
<pre><code>## [1] 0.2836442 0.3984271</code></pre>
<p>The 95% confidence interval is shown by the gold bar on the graph of the bootstrap distribution below.</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="bootstrap-interval-estimation.html#cb307-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_SD_Plot <span class="sc">+</span> </span>
<span id="cb307-2"><a href="bootstrap-interval-estimation.html#cb307-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sample_SD <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_SD,<span class="at">xend=</span>Sample_SD <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_SD, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb307-3"><a href="bootstrap-interval-estimation.html#cb307-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;gold&quot;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-237-1.png" width="672" /></p>
<p>We are 95% confident that the standard deviation in mercury levels among all Florida lakes is between 0.2836442 and 0.3984271 parts per million.</p>
</div>
<div id="ci-for-median" class="section level3 hasAnchor" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> CI for Median<a href="bootstrap-interval-estimation.html#ci-for-median" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We already calculated a confidence interval for the mean mercury level among all Florida lakes. We could calculate a bootstrap confidence interval for the median mercury level as well, but since the distribution of mercury levels in the lakes is roughly symmetric, the mean is a reasonable measure of center, and there is not a clear reason for using the median instead.</p>
<p>When a distribution is skewed or contains large outliers, however, the median is a more robust measure of center than the mean. Recall the distribution of 100 Seattle house prices seen in Chapters 1 and 2.</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="bootstrap-interval-estimation.html#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Houses, <span class="fu">aes</span>(<span class="at">x=</span>price)) <span class="sc">+</span> </span>
<span id="cb308-2"><a href="bootstrap-interval-estimation.html#cb308-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">+</span> </span>
<span id="cb308-3"><a href="bootstrap-interval-estimation.html#cb308-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Distribution of House Prices&quot;</span>) <span class="sc">+</span></span>
<span id="cb308-4"><a href="bootstrap-interval-estimation.html#cb308-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Price&quot;</span>) <span class="sc">+</span> </span>
<span id="cb308-5"><a href="bootstrap-interval-estimation.html#cb308-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-238-1.png" width="672" /></p>
<p>These 100 houses are a sample of all houses sold in Seattle in 2014 and 2015, so we can use statistics from our sample to draw conclusions about all houses sold in Seattle in this time period.</p>
<p>In this subsection, we’ll use bootstrapping to calculate a 95% confidence interval for the median price among all houses sold in Seattle in this time period.</p>
<p>We calculate the sample median price.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="bootstrap-interval-estimation.html#cb309-1" aria-hidden="true" tabindex="-1"></a>Sample_Median <span class="ot">&lt;-</span> <span class="fu">median</span>(Houses<span class="sc">$</span>price)</span>
<span id="cb309-2"><a href="bootstrap-interval-estimation.html#cb309-2" aria-hidden="true" tabindex="-1"></a>Sample_Median</span></code></pre></div>
<pre><code>## [1] 507.5</code></pre>
<p><strong>Bootstrap Steps</strong></p>
<ol style="list-style-type: decimal">
<li><p>Take a sample of 100 houses by randomly sampling from the original sample of 100 houses, with replacement.</p></li>
<li><p>Calculate the median price in the bootstrap sample.</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, keeping track of the median price in each bootstrap sample.</p></li>
<li><p>Look at the distribution of the median price across bootstrap samples. The variability in this bootstrap distribution can be used to approximate the variability in the sampling distribution for the median price.</p></li>
</ol>
<p>We’ll illustrate the procedure on 3 bootstrap samples.</p>
<p><strong>Bootstrap Sample 1</strong></p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="bootstrap-interval-estimation.html#cb311-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(Houses, <span class="dv">100</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Id)</span>
<span id="cb311-2"><a href="bootstrap-interval-estimation.html#cb311-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(Id, price)</span></code></pre></div>
<pre><code>## # A tibble: 100 × 2
##       Id price
##    &lt;int&gt; &lt;dbl&gt;
##  1     1 1225 
##  2     1 1225 
##  3     1 1225 
##  4     4  253.
##  5     4  253.
##  6     6  310.
##  7     7  550.
##  8     7  550.
##  9     9  315.
## 10    11  410 
## # ℹ 90 more rows</code></pre>
<p>We calculate the median price among the houses in the bootstrap sample.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="bootstrap-interval-estimation.html#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(BootstrapSample1<span class="sc">$</span>price)</span></code></pre></div>
<pre><code>## [1] 520</code></pre>
<p><strong>Bootstrap Sample #2</strong></p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="bootstrap-interval-estimation.html#cb315-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(Houses, <span class="dv">100</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Id)</span>
<span id="cb315-2"><a href="bootstrap-interval-estimation.html#cb315-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="sc">%&gt;%</span> <span class="fu">select</span>(Id, price)</span></code></pre></div>
<pre><code>## # A tibble: 100 × 2
##       Id price
##    &lt;int&gt; &lt;dbl&gt;
##  1     2  885.
##  2     2  885.
##  3     4  253.
##  4     4  253.
##  5     5  468.
##  6     6  310.
##  7     7  550.
##  8     7  550.
##  9     7  550.
## 10     8  485.
## # ℹ 90 more rows</code></pre>
<p>Median Price:</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="bootstrap-interval-estimation.html#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(BootstrapSample2<span class="sc">$</span>price)</span></code></pre></div>
<pre><code>## [1] 510</code></pre>
<p><strong>Bootstrap Sample #3</strong></p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="bootstrap-interval-estimation.html#cb319-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(Houses, <span class="dv">100</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Id)</span>
<span id="cb319-2"><a href="bootstrap-interval-estimation.html#cb319-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="sc">%&gt;%</span> <span class="fu">select</span>(Id, price)</span></code></pre></div>
<pre><code>## # A tibble: 100 × 2
##       Id price
##    &lt;int&gt; &lt;dbl&gt;
##  1     1 1225 
##  2     1 1225 
##  3     1 1225 
##  4     2  885.
##  5     4  253.
##  6     5  468.
##  7     6  310.
##  8     8  485.
##  9     8  485.
## 10     8  485.
## # ℹ 90 more rows</code></pre>
<p>Median Price:</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="bootstrap-interval-estimation.html#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(BootstrapSample3<span class="sc">$</span>price)</span></code></pre></div>
<pre><code>## [1] 538</code></pre>
<p>Now, we’ll take 10,000 bootstrap samples, and record the median price in each sample.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="bootstrap-interval-estimation.html#cb323-1" aria-hidden="true" tabindex="-1"></a>Sample_Med <span class="ot">&lt;-</span> <span class="fu">median</span>(Houses<span class="sc">$</span>price)  <span class="co">#calculate sample median</span></span>
<span id="cb323-2"><a href="bootstrap-interval-estimation.html#cb323-2" aria-hidden="true" tabindex="-1"></a>Bootstrap_Med <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">10000</span>) <span class="co"># setup vector to hold bootstrap statistics</span></span>
<span id="cb323-3"><a href="bootstrap-interval-estimation.html#cb323-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-4"><a href="bootstrap-interval-estimation.html#cb323-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>){</span>
<span id="cb323-5"><a href="bootstrap-interval-estimation.html#cb323-5" aria-hidden="true" tabindex="-1"></a>BootstrapSample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(Houses, <span class="dv">100</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="co"># take bootstrap sample</span></span>
<span id="cb323-6"><a href="bootstrap-interval-estimation.html#cb323-6" aria-hidden="true" tabindex="-1"></a>Bootstrap_Med[i] <span class="ot">&lt;-</span> <span class="fu">median</span>(BootstrapSample<span class="sc">$</span>price) <span class="co"># calculate standard deviation in bootstrap sample</span></span>
<span id="cb323-7"><a href="bootstrap-interval-estimation.html#cb323-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb323-8"><a href="bootstrap-interval-estimation.html#cb323-8" aria-hidden="true" tabindex="-1"></a>Houses_Bootstrap_Results_Med <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Bootstrap_Med)  <span class="co">#store results in data frame</span></span></code></pre></div>
<p>The bootstrap distribution for the median price is shown below, along with its standard error.</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="bootstrap-interval-estimation.html#cb324-1" aria-hidden="true" tabindex="-1"></a>Houses_Bootstrap_Med_Plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Houses_Bootstrap_Results_Med, </span>
<span id="cb324-2"><a href="bootstrap-interval-estimation.html#cb324-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">aes</span>(<span class="at">x=</span>Bootstrap_Med)) <span class="sc">+</span>  </span>
<span id="cb324-3"><a href="bootstrap-interval-estimation.html#cb324-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb324-4"><a href="bootstrap-interval-estimation.html#cb324-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Median Price in Bootstrap Sample &quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb324-5"><a href="bootstrap-interval-estimation.html#cb324-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Bootstrap Distribution for Median Price in Seattle Houses&quot;</span>) <span class="sc">+</span> </span>
<span id="cb324-6"><a href="bootstrap-interval-estimation.html#cb324-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) </span>
<span id="cb324-7"><a href="bootstrap-interval-estimation.html#cb324-7" aria-hidden="true" tabindex="-1"></a>Houses_Bootstrap_Med_Plot </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-247-1.png" width="672" /></p>
<p>We’ll calculate the standard error of the median. This is a measure of how much the median varies between samples.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="bootstrap-interval-estimation.html#cb325-1" aria-hidden="true" tabindex="-1"></a>SE_Med <span class="ot">&lt;-</span> <span class="fu">sd</span>(Houses_Bootstrap_Results_Med<span class="sc">$</span>Bootstrap_Med)</span>
<span id="cb325-2"><a href="bootstrap-interval-estimation.html#cb325-2" aria-hidden="true" tabindex="-1"></a>SE_Med</span></code></pre></div>
<pre><code>## [1] 47.88898</code></pre>
<p>The standard error measures the amount of variability in median house price between different samples of size 100.</p>
<p>Note that this is different than the sample standard deviation, which represents the standard deviation in prices between the 100 different houses in the sample.</p>
<p>Notice that the bootstrap distribution for the median is not symmetric and bell-shaped. Thus, we cannot be assured that 95% of samples will produce a statistic within two standard errors of the mean, so the standard error confidence interval method is not appropriate here. Instead, we’ll calculate a confidence interval by taking the middle 95% of the values in the bootstrap distribution. A cionfidence interval calculated this way is called a <strong>percentile bootstrap interval</strong>.</p>
<p>We’ll calculate the 0.025 quantile and the 0.975 quantile of this bootstrap distribution. These are the points below which lie 2.5% and 97.5% of the medians in the bootstrap distribution. Thus, the middle 95% of the medians lie between these values.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="bootstrap-interval-estimation.html#cb327-1" aria-hidden="true" tabindex="-1"></a>q<span class="fl">.025</span> <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Houses_Bootstrap_Results_Med<span class="sc">$</span>Bootstrap_Med, <span class="fl">0.025</span>)</span>
<span id="cb327-2"><a href="bootstrap-interval-estimation.html#cb327-2" aria-hidden="true" tabindex="-1"></a>q<span class="fl">.025</span></span></code></pre></div>
<pre><code>## 2.5% 
##  410</code></pre>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="bootstrap-interval-estimation.html#cb329-1" aria-hidden="true" tabindex="-1"></a>q<span class="fl">.975</span> <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Houses_Bootstrap_Results_Med<span class="sc">$</span>Bootstrap_Med, <span class="fl">0.975</span>)</span>
<span id="cb329-2"><a href="bootstrap-interval-estimation.html#cb329-2" aria-hidden="true" tabindex="-1"></a>q<span class="fl">.975</span> </span></code></pre></div>
<pre><code>## 97.5% 
##   600</code></pre>
<p>The 95% confidence interval is shown by the gold bar on the graph of the bootstrap distribution below.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="bootstrap-interval-estimation.html#cb331-1" aria-hidden="true" tabindex="-1"></a>Houses_Bootstrap_Med_Plot <span class="sc">+</span> </span>
<span id="cb331-2"><a href="bootstrap-interval-estimation.html#cb331-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>q<span class="fl">.025</span>,<span class="at">xend=</span>q<span class="fl">.975</span>, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb331-3"><a href="bootstrap-interval-estimation.html#cb331-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;gold&quot;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-251-1.png" width="672" /></p>
<p>We are 95% confident that the median price among all houses that sold in Seattle between 2014 and 2015 is between 410 and 600 thousand dollars.</p>
</div>
<div id="ci-for-difference-in-means" class="section level3 hasAnchor" number="4.3.5">
<h3><span class="header-section-number">4.3.5</span> CI for Difference in Means<a href="bootstrap-interval-estimation.html#ci-for-difference-in-means" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We previously calculated a confidence interval for the average mercury level among all lakes in Florida.</p>
<p>Now, we’ll calculate an interval for the difference in average mercury levels between lakes in Northern Florida, compared to Southern Florida.</p>
<p>The boxplot shows and table below describe the distribution of mercury levels for lakes in Northern Florida, compared to Southern Florida.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="bootstrap-interval-estimation.html#cb332-1" aria-hidden="true" tabindex="-1"></a>LakesBP <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>FloridaLakes, <span class="fu">aes</span>(<span class="at">x=</span>Location, <span class="at">y=</span>Mercury, <span class="at">fill=</span>Location)) <span class="sc">+</span> </span>
<span id="cb332-2"><a href="bootstrap-interval-estimation.html#cb332-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span>   <span class="fu">geom_jitter</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Mercury Levels in Florida Lakes&quot;</span>) <span class="sc">+</span> </span>
<span id="cb332-3"><a href="bootstrap-interval-estimation.html#cb332-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Location&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Mercury Level&quot;</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span> <span class="fu">coord_flip</span>()</span>
<span id="cb332-4"><a href="bootstrap-interval-estimation.html#cb332-4" aria-hidden="true" tabindex="-1"></a>LakesBP</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-253-1.png" width="672" /></p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="bootstrap-interval-estimation.html#cb333-1" aria-hidden="true" tabindex="-1"></a>LakesTable <span class="ot">&lt;-</span> FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Location) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">MeanHg=</span><span class="fu">mean</span>(Mercury), </span>
<span id="cb333-2"><a href="bootstrap-interval-estimation.html#cb333-2" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">StDevHg=</span><span class="fu">sd</span>(Mercury), </span>
<span id="cb333-3"><a href="bootstrap-interval-estimation.html#cb333-3" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">N=</span><span class="fu">n</span>())</span>
<span id="cb333-4"><a href="bootstrap-interval-estimation.html#cb333-4" aria-hidden="true" tabindex="-1"></a>LakesTable</span></code></pre></div>
<pre><code>## # A tibble: 2 × 4
##   Location MeanHg StDevHg     N
##   &lt;fct&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;
## 1 N         0.425   0.270    33
## 2 S         0.696   0.384    20</code></pre>
<p>In our sample of 33 Northern Lakes and 20 Southern Lakes, we saw a difference of 0.27 ppm. We’ll calculate a confidence interval to estimate how big or small this difference could be among all Florida lakes.</p>
<p>We’ll use a statistical model to calculate the average mercury levels in Northern and Southern Florida.</p>
<p><span class="math inline">\(\widehat{\text{Mercury}} = b_0 +b_1\times{\text{South}}\)</span></p>
<ul>
<li><span class="math inline">\(b_0\)</span> represents the mean mercury level for lakes in North Florida, and<br />
</li>
<li><span class="math inline">\(b_1\)</span> represents the mean difference in mercury level for lakes in South Florida, compared to North Florida</li>
</ul>
<p>The estimates for corresponding to the original sample are shown below.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="bootstrap-interval-estimation.html#cb335-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>Location)</span>
<span id="cb335-2"><a href="bootstrap-interval-estimation.html#cb335-2" aria-hidden="true" tabindex="-1"></a>M</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Mercury ~ Location, data = FloridaLakes)
## 
## Coefficients:
## (Intercept)    LocationS  
##      0.4245       0.2720</code></pre>
<p>Thus, we can obtain a confidence interval for the difference in average mercury levels by fitting a regression model to each of our bootstrap samples and recording the value of the sample statistic <span class="math inline">\(b_1\)</span>, which represents this difference. Alternatively, we could calculate the mean from each group separately and subtract.</p>
<p>When comparing groups, we make one modification in Step #1 of the bootstrap process. Rather than drawing a sample of size <span class="math inline">\(n\)</span> at random, with replacement, we’ll draw the same number of observations from each group as were in the original sample. In this case, we had 33 northern lakes, and 20 southern lakes.</p>
<p><strong>Bootstrap Steps</strong></p>
<ol style="list-style-type: decimal">
<li><p>Take a sample of 33 northern lakes and 20 southern lakes by randomly sampling from the original sample, with replacement.</p></li>
<li><p>Fit a regression model with location as the explanatory variable and record the value of <span class="math inline">\(b_1\)</span>, representing the difference between the means for each group (South-North).</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, keeping track of the difference in means in each bootstrap sample.</p></li>
<li><p>Look at the distribution of the differences in means across bootstrap samples. The variability in this bootstrap distribution can be used to approximate the variability in the sampling distribution for the difference in means between mercury levels in Northern and Southern Florida.</p></li>
</ol>
<p>We’ll illustrate the procedure on 3 bootstrap samples.</p>
<p><strong>Bootstrap Sample 1</strong></p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="bootstrap-interval-estimation.html#cb337-1" aria-hidden="true" tabindex="-1"></a>NLakes <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Location<span class="sc">==</span><span class="st">&quot;N&quot;</span>), <span class="dv">33</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)   <span class="do">## sample 33 northern lakes</span></span>
<span id="cb337-2"><a href="bootstrap-interval-estimation.html#cb337-2" aria-hidden="true" tabindex="-1"></a>SLakes <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Location<span class="sc">==</span><span class="st">&quot;S&quot;</span>), <span class="dv">20</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)   <span class="do">## sample 20 southern lakes</span></span>
<span id="cb337-3"><a href="bootstrap-interval-estimation.html#cb337-3" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(NLakes, SLakes) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb337-4"><a href="bootstrap-interval-estimation.html#cb337-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Lake, Location, Mercury)   <span class="do">## combine Northern and Southern Lakes</span></span>
<span id="cb337-5"><a href="bootstrap-interval-estimation.html#cb337-5" aria-hidden="true" tabindex="-1"></a>BootstrapSample1</span></code></pre></div>
<pre><code>## # A tibble: 53 × 4
##       ID Lake      Location Mercury
##    &lt;int&gt; &lt;chr&gt;     &lt;fct&gt;      &lt;dbl&gt;
##  1     1 Alligator S           1.23
##  2     2 Annie     S           1.33
##  3     3 Apopka    N           0.04
##  4     6 Bryant    N           0.27
##  5     7 Cherry    N           0.48
##  6     8 Crescent  N           0.19
##  7     8 Crescent  N           0.19
##  8    11 Dorr      N           0.71
##  9    12 Down      S           0.5 
## 10    12 Down      S           0.5 
## # ℹ 43 more rows</code></pre>
<p>We fit a regression model to the bootstrap sample and calculate the regression coefficients. We’re interested in the second coefficient, <span class="math inline">\(b_1\)</span>, which represents the mean difference between lakes in Southern and Northern Florida</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="bootstrap-interval-estimation.html#cb339-1" aria-hidden="true" tabindex="-1"></a>Mb1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample1, Mercury <span class="sc">~</span> Location) <span class="do">## fit linear model</span></span>
<span id="cb339-2"><a href="bootstrap-interval-estimation.html#cb339-2" aria-hidden="true" tabindex="-1"></a>Mb1</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Mercury ~ Location, data = BootstrapSample1)
## 
## Coefficients:
## (Intercept)    LocationS  
##      0.3864       0.2391</code></pre>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="bootstrap-interval-estimation.html#cb341-1" aria-hidden="true" tabindex="-1"></a>NLakes <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Location<span class="sc">==</span><span class="st">&quot;N&quot;</span>), <span class="dv">33</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)   <span class="do">## sample 33 northern lakes</span></span>
<span id="cb341-2"><a href="bootstrap-interval-estimation.html#cb341-2" aria-hidden="true" tabindex="-1"></a>SLakes <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Location<span class="sc">==</span><span class="st">&quot;S&quot;</span>), <span class="dv">20</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)   <span class="do">## sample 20 southern lakes</span></span>
<span id="cb341-3"><a href="bootstrap-interval-estimation.html#cb341-3" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(NLakes, SLakes) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb341-4"><a href="bootstrap-interval-estimation.html#cb341-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Lake, Location, Mercury)   <span class="do">## combine Northern and Southern Lakes</span></span>
<span id="cb341-5"><a href="bootstrap-interval-estimation.html#cb341-5" aria-hidden="true" tabindex="-1"></a>BootstrapSample2</span></code></pre></div>
<pre><code>## # A tibble: 53 × 4
##       ID Lake         Location Mercury
##    &lt;int&gt; &lt;chr&gt;        &lt;fct&gt;      &lt;dbl&gt;
##  1     1 Alligator    S           1.23
##  2     1 Alligator    S           1.23
##  3     2 Annie        S           1.33
##  4     3 Apopka       N           0.04
##  5     3 Apopka       N           0.04
##  6     4 Blue Cypress S           0.44
##  7     8 Crescent     N           0.19
##  8     9 Deer Point   N           0.83
##  9    10 Dias         N           0.81
## 10    10 Dias         N           0.81
## # ℹ 43 more rows</code></pre>
<p><strong>Bootstrap Sample 2</strong></p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="bootstrap-interval-estimation.html#cb343-1" aria-hidden="true" tabindex="-1"></a>Mb2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample2, Mercury <span class="sc">~</span> Location) <span class="do">## fit linear model</span></span>
<span id="cb343-2"><a href="bootstrap-interval-estimation.html#cb343-2" aria-hidden="true" tabindex="-1"></a>Mb2</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Mercury ~ Location, data = BootstrapSample2)
## 
## Coefficients:
## (Intercept)    LocationS  
##      0.4876       0.3934</code></pre>
<p><strong>Bootstrap Sample 3</strong></p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="bootstrap-interval-estimation.html#cb345-1" aria-hidden="true" tabindex="-1"></a>NLakes <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Location<span class="sc">==</span><span class="st">&quot;N&quot;</span>), <span class="dv">33</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)   <span class="do">## sample 33 northern lakes</span></span>
<span id="cb345-2"><a href="bootstrap-interval-estimation.html#cb345-2" aria-hidden="true" tabindex="-1"></a>SLakes <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Location<span class="sc">==</span><span class="st">&quot;S&quot;</span>), <span class="dv">20</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)   <span class="do">## sample 20 southern lakes</span></span>
<span id="cb345-3"><a href="bootstrap-interval-estimation.html#cb345-3" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(NLakes, SLakes) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb345-4"><a href="bootstrap-interval-estimation.html#cb345-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Lake, Location, Mercury)   <span class="do">## combine Northern and Southern Lakes</span></span>
<span id="cb345-5"><a href="bootstrap-interval-estimation.html#cb345-5" aria-hidden="true" tabindex="-1"></a>BootstrapSample3</span></code></pre></div>
<pre><code>## # A tibble: 53 × 4
##       ID Lake       Location Mercury
##    &lt;int&gt; &lt;chr&gt;      &lt;fct&gt;      &lt;dbl&gt;
##  1     2 Annie      S           1.33
##  2     2 Annie      S           1.33
##  3     2 Annie      S           1.33
##  4     3 Apopka     N           0.04
##  5     5 Brick      S           1.2 
##  6     6 Bryant     N           0.27
##  7     7 Cherry     N           0.48
##  8     9 Deer Point N           0.83
##  9    10 Dias       N           0.81
## 10    12 Down       S           0.5 
## # ℹ 43 more rows</code></pre>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="bootstrap-interval-estimation.html#cb347-1" aria-hidden="true" tabindex="-1"></a>Mb3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample3, Mercury <span class="sc">~</span> Location) <span class="do">## fit linear model</span></span>
<span id="cb347-2"><a href="bootstrap-interval-estimation.html#cb347-2" aria-hidden="true" tabindex="-1"></a>Mb3</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Mercury ~ Location, data = BootstrapSample3)
## 
## Coefficients:
## (Intercept)    LocationS  
##      0.4436       0.2259</code></pre>
<p>We’ll now take 10,000 different bootstrap samples and look at the bootstrap distribution for <span class="math inline">\(b_1\)</span>, the difference in mean mercury levels between lakes in Southern and Northern Florida</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="bootstrap-interval-estimation.html#cb349-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>Location) <span class="co">#fit model to original sample</span></span>
<span id="cb349-2"><a href="bootstrap-interval-estimation.html#cb349-2" aria-hidden="true" tabindex="-1"></a>Sample_b1 <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="co"># record b1 value (second coefficient)</span></span>
<span id="cb349-3"><a href="bootstrap-interval-estimation.html#cb349-3" aria-hidden="true" tabindex="-1"></a>Bootstrap_b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">10000</span>)  <span class="co">#vector to store b1 values</span></span>
<span id="cb349-4"><a href="bootstrap-interval-estimation.html#cb349-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-5"><a href="bootstrap-interval-estimation.html#cb349-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>){</span>
<span id="cb349-6"><a href="bootstrap-interval-estimation.html#cb349-6" aria-hidden="true" tabindex="-1"></a>NLakes <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Location<span class="sc">==</span><span class="st">&quot;N&quot;</span>), <span class="dv">33</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)   <span class="do">## sample 33 northern lakes</span></span>
<span id="cb349-7"><a href="bootstrap-interval-estimation.html#cb349-7" aria-hidden="true" tabindex="-1"></a>SLakes <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Location<span class="sc">==</span><span class="st">&quot;S&quot;</span>), <span class="dv">20</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)   <span class="do">## sample 20 southern lakes</span></span>
<span id="cb349-8"><a href="bootstrap-interval-estimation.html#cb349-8" aria-hidden="true" tabindex="-1"></a>BootstrapSample <span class="ot">&lt;-</span> <span class="fu">rbind</span>(NLakes, SLakes)   <span class="do">## combine Northern and Southern Lakes</span></span>
<span id="cb349-9"><a href="bootstrap-interval-estimation.html#cb349-9" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample, Mercury <span class="sc">~</span> Location) <span class="do">## fit linear model</span></span>
<span id="cb349-10"><a href="bootstrap-interval-estimation.html#cb349-10" aria-hidden="true" tabindex="-1"></a>Bootstrap_b1[i] <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="do">## record b1 </span></span>
<span id="cb349-11"><a href="bootstrap-interval-estimation.html#cb349-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb349-12"><a href="bootstrap-interval-estimation.html#cb349-12" aria-hidden="true" tabindex="-1"></a>NS_Lakes_Bootstrap_Results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Bootstrap_b1)  <span class="co">#save results as dataframe</span></span></code></pre></div>
<p>The bootstrap distribution for the difference in means, <span class="math inline">\(b_1\)</span>, is shown below, along with the standard error for the difference.</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="bootstrap-interval-estimation.html#cb350-1" aria-hidden="true" tabindex="-1"></a>NS_Lakes_Bootstrap_Plot_b1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>NS_Lakes_Bootstrap_Results, <span class="fu">aes</span>(<span class="at">x=</span>Bootstrap_b1)) <span class="sc">+</span>  </span>
<span id="cb350-2"><a href="bootstrap-interval-estimation.html#cb350-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb350-3"><a href="bootstrap-interval-estimation.html#cb350-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mean Difference (b1) in Bootstrap Sample&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb350-4"><a href="bootstrap-interval-estimation.html#cb350-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Northern vs Southern Lakes: Bootstrap Distribution for b1&quot;</span>) </span>
<span id="cb350-5"><a href="bootstrap-interval-estimation.html#cb350-5" aria-hidden="true" tabindex="-1"></a>NS_Lakes_Bootstrap_Plot_b1</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-263-1.png" width="672" /></p>
<p>Standard Error of the Difference in Means <span class="math inline">\(b_1\)</span></p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="bootstrap-interval-estimation.html#cb351-1" aria-hidden="true" tabindex="-1"></a>SE_b1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(NS_Lakes_Bootstrap_Results<span class="sc">$</span>Bootstrap_b1)</span>
<span id="cb351-2"><a href="bootstrap-interval-estimation.html#cb351-2" aria-hidden="true" tabindex="-1"></a>SE_b1</span></code></pre></div>
<pre><code>## [1] 0.09620419</code></pre>
<p>The bootstrap distribution is symmetric and bell-shaped, so we can use the standard error method to calculate a 95% confidence interval.</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_1 \pm 2\times\text{SE}(b_1) \\
&amp; = 0.271 \pm 2\times{0.095}
\end{aligned}
\]</span>
95% Confidence Interval:</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="bootstrap-interval-estimation.html#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(Sample_b1 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_b1, Sample_b1 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_b1) </span></code></pre></div>
<pre><code>##  LocationS  LocationS 
## 0.07954616 0.46436293</code></pre>
<p>The 95% confidence interval is shown by the gold bar on the graph of the bootstrap distribution below.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="bootstrap-interval-estimation.html#cb355-1" aria-hidden="true" tabindex="-1"></a>NS_Lakes_Bootstrap_Plot_b1 <span class="sc">+</span> </span>
<span id="cb355-2"><a href="bootstrap-interval-estimation.html#cb355-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sample_b1 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_b1,<span class="at">xend=</span>Sample_b1 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_b1, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb355-3"><a href="bootstrap-interval-estimation.html#cb355-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;gold&quot;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-266-1.png" width="672" /></p>
<p>We are 95% confident that the mean mercury level among all lakes in Southern Florida is between 0.0795462 and 0.4643629 higher than the mean mercury level among all lakes in Northern Florida.</p>
<p><strong>Question:</strong> We previously performed a hypothesis test and concluded that there was evidence that mean mercury level was higher for lakes in South Florida than Northern Florida. Is this confidence interval consistent with the result of the hypothesis test? Why or why not?</p>
</div>
<div id="ci-for-regression-slope" class="section level3 hasAnchor" number="4.3.6">
<h3><span class="header-section-number">4.3.6</span> CI for Regression Slope<a href="bootstrap-interval-estimation.html#ci-for-regression-slope" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recall that we examined the relationship between mercury levels and pH in Florida lakes.</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="bootstrap-interval-estimation.html#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>FloridaLakes, <span class="fu">aes</span>(<span class="at">y=</span>Mercury, <span class="at">x=</span>pH)) <span class="sc">+</span> </span>
<span id="cb356-2"><a href="bootstrap-interval-estimation.html#cb356-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-267-1.png" width="672" /></p>
<p>The regression equation is</p>
<p><span class="math display">\[
\widehat{\text{Mercury}} = b_0 + b_1\times\text{pH}
\]</span></p>
<p>Regression estimates <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> are shown below.</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="bootstrap-interval-estimation.html#cb357-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>pH)</span>
<span id="cb357-2"><a href="bootstrap-interval-estimation.html#cb357-2" aria-hidden="true" tabindex="-1"></a>M</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Mercury ~ pH, data = FloridaLakes)
## 
## Coefficients:
## (Intercept)           pH  
##      1.5309      -0.1523</code></pre>
<ul>
<li>On average, lakes with pH level 0 are expected to have a mercury level of 1.53 ppm.<br />
</li>
<li>For each one-unit increase in pH, mercury level is expected to decrease by 0.15 ppm.</li>
</ul>
<p>These estimates are sample statistics, calculated from our sample of 53 lakes. We can think of our regression equation estimates <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> as estimates of parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, which pertain to the slope and intercept of the regression line pertaining to the entire population of all lakes in Florida. We’ll use <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> to estimate <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> in the same way that we used sample proportion <span class="math inline">\(\hat{p}\)</span> to estimate population proportion <span class="math inline">\(p\)</span> and sample mean <span class="math inline">\(\bar{x}\)</span> to estimate population mean <span class="math inline">\(\mu\)</span>.</p>
<p>The intercept, <span class="math inline">\(\beta_0\)</span> has little meaning here, but the slope <span class="math inline">\(\beta_1\)</span> represents the average change in mercury level for each one-unit increase in pH, among all Florida lakes. We’ll use bootstrapping to find a confidence interval for this quantity.</p>
<p><strong>Bootstrap Steps</strong></p>
<ol style="list-style-type: decimal">
<li><p>Take a sample of 53 lakes by randomly sampling from the original sample, with replacement.</p></li>
<li><p>Fit a regression model with pH as the explanatory variable and record the value of slope <span class="math inline">\(b_1\)</span>.</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, keeping track of slope of the regression line for each bootstrap sample.</p></li>
<li><p>Look at the distribution of the slopes across bootstrap samples. The variability in this bootstrap distribution can be used to approximate the variability in the sampling distribution for the slope relating mercury and pH levels.</p></li>
</ol>
<p>We’ll illustrate the procedure on 3 bootstrap samples.</p>
<p><strong>Bootstrap Sample 1</strong></p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="bootstrap-interval-estimation.html#cb359-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes , <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)  <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb359-2"><a href="bootstrap-interval-estimation.html#cb359-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Lake, pH, Mercury)   <span class="co"># take bootstrap sample</span></span>
<span id="cb359-3"><a href="bootstrap-interval-estimation.html#cb359-3" aria-hidden="true" tabindex="-1"></a>BootstrapSample1</span></code></pre></div>
<pre><code>## # A tibble: 53 × 4
##       ID Lake            pH Mercury
##    &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;
##  1     1 Alligator      6.1    1.23
##  2     1 Alligator      6.1    1.23
##  3     1 Alligator      6.1    1.23
##  4     2 Annie          5.1    1.33
##  5     2 Annie          5.1    1.33
##  6     2 Annie          5.1    1.33
##  7     3 Apopka         9.1    0.04
##  8     3 Apopka         9.1    0.04
##  9     3 Apopka         9.1    0.04
## 10     4 Blue Cypress   6.9    0.44
## # ℹ 43 more rows</code></pre>
<p>We fit a regression model to the bootstrap sample and calculate the regression coefficients. We’re again interested in the second coefficient, <span class="math inline">\(b_1\)</span>, which now represents the slope of the regression line.</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="bootstrap-interval-estimation.html#cb361-1" aria-hidden="true" tabindex="-1"></a>Mb1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample1, Mercury <span class="sc">~</span> pH) <span class="co"># fit linear model</span></span>
<span id="cb361-2"><a href="bootstrap-interval-estimation.html#cb361-2" aria-hidden="true" tabindex="-1"></a>Mb1</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Mercury ~ pH, data = BootstrapSample1)
## 
## Coefficients:
## (Intercept)           pH  
##      1.7903      -0.1918</code></pre>
<p><strong>Bootstrap Sample 2</strong></p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="bootstrap-interval-estimation.html#cb363-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes , <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)  <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb363-2"><a href="bootstrap-interval-estimation.html#cb363-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Lake, pH, Mercury)</span>
<span id="cb363-3"><a href="bootstrap-interval-estimation.html#cb363-3" aria-hidden="true" tabindex="-1"></a>BootstrapSample2</span></code></pre></div>
<pre><code>## # A tibble: 53 × 4
##       ID Lake            pH Mercury
##    &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;
##  1     1 Alligator      6.1    1.23
##  2     4 Blue Cypress   6.9    0.44
##  3     4 Blue Cypress   6.9    0.44
##  4     4 Blue Cypress   6.9    0.44
##  5     5 Brick          4.6    1.2 
##  6     5 Brick          4.6    1.2 
##  7     6 Bryant         7.3    0.27
##  8     7 Cherry         5.4    0.48
##  9     8 Crescent       8.1    0.19
## 10     8 Crescent       8.1    0.19
## # ℹ 43 more rows</code></pre>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="bootstrap-interval-estimation.html#cb365-1" aria-hidden="true" tabindex="-1"></a>Mb2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample2, Mercury <span class="sc">~</span> pH) <span class="co"># fit linear model</span></span>
<span id="cb365-2"><a href="bootstrap-interval-estimation.html#cb365-2" aria-hidden="true" tabindex="-1"></a>Mb2</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Mercury ~ pH, data = BootstrapSample2)
## 
## Coefficients:
## (Intercept)           pH  
##      1.5724      -0.1661</code></pre>
<p><strong>Bootstrap Sample 3</strong></p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="bootstrap-interval-estimation.html#cb367-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes , <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)  <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb367-2"><a href="bootstrap-interval-estimation.html#cb367-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Lake, pH, Mercury)</span>
<span id="cb367-3"><a href="bootstrap-interval-estimation.html#cb367-3" aria-hidden="true" tabindex="-1"></a>BootstrapSample3</span></code></pre></div>
<pre><code>## # A tibble: 53 × 4
##       ID Lake          pH Mercury
##    &lt;int&gt; &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;
##  1     5 Brick        4.6    1.2 
##  2     6 Bryant       7.3    0.27
##  3     6 Bryant       7.3    0.27
##  4     7 Cherry       5.4    0.48
##  5     8 Crescent     8.1    0.19
##  6     9 Deer Point   5.8    0.83
##  7     9 Deer Point   5.8    0.83
##  8    10 Dias         6.4    0.81
##  9    12 Down         7.2    0.5 
## 10    12 Down         7.2    0.5 
## # ℹ 43 more rows</code></pre>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="bootstrap-interval-estimation.html#cb369-1" aria-hidden="true" tabindex="-1"></a>Mb3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample3, Mercury <span class="sc">~</span> pH) <span class="co"># fit linear model</span></span>
<span id="cb369-2"><a href="bootstrap-interval-estimation.html#cb369-2" aria-hidden="true" tabindex="-1"></a>Mb3</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Mercury ~ pH, data = BootstrapSample3)
## 
## Coefficients:
## (Intercept)           pH  
##      1.6215      -0.1612</code></pre>
<p>We’ll now take 10,000 different bootstrap samples and look at the bootstrap distribution for <span class="math inline">\(b_1\)</span>, the slope of the regression line relating mercury level and pH.</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="bootstrap-interval-estimation.html#cb371-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>pH) <span class="co">#fit model to original sample</span></span>
<span id="cb371-2"><a href="bootstrap-interval-estimation.html#cb371-2" aria-hidden="true" tabindex="-1"></a>Sample_b1 <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="co"># record b1 value (second coefficient)</span></span>
<span id="cb371-3"><a href="bootstrap-interval-estimation.html#cb371-3" aria-hidden="true" tabindex="-1"></a>Bootstrap_b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">10000</span>)  <span class="co">#vector to store b1 values</span></span>
<span id="cb371-4"><a href="bootstrap-interval-estimation.html#cb371-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-5"><a href="bootstrap-interval-estimation.html#cb371-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>){</span>
<span id="cb371-6"><a href="bootstrap-interval-estimation.html#cb371-6" aria-hidden="true" tabindex="-1"></a>BootstrapSample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes , <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)   <span class="co">#take bootstrap sample</span></span>
<span id="cb371-7"><a href="bootstrap-interval-estimation.html#cb371-7" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample, Mercury <span class="sc">~</span> pH) <span class="co"># fit linear model</span></span>
<span id="cb371-8"><a href="bootstrap-interval-estimation.html#cb371-8" aria-hidden="true" tabindex="-1"></a>Bootstrap_b1[i] <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="co"># record b1 </span></span>
<span id="cb371-9"><a href="bootstrap-interval-estimation.html#cb371-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb371-10"><a href="bootstrap-interval-estimation.html#cb371-10" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Slope_Results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Bootstrap_b1)  <span class="co">#save results as dataframe</span></span></code></pre></div>
<p>The bootstrap distribution for the slopes, <span class="math inline">\(b_1\)</span>, is shown below, along with the standard error for the difference.</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="bootstrap-interval-estimation.html#cb372-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Plot_Slope <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_Bootstrap_Slope_Results, <span class="fu">aes</span>(<span class="at">x=</span>Bootstrap_b1)) <span class="sc">+</span></span>
<span id="cb372-2"><a href="bootstrap-interval-estimation.html#cb372-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb372-3"><a href="bootstrap-interval-estimation.html#cb372-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Slope in Bootstrap Sample&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb372-4"><a href="bootstrap-interval-estimation.html#cb372-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Bootstrap Distribution for Slope&quot;</span>) </span>
<span id="cb372-5"><a href="bootstrap-interval-estimation.html#cb372-5" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Plot_Slope</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-276-1.png" width="672" /></p>
<p>Standard Error of the slope <span class="math inline">\(b_1\)</span></p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="bootstrap-interval-estimation.html#cb373-1" aria-hidden="true" tabindex="-1"></a>SE_b1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(Lakes_Bootstrap_Slope_Results<span class="sc">$</span>Bootstrap_b1)</span>
<span id="cb373-2"><a href="bootstrap-interval-estimation.html#cb373-2" aria-hidden="true" tabindex="-1"></a>SE_b1</span></code></pre></div>
<pre><code>## [1] 0.02676588</code></pre>
<p>The bootstrap distribution is symmetric and bell-shaped, so we can use the standard error method to calculate a 95% confidence interval.</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_1 \pm 2\times\text{SE}(b_1) \\
&amp; = -0.1523 \pm 2\times{0.027}
\end{aligned}
\]</span></p>
<p>95% Confidence Interval:</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="bootstrap-interval-estimation.html#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(Sample_b1 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_b1, Sample_b1 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_b1) </span></code></pre></div>
<pre><code>##         pH         pH 
## -0.2058326 -0.0987691</code></pre>
<p>The 95% confidence interval is shown by the gold bar on the graph of the bootstrap distribution below.</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="bootstrap-interval-estimation.html#cb377-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Plot_Slope <span class="sc">+</span> </span>
<span id="cb377-2"><a href="bootstrap-interval-estimation.html#cb377-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sample_b1 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_b1,<span class="at">xend=</span>Sample_b1 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_b1, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb377-3"><a href="bootstrap-interval-estimation.html#cb377-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;gold&quot;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-279-1.png" width="672" /></p>
<p>We are 95% confident that among all Florida lakes, for each 1 unit increase in pH, mercury level decreases between 0.2058326 and 0.0987691, on average.</p>
</div>
<div id="ci-for-regression-response" class="section level3 hasAnchor" number="4.3.7">
<h3><span class="header-section-number">4.3.7</span> CI for Regression Response<a href="bootstrap-interval-estimation.html#ci-for-regression-response" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In addition to calculating a confidence interval for the slope of the regression line relating mercury and pH levels in a lake, we can also calculate a confidence interval for the average mercury level among all lakes with a given pH.</p>
<p>We’ll calculate a confidence interval for the average mercury level among all lakes with a neutral pH level of 7.</p>
<p>The regression equation is</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{\text{Mercury}} &amp; = b_0 + b_1\times\text{pH} \\
&amp; = 1.5309 - 0.1523\times\text{pH}
\end{aligned}
\]</span></p>
<p>so the expected mercury level among all lakes with <span class="math inline">\(\text{pH} = 7\)</span> is <span class="math inline">\(b_0+7b_1 = 1.5309-0.1523(7)=0.4648\)</span> ppm.</p>
<p>This quantity is a statistic calculated from a sample of 53 lakes, so we would not expect the average mercury level among all lakes in the population to be exactly equal to 0.4648. Again, we’ll use this sample statistic as an estimate of the population parameter, and use bootstrapping to estimate the variability associated with this statistic, in order to make a confidence interval.</p>
<p><strong>Bootstrap Steps</strong></p>
<ol style="list-style-type: decimal">
<li><p>Take a sample of 53 lakes by randomly sampling from the original sample, with replacement.</p></li>
<li><p>Fit a regression model with location as the explanatory variable and record the values of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>. Use these to calculate <span class="math inline">\(b_0+7b_1\)</span>.</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, keeping track of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>, and calculating <span class="math inline">\(b_0+7b_1\)</span> in each bootstrap sample.</p></li>
<li><p>Look at the distribution of the expected response, <span class="math inline">\(b_0 + 7b_1\)</span>, across bootstrap samples. The variability in this bootstrap distribution can be used to approximate the variability in the sampling distribution for the expected mercury level among all lakes with pH level of 7.</p></li>
</ol>
<p>We’ll illustrate the procedure on 3 bootstrap samples.</p>
<p><strong>Bootstrap Sample 1</strong></p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="bootstrap-interval-estimation.html#cb378-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes , <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)  <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb378-2"><a href="bootstrap-interval-estimation.html#cb378-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Lake, pH, Mercury)   <span class="co"># take bootstrap sample</span></span>
<span id="cb378-3"><a href="bootstrap-interval-estimation.html#cb378-3" aria-hidden="true" tabindex="-1"></a>BootstrapSample1</span></code></pre></div>
<pre><code>## # A tibble: 53 × 4
##       ID Lake          pH Mercury
##    &lt;int&gt; &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;
##  1     2 Annie        5.1    1.33
##  2     3 Apopka       9.1    0.04
##  3     5 Brick        4.6    1.2 
##  4     9 Deer Point   5.8    0.83
##  5    10 Dias         6.4    0.81
##  6    10 Dias         6.4    0.81
##  7    11 Dorr         5.4    0.71
##  8    11 Dorr         5.4    0.71
##  9    12 Down         7.2    0.5 
## 10    13 Eaton        7.2    0.49
## # ℹ 43 more rows</code></pre>
<p>We fit a regression model to the bootstrap sample and calculate the regression coefficients. We’re interested in the second coefficient, <span class="math inline">\(b_1\)</span>, which represents the mean difference between lakes in Southern and Northern Florida</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="bootstrap-interval-estimation.html#cb380-1" aria-hidden="true" tabindex="-1"></a>Mb1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample1, Mercury <span class="sc">~</span> pH) <span class="do">## fit linear model</span></span>
<span id="cb380-2"><a href="bootstrap-interval-estimation.html#cb380-2" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> Mb1<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="co"># record value of b0 (first coefficient)</span></span>
<span id="cb380-3"><a href="bootstrap-interval-estimation.html#cb380-3" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> Mb1<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="co"># record value of b1 (second coefficient)</span></span>
<span id="cb380-4"><a href="bootstrap-interval-estimation.html#cb380-4" aria-hidden="true" tabindex="-1"></a>b0<span class="sc">+</span><span class="dv">7</span><span class="sc">*</span>b1 <span class="co">#calculate b0+7*b1</span></span></code></pre></div>
<pre><code>## (Intercept) 
##   0.4726683</code></pre>
<p><strong>Bootstrap Sample 2</strong></p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="bootstrap-interval-estimation.html#cb382-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes , <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)  <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb382-2"><a href="bootstrap-interval-estimation.html#cb382-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Lake, pH, Mercury)</span>
<span id="cb382-3"><a href="bootstrap-interval-estimation.html#cb382-3" aria-hidden="true" tabindex="-1"></a>BootstrapSample2</span></code></pre></div>
<pre><code>## # A tibble: 53 × 4
##       ID Lake            pH Mercury
##    &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;
##  1     4 Blue Cypress   6.9    0.44
##  2     6 Bryant         7.3    0.27
##  3     6 Bryant         7.3    0.27
##  4     6 Bryant         7.3    0.27
##  5     7 Cherry         5.4    0.48
##  6     8 Crescent       8.1    0.19
##  7     8 Crescent       8.1    0.19
##  8    10 Dias           6.4    0.81
##  9    10 Dias           6.4    0.81
## 10    11 Dorr           5.4    0.71
## # ℹ 43 more rows</code></pre>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="bootstrap-interval-estimation.html#cb384-1" aria-hidden="true" tabindex="-1"></a>Mb2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample2, Mercury <span class="sc">~</span> pH) <span class="co"># fit linear model</span></span>
<span id="cb384-2"><a href="bootstrap-interval-estimation.html#cb384-2" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> Mb2<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="co"># record value of b0 (first coefficient)</span></span>
<span id="cb384-3"><a href="bootstrap-interval-estimation.html#cb384-3" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> Mb2<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="co"># record value of b1 (second coefficient)</span></span>
<span id="cb384-4"><a href="bootstrap-interval-estimation.html#cb384-4" aria-hidden="true" tabindex="-1"></a>b0<span class="sc">+</span><span class="dv">7</span><span class="sc">*</span>b1 <span class="co">#calculate b0+7*b1</span></span></code></pre></div>
<pre><code>## (Intercept) 
##   0.4574841</code></pre>
<p><strong>Bootstrap Sample 3</strong></p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="bootstrap-interval-estimation.html#cb386-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes , <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)  <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb386-2"><a href="bootstrap-interval-estimation.html#cb386-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Lake, pH, Mercury)</span>
<span id="cb386-3"><a href="bootstrap-interval-estimation.html#cb386-3" aria-hidden="true" tabindex="-1"></a>BootstrapSample3</span></code></pre></div>
<pre><code>## # A tibble: 53 × 4
##       ID Lake            pH Mercury
##    &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;
##  1     1 Alligator      6.1    1.23
##  2     2 Annie          5.1    1.33
##  3     3 Apopka         9.1    0.04
##  4     3 Apopka         9.1    0.04
##  5     4 Blue Cypress   6.9    0.44
##  6     4 Blue Cypress   6.9    0.44
##  7     4 Blue Cypress   6.9    0.44
##  8     5 Brick          4.6    1.2 
##  9     6 Bryant         7.3    0.27
## 10     6 Bryant         7.3    0.27
## # ℹ 43 more rows</code></pre>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="bootstrap-interval-estimation.html#cb388-1" aria-hidden="true" tabindex="-1"></a>Mb3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample3, Mercury <span class="sc">~</span> pH) <span class="co"># fit linear model</span></span>
<span id="cb388-2"><a href="bootstrap-interval-estimation.html#cb388-2" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> Mb3<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="co"># record value of b0 (first coefficient)</span></span>
<span id="cb388-3"><a href="bootstrap-interval-estimation.html#cb388-3" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> Mb3<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="co"># record value of b1 (second coefficient)</span></span>
<span id="cb388-4"><a href="bootstrap-interval-estimation.html#cb388-4" aria-hidden="true" tabindex="-1"></a>b0<span class="sc">+</span><span class="dv">7</span><span class="sc">*</span>b1 <span class="co">#calculate b0+7*b1</span></span></code></pre></div>
<pre><code>## (Intercept) 
##   0.4077507</code></pre>
<p>We’ll now take 10,000 different bootstrap samples and record the values of <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span>, which we’ll then use to calculate <span class="math inline">\(b_0+7b_1\)</span>.</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="bootstrap-interval-estimation.html#cb390-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>pH) <span class="co">#fit model to original sample</span></span>
<span id="cb390-2"><a href="bootstrap-interval-estimation.html#cb390-2" aria-hidden="true" tabindex="-1"></a>Sample_b0 <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="co"># record b0 value (second coefficient)</span></span>
<span id="cb390-3"><a href="bootstrap-interval-estimation.html#cb390-3" aria-hidden="true" tabindex="-1"></a>Sample_b1 <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="co"># record b1 value (second coefficient)</span></span>
<span id="cb390-4"><a href="bootstrap-interval-estimation.html#cb390-4" aria-hidden="true" tabindex="-1"></a>Sample_Exp7 <span class="ot">&lt;-</span> Sample_b0 <span class="sc">+</span> <span class="dv">7</span><span class="sc">*</span>Sample_b1 <span class="co"># calculate sample expected mercury when pH=7</span></span>
<span id="cb390-5"><a href="bootstrap-interval-estimation.html#cb390-5" aria-hidden="true" tabindex="-1"></a>Bootstrap_b0 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">10000</span>)  <span class="co">#vector to store b1 values</span></span>
<span id="cb390-6"><a href="bootstrap-interval-estimation.html#cb390-6" aria-hidden="true" tabindex="-1"></a>Bootstrap_b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">10000</span>)  <span class="co">#vector to store b1 values</span></span>
<span id="cb390-7"><a href="bootstrap-interval-estimation.html#cb390-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-8"><a href="bootstrap-interval-estimation.html#cb390-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>){</span>
<span id="cb390-9"><a href="bootstrap-interval-estimation.html#cb390-9" aria-hidden="true" tabindex="-1"></a>BootstrapSample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes , <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)   <span class="co">#take bootstrap sample</span></span>
<span id="cb390-10"><a href="bootstrap-interval-estimation.html#cb390-10" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample, Mercury <span class="sc">~</span> pH) <span class="co"># fit linear model</span></span>
<span id="cb390-11"><a href="bootstrap-interval-estimation.html#cb390-11" aria-hidden="true" tabindex="-1"></a>Bootstrap_b0[i] <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="co"># record b0 </span></span>
<span id="cb390-12"><a href="bootstrap-interval-estimation.html#cb390-12" aria-hidden="true" tabindex="-1"></a>Bootstrap_b1[i] <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="co"># record b1 </span></span>
<span id="cb390-13"><a href="bootstrap-interval-estimation.html#cb390-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb390-14"><a href="bootstrap-interval-estimation.html#cb390-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-15"><a href="bootstrap-interval-estimation.html#cb390-15" aria-hidden="true" tabindex="-1"></a>Bootstrap_Exp7 <span class="ot">&lt;-</span>  Bootstrap_b0 <span class="sc">+</span> <span class="dv">7</span><span class="sc">*</span>Bootstrap_b1 <span class="co"># calcualte expected response for each bootstrap sample</span></span>
<span id="cb390-16"><a href="bootstrap-interval-estimation.html#cb390-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-17"><a href="bootstrap-interval-estimation.html#cb390-17" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Exp7_Results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Bootstrap_b0, Bootstrap_b1, Bootstrap_Exp7)  <span class="co">#save results as dataframe</span></span></code></pre></div>
<p>The bootstrap distribution for the expected mercury level among all lakes with pH level 7, <span class="math inline">\(b_0+7b_1\)</span>, is shown below, along with the standard error for this quantity.</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="bootstrap-interval-estimation.html#cb391-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Plot_Exp7 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_Bootstrap_Exp7_Results, <span class="fu">aes</span>(<span class="at">x=</span>Bootstrap_Exp7)) <span class="sc">+</span>  </span>
<span id="cb391-2"><a href="bootstrap-interval-estimation.html#cb391-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb391-3"><a href="bootstrap-interval-estimation.html#cb391-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Expected Mercury Level in Bootstrap Sample&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb391-4"><a href="bootstrap-interval-estimation.html#cb391-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>( <span class="st">&quot;Bootstrap Distribution for Exp. Mercury when pH=7&quot;</span>) </span>
<span id="cb391-5"><a href="bootstrap-interval-estimation.html#cb391-5" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Plot_Exp7</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-287-1.png" width="672" /></p>
<p>Standard Error of the expected response <span class="math inline">\(b_0 + 7b_1\)</span></p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="bootstrap-interval-estimation.html#cb392-1" aria-hidden="true" tabindex="-1"></a>SE_Exp7 <span class="ot">&lt;-</span> <span class="fu">sd</span>(Lakes_Bootstrap_Exp7_Results<span class="sc">$</span>Bootstrap_Exp7)</span>
<span id="cb392-2"><a href="bootstrap-interval-estimation.html#cb392-2" aria-hidden="true" tabindex="-1"></a>SE_Exp7</span></code></pre></div>
<pre><code>## [1] 0.03676639</code></pre>
<p>Again, the bootstrap distribution is symmetric and bell-shaped, so we can use the standard error method to calculate a 95% confidence interval.</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_1 \pm 2\times\text{SE}(b_1) \\
&amp; = 0.4648 \pm 2\times{0.037}
\end{aligned}
\]</span></p>
<p>95% Confidence Interval:</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="bootstrap-interval-estimation.html#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(Sample_Exp7 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_Exp7, Sample_Exp7 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_Exp7) </span></code></pre></div>
<pre><code>## (Intercept) (Intercept) 
##   0.3912799   0.5383454</code></pre>
<p>The 95% confidence interval is shown by the gold bar on the graph of the bootstrap distribution below.</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="bootstrap-interval-estimation.html#cb396-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Plot_Exp7 <span class="sc">+</span> </span>
<span id="cb396-2"><a href="bootstrap-interval-estimation.html#cb396-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sample_Exp7 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_Exp7,<span class="at">xend=</span>Sample_Exp7 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_Exp7, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb396-3"><a href="bootstrap-interval-estimation.html#cb396-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;gold&quot;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-290-1.png" width="672" /></p>
<p>We are 95% confident that average mercury level among all Florida lakes with pH level 7 is between 0.3912799 and 0.5383454 ppm.</p>
<p>Again, we are not saying that we think an individual like with a pH level of 7 will lie in this range, only that the average mercury level among all such lakes lies in this range.</p>
</div>
<div id="more-cis-in-regression" class="section level3 hasAnchor" number="4.3.8">
<h3><span class="header-section-number">4.3.8</span> More CI’s in Regression<a href="bootstrap-interval-estimation.html#more-cis-in-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We saw in the previous two examples how to calculate a confidence interval for the slope of a regression line, and for an expected response in regression. In fact, we can calculate confidence intervals for any function involving regression coefficients <span class="math inline">\(\beta_0, \beta_1, \ldots, \beta_p\)</span>, in a similar manner.</p>
<p>For example, let’s consider the model for Seattle house prices that involved square feet, whether or not the house was on the waterfront, and an interaction term between these variables.</p>
<p>The model is</p>
<p><span class="math display">\[
\widehat{Price} = b_0 + b_1\times\text{Sq. Ft.} + b_2\times\text{waterfront} + b_3\times\text{Sq.Ft}\times\text{Waterfront}
\]</span></p>
<p>We fit the model and obtain the parameter estimates shown below.</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="bootstrap-interval-estimation.html#cb397-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Houses, price<span class="sc">~</span>sqft_living <span class="sc">+</span> waterfront <span class="sc">+</span></span>
<span id="cb397-2"><a href="bootstrap-interval-estimation.html#cb397-2" aria-hidden="true" tabindex="-1"></a>          sqft_living<span class="sc">:</span>waterfront) <span class="co">#fit model to original sample</span></span>
<span id="cb397-3"><a href="bootstrap-interval-estimation.html#cb397-3" aria-hidden="true" tabindex="-1"></a>Sample_b0 <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="co"># record b0 value (second coefficient)</span></span>
<span id="cb397-4"><a href="bootstrap-interval-estimation.html#cb397-4" aria-hidden="true" tabindex="-1"></a>Sample_b1 <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="co"># record b1 value (second coefficient)</span></span>
<span id="cb397-5"><a href="bootstrap-interval-estimation.html#cb397-5" aria-hidden="true" tabindex="-1"></a>Sample_b2 <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">3</span>] <span class="co"># record b1 value (second coefficient)</span></span>
<span id="cb397-6"><a href="bootstrap-interval-estimation.html#cb397-6" aria-hidden="true" tabindex="-1"></a>Sample_b3 <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">4</span>] <span class="co"># record b1 value (second coefficient)</span></span>
<span id="cb397-7"><a href="bootstrap-interval-estimation.html#cb397-7" aria-hidden="true" tabindex="-1"></a>M</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price ~ sqft_living + waterfront + sqft_living:waterfront, 
##     data = Houses)
## 
## Coefficients:
##               (Intercept)                sqft_living  
##                   67.3959                     0.2184  
##             waterfrontYes  sqft_living:waterfrontYes  
##                 -364.5950                     0.4327</code></pre>
<p>Consider the following quantities that we might be interested in estimating:</p>
<ol style="list-style-type: decimal">
<li>The expected price of a 2,000 square foot waterfront house.<br />
</li>
<li>The expected price of a 1,500 square foot non-waterfront house.<br />
</li>
<li>The difference between the expected price of a house 1,800 square foot house on the waterfront, compared to a house the same size that is not on the waterfront.<br />
</li>
<li>The difference in the rate of change in house prices for each additional 100 square feet for houses on the waterfront, compared to houses not on the waterfront.</li>
</ol>
<p>Each of these quantities can be expressed as a linear function of our regression coefficients <span class="math inline">\(b_0, b_1, b_2, b_3\)</span>. We just need to find the appropriate function of the <span class="math inline">\(b_j\)</span>’s, and then calculate a bootstrap confidence interval for that quantity, using the same steps we’ve seen in the previous examples.</p>
<p>Substituting into the regression equation, we see that:</p>
<ol style="list-style-type: decimal">
<li>The expected price of a 2,000 square foot waterfront house is given by
<span class="math display">\[b_0 + 2000b_1 + b_2 + 2000b_3\]</span></li>
</ol>
<p>We calculate this estimate from the model, based on our sample of 100 houses:</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="bootstrap-interval-estimation.html#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="sc">*</span>Sample_b1 <span class="sc">+</span>Sample_b2<span class="sc">+</span><span class="dv">2000</span><span class="sc">*</span>Sample_b3 <span class="co"># calculate b0+2000b1+b2+2000b3</span></span></code></pre></div>
<pre><code>## sqft_living 
##    937.4777</code></pre>
<p>We estimate that the average price of all 2,000 square foot waterfront houses in Seattle is 937 thousand dollars.</p>
<ol start="2" style="list-style-type: decimal">
<li>The expected price of a 1,500 square foot non-waterfront house is given by
<span class="math display">\[b_0 + 1500b_1\]</span></li>
</ol>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="bootstrap-interval-estimation.html#cb401-1" aria-hidden="true" tabindex="-1"></a>Sample_b0 <span class="sc">+</span> <span class="dv">1500</span><span class="sc">*</span>Sample_b1 <span class="co"># calculate b0+1500b1+</span></span></code></pre></div>
<pre><code>## (Intercept) 
##    394.9499</code></pre>
<p>We estimate that the average price of all 1,500 square foot non-waterfront houses in Seattle is 395 thousand dollars.</p>
<ol start="3" style="list-style-type: decimal">
<li>The difference between the expected price of a house 1,800 square foot house on the waterfront, compared to a house the same size that is not on the waterfront is given by:</li>
</ol>
<p><span class="math display">\[
\begin{aligned}
&amp; (b_0 + 1800b_1 + b_2 + 1800b_3) - (b_0 + 1800b_1) \\
&amp; = b_2 +1800b_3
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="bootstrap-interval-estimation.html#cb403-1" aria-hidden="true" tabindex="-1"></a>Sample_b2<span class="sc">+</span><span class="dv">1800</span><span class="sc">*</span>Sample_b3 <span class="co"># calculate b2+1800b3</span></span></code></pre></div>
<pre><code>## waterfrontYes 
##      414.2058</code></pre>
<p>We estimate that on average a 1,800 square foot house on the waterfront will cost 414 thousand dollars more than a 1,800 square foot house not on the waterfront.</p>
<ol start="4" style="list-style-type: decimal">
<li>The difference in the rate of change in house prices for each additional 100 square feet for houses on the waterfront, compared to houses not on the waterfront.</li>
</ol>
<p>This question is asking about the difference in slopes of the regression lines relating price and square feet for houses on the waterfront, compared to those not on the waterfront.</p>
<p>For houses on the waterfront, the regression equation is</p>
<p><span class="math display">\[
\widehat{Price} = (b_0 + b_2) + (b_1 +b_3)\times\text{Sq. Ft.},
\]</span></p>
<p>so the slope is <span class="math inline">\(b_1 + b_3\)</span>.</p>
<p>For houses not on the waterfront, the regression equation is</p>
<p><span class="math display">\[
\widehat{Price} = b_0  + b_1 \times\text{Sq. Ft.},
\]</span></p>
<p>so the slope is <span class="math inline">\(b_1\)</span>.</p>
<p>These slope pertain to the expected change in price for each additional 1 square foot. So, for a 100-square foot increase, the price of a waterfront house is expected to increase by <span class="math inline">\(100(b_1+b_3)\)</span>, compared to an increase of <span class="math inline">\(100b_1\)</span> for a non-waterfront house. Thus, the difference in the rates of change is <span class="math inline">\(100b_3\)</span>.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="bootstrap-interval-estimation.html#cb405-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span>Sample_b3 <span class="co"># calculate 100b3</span></span></code></pre></div>
<pre><code>## sqft_living:waterfrontYes 
##                  43.26671</code></pre>
<p>We estimate that the price of waterfront houses increases by 43 thousand dollars more for each additional 100 square feet than the price of non-waterfront houses.</p>
<p>These estimates calculated from the sample are statistics, which, like all the other statistics we’ve seen are likely to vary from the true values of the corresponding population parameters, due to variability between samples. We can use bootstrapping to calculate confidence intervals for the relevant population parameters, using these sample statistics (the functions of <span class="math inline">\(b_j\)</span>’s), just as we’ve done for the other statistics we’ve seen.</p>
<p><strong>Bootstrap Steps</strong></p>
<ol style="list-style-type: decimal">
<li><p>Take a sample of 100 houses by randomly sampling from the original sample, with replacement.</p></li>
<li><p>Fit a regression model with location as the explanatory variable and record the values of regression coefficients <span class="math inline">\(b_0, b_1, b_2, b_3\)</span>. Use these to calculate each of the four desired quantities (i.e. <span class="math inline">\(b_0 + 2000b_1 + b_2 +2000b_3\)</span>)</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, keeping track of the regression coefficients and calculating the desired quantities in each bootstrap sample.</p></li>
<li><p>Look at the distribution of the quantities of interest, across bootstrap samples. The variability in this bootstrap distribution can be used to approximate the variability in the sampling distribution for each of these quantities.</p></li>
</ol>
<p>We’ll illustrate the procedure on 3 bootstrap samples.</p>
<p><strong>Bootstrap Sample 1</strong></p>
<p>We take the first bootstrap sample and fit a model with interaction. For brevity, we won’t list out the houses in each of the bootstrap samples, as the idea should be clear by now. Model coefficients are shown below.</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="bootstrap-interval-estimation.html#cb407-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(Houses , <span class="dv">100</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)  <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Id) <span class="sc">%&gt;%</span> </span>
<span id="cb407-2"><a href="bootstrap-interval-estimation.html#cb407-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Id, price, sqft_living, waterfront)   </span>
<span id="cb407-3"><a href="bootstrap-interval-estimation.html#cb407-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-4"><a href="bootstrap-interval-estimation.html#cb407-4" aria-hidden="true" tabindex="-1"></a>Mb1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample1, price <span class="sc">~</span> sqft_living <span class="sc">+</span> waterfront <span class="sc">+</span> sqft_living<span class="sc">:</span>waterfront) <span class="co"># fit linear model with interaction</span></span>
<span id="cb407-5"><a href="bootstrap-interval-estimation.html#cb407-5" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> Mb1<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="co"># record value of b0 (first coefficient)</span></span>
<span id="cb407-6"><a href="bootstrap-interval-estimation.html#cb407-6" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> Mb1<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="co"># record value of b1 (second coefficient)</span></span>
<span id="cb407-7"><a href="bootstrap-interval-estimation.html#cb407-7" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> Mb1<span class="sc">$</span>coefficients[<span class="dv">3</span>] <span class="co"># record value of b2 (third coefficient)</span></span>
<span id="cb407-8"><a href="bootstrap-interval-estimation.html#cb407-8" aria-hidden="true" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> Mb1<span class="sc">$</span>coefficients[<span class="dv">4</span>] <span class="co"># record value of b3 (fourth coefficient)</span></span>
<span id="cb407-9"><a href="bootstrap-interval-estimation.html#cb407-9" aria-hidden="true" tabindex="-1"></a>Mb1</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price ~ sqft_living + waterfront + sqft_living:waterfront, 
##     data = BootstrapSample1)
## 
## Coefficients:
##               (Intercept)                sqft_living  
##                   23.1250                     0.2416  
##             waterfrontYes  sqft_living:waterfrontYes  
##                 -552.9883                     0.5005</code></pre>
<p>We calculate each of the four desired quantities.</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="bootstrap-interval-estimation.html#cb409-1" aria-hidden="true" tabindex="-1"></a>b0<span class="sc">+</span><span class="dv">2000</span><span class="sc">*</span>b1 <span class="sc">+</span> b2 <span class="sc">+</span> <span class="dv">2000</span><span class="sc">*</span>b3</span></code></pre></div>
<pre><code>## (Intercept) 
##    954.3864</code></pre>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="bootstrap-interval-estimation.html#cb411-1" aria-hidden="true" tabindex="-1"></a>b0<span class="sc">+</span><span class="dv">1500</span><span class="sc">*</span>b1</span></code></pre></div>
<pre><code>## (Intercept) 
##    385.5317</code></pre>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="bootstrap-interval-estimation.html#cb413-1" aria-hidden="true" tabindex="-1"></a>b2<span class="sc">+</span><span class="dv">1800</span><span class="sc">*</span>b3</span></code></pre></div>
<pre><code>## waterfrontYes 
##      347.9484</code></pre>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="bootstrap-interval-estimation.html#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span>b3</span></code></pre></div>
<pre><code>## sqft_living:waterfrontYes 
##                  50.05204</code></pre>
<p><strong>Bootstrap Sample 2</strong></p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="bootstrap-interval-estimation.html#cb417-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(Houses , <span class="dv">100</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)  <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Id) <span class="sc">%&gt;%</span> </span>
<span id="cb417-2"><a href="bootstrap-interval-estimation.html#cb417-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Id, price, sqft_living, waterfront)   </span>
<span id="cb417-3"><a href="bootstrap-interval-estimation.html#cb417-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb417-4"><a href="bootstrap-interval-estimation.html#cb417-4" aria-hidden="true" tabindex="-1"></a>Mb2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample2, price <span class="sc">~</span> sqft_living <span class="sc">+</span> waterfront <span class="sc">+</span> sqft_living<span class="sc">:</span>waterfront) <span class="co"># fit linear model with interaction</span></span>
<span id="cb417-5"><a href="bootstrap-interval-estimation.html#cb417-5" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> Mb2<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="co"># record value of b0 (first coefficient)</span></span>
<span id="cb417-6"><a href="bootstrap-interval-estimation.html#cb417-6" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> Mb2<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="co"># record value of b1 (second coefficient)</span></span>
<span id="cb417-7"><a href="bootstrap-interval-estimation.html#cb417-7" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> Mb2<span class="sc">$</span>coefficients[<span class="dv">3</span>] <span class="co"># record value of b2 (third coefficient)</span></span>
<span id="cb417-8"><a href="bootstrap-interval-estimation.html#cb417-8" aria-hidden="true" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> Mb2<span class="sc">$</span>coefficients[<span class="dv">4</span>] <span class="co"># record value of b3 (fourth coefficient)</span></span>
<span id="cb417-9"><a href="bootstrap-interval-estimation.html#cb417-9" aria-hidden="true" tabindex="-1"></a>Mb2</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price ~ sqft_living + waterfront + sqft_living:waterfront, 
##     data = BootstrapSample2)
## 
## Coefficients:
##               (Intercept)                sqft_living  
##                   97.8551                     0.2133  
##             waterfrontYes  sqft_living:waterfrontYes  
##                 -622.7018                     0.5163</code></pre>
<p>We calculate each of the four desired quantities.</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="bootstrap-interval-estimation.html#cb419-1" aria-hidden="true" tabindex="-1"></a>b0<span class="sc">+</span><span class="dv">2000</span><span class="sc">*</span>b1 <span class="sc">+</span> b2 <span class="sc">+</span> <span class="dv">2000</span><span class="sc">*</span>b3</span></code></pre></div>
<pre><code>## (Intercept) 
##    934.5378</code></pre>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="bootstrap-interval-estimation.html#cb421-1" aria-hidden="true" tabindex="-1"></a>b0<span class="sc">+</span><span class="dv">1500</span><span class="sc">*</span>b1</span></code></pre></div>
<pre><code>## (Intercept) 
##     417.871</code></pre>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="bootstrap-interval-estimation.html#cb423-1" aria-hidden="true" tabindex="-1"></a>b2<span class="sc">+</span><span class="dv">1800</span><span class="sc">*</span>b3</span></code></pre></div>
<pre><code>## waterfrontYes 
##      306.7251</code></pre>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="bootstrap-interval-estimation.html#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span>b3</span></code></pre></div>
<pre><code>## sqft_living:waterfrontYes 
##                  51.63483</code></pre>
<p><strong>Bootstrap Sample 3</strong></p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="bootstrap-interval-estimation.html#cb427-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(Houses , <span class="dv">100</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)  <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Id) <span class="sc">%&gt;%</span> </span>
<span id="cb427-2"><a href="bootstrap-interval-estimation.html#cb427-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Id, price, sqft_living, waterfront)   </span>
<span id="cb427-3"><a href="bootstrap-interval-estimation.html#cb427-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-4"><a href="bootstrap-interval-estimation.html#cb427-4" aria-hidden="true" tabindex="-1"></a>Mb3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample3, price <span class="sc">~</span> sqft_living <span class="sc">+</span> waterfront <span class="sc">+</span> sqft_living<span class="sc">:</span>waterfront) <span class="co"># fit linear model with interaction</span></span>
<span id="cb427-5"><a href="bootstrap-interval-estimation.html#cb427-5" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> Mb3<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="co"># record value of b0 (first coefficient)</span></span>
<span id="cb427-6"><a href="bootstrap-interval-estimation.html#cb427-6" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> Mb3<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="co"># record value of b1 (second coefficient)</span></span>
<span id="cb427-7"><a href="bootstrap-interval-estimation.html#cb427-7" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> Mb3<span class="sc">$</span>coefficients[<span class="dv">3</span>] <span class="co"># record value of b2 (third coefficient)</span></span>
<span id="cb427-8"><a href="bootstrap-interval-estimation.html#cb427-8" aria-hidden="true" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> Mb3<span class="sc">$</span>coefficients[<span class="dv">4</span>] <span class="co"># record value of b3 (fourth coefficient)</span></span>
<span id="cb427-9"><a href="bootstrap-interval-estimation.html#cb427-9" aria-hidden="true" tabindex="-1"></a>Mb3</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price ~ sqft_living + waterfront + sqft_living:waterfront, 
##     data = BootstrapSample3)
## 
## Coefficients:
##               (Intercept)                sqft_living  
##                   15.6004                     0.2456  
##             waterfrontYes  sqft_living:waterfrontYes  
##                  -85.2989                     0.3362</code></pre>
<p>We calculate each of the four desired quantities.</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="bootstrap-interval-estimation.html#cb429-1" aria-hidden="true" tabindex="-1"></a>b0<span class="sc">+</span><span class="dv">2000</span><span class="sc">*</span>b1 <span class="sc">+</span> b2 <span class="sc">+</span> <span class="dv">2000</span><span class="sc">*</span>b3</span></code></pre></div>
<pre><code>## (Intercept) 
##    1093.984</code></pre>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="bootstrap-interval-estimation.html#cb431-1" aria-hidden="true" tabindex="-1"></a>b0<span class="sc">+</span><span class="dv">1500</span><span class="sc">*</span>b1</span></code></pre></div>
<pre><code>## (Intercept) 
##    384.0153</code></pre>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="bootstrap-interval-estimation.html#cb433-1" aria-hidden="true" tabindex="-1"></a>b2<span class="sc">+</span><span class="dv">1800</span><span class="sc">*</span>b3</span></code></pre></div>
<pre><code>## waterfrontYes 
##      519.9176</code></pre>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="bootstrap-interval-estimation.html#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span>b3</span></code></pre></div>
<pre><code>## sqft_living:waterfrontYes 
##                  33.62314</code></pre>
<p>We’ll now take 10,000 different bootstrap samples and record the values of <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span>, <span class="math inline">\(b_3\)</span>, and <span class="math inline">\(b_4\)</span>, which we’ll then use to calculate each of our four desired quantities.</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="bootstrap-interval-estimation.html#cb437-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Houses, price<span class="sc">~</span>sqft_living <span class="sc">+</span> waterfront <span class="sc">+</span></span>
<span id="cb437-2"><a href="bootstrap-interval-estimation.html#cb437-2" aria-hidden="true" tabindex="-1"></a>          sqft_living<span class="sc">:</span>waterfront) <span class="co">#fit model to original sample</span></span>
<span id="cb437-3"><a href="bootstrap-interval-estimation.html#cb437-3" aria-hidden="true" tabindex="-1"></a>Sample_b0 <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="co"># record b0 value (second coefficient)</span></span>
<span id="cb437-4"><a href="bootstrap-interval-estimation.html#cb437-4" aria-hidden="true" tabindex="-1"></a>Sample_b1 <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="co"># record b1 value (second coefficient)</span></span>
<span id="cb437-5"><a href="bootstrap-interval-estimation.html#cb437-5" aria-hidden="true" tabindex="-1"></a>Sample_b2 <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">3</span>] <span class="co"># record b1 value (second coefficient)</span></span>
<span id="cb437-6"><a href="bootstrap-interval-estimation.html#cb437-6" aria-hidden="true" tabindex="-1"></a>Sample_b3 <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">4</span>] <span class="co"># record b1 value (second coefficient)</span></span>
<span id="cb437-7"><a href="bootstrap-interval-estimation.html#cb437-7" aria-hidden="true" tabindex="-1"></a>Sample_Q1 <span class="ot">&lt;-</span> Sample_b0 <span class="sc">+</span> <span class="dv">2000</span><span class="sc">*</span>Sample_b1 <span class="sc">+</span>Sample_b2<span class="sc">+</span><span class="dv">2000</span><span class="sc">*</span>Sample_b3 <span class="co"># calculate b0+2000b1+b2+2000b3</span></span>
<span id="cb437-8"><a href="bootstrap-interval-estimation.html#cb437-8" aria-hidden="true" tabindex="-1"></a>Sample_Q2 <span class="ot">&lt;-</span> Sample_b0 <span class="sc">+</span> <span class="dv">1500</span><span class="sc">*</span>Sample_b1 <span class="co"># calculate b0+1500b1+</span></span>
<span id="cb437-9"><a href="bootstrap-interval-estimation.html#cb437-9" aria-hidden="true" tabindex="-1"></a>Sample_Q3 <span class="ot">&lt;-</span> Sample_b2<span class="sc">+</span><span class="dv">1800</span><span class="sc">*</span>Sample_b3 <span class="co"># calculate b2+1800b3</span></span>
<span id="cb437-10"><a href="bootstrap-interval-estimation.html#cb437-10" aria-hidden="true" tabindex="-1"></a>Sample_Q4 <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span>Sample_b3 <span class="co"># calculate 100b3</span></span>
<span id="cb437-11"><a href="bootstrap-interval-estimation.html#cb437-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-12"><a href="bootstrap-interval-estimation.html#cb437-12" aria-hidden="true" tabindex="-1"></a>Bootstrap_b0 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">10000</span>)  <span class="co">#vector to store b0 values</span></span>
<span id="cb437-13"><a href="bootstrap-interval-estimation.html#cb437-13" aria-hidden="true" tabindex="-1"></a>Bootstrap_b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">10000</span>)  <span class="co">#vector to store b1 values</span></span>
<span id="cb437-14"><a href="bootstrap-interval-estimation.html#cb437-14" aria-hidden="true" tabindex="-1"></a>Bootstrap_b2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">10000</span>)  <span class="co">#vector to store b2 values</span></span>
<span id="cb437-15"><a href="bootstrap-interval-estimation.html#cb437-15" aria-hidden="true" tabindex="-1"></a>Bootstrap_b3 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">10000</span>)  <span class="co">#vector to store b3 values</span></span>
<span id="cb437-16"><a href="bootstrap-interval-estimation.html#cb437-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-17"><a href="bootstrap-interval-estimation.html#cb437-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-18"><a href="bootstrap-interval-estimation.html#cb437-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>){</span>
<span id="cb437-19"><a href="bootstrap-interval-estimation.html#cb437-19" aria-hidden="true" tabindex="-1"></a>BootstrapSample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(Houses, <span class="dv">1000</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)   <span class="co">#take bootstrap sample</span></span>
<span id="cb437-20"><a href="bootstrap-interval-estimation.html#cb437-20" aria-hidden="true" tabindex="-1"></a>Mb <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample, price <span class="sc">~</span> sqft_living <span class="sc">+</span> </span>
<span id="cb437-21"><a href="bootstrap-interval-estimation.html#cb437-21" aria-hidden="true" tabindex="-1"></a>           waterfront <span class="sc">+</span> sqft_living<span class="sc">:</span>waterfront) <span class="co"># fit linear model with interaction</span></span>
<span id="cb437-22"><a href="bootstrap-interval-estimation.html#cb437-22" aria-hidden="true" tabindex="-1"></a>Bootstrap_b0[i] <span class="ot">&lt;-</span> Mb<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="co"># record value of b0 (first coefficient)</span></span>
<span id="cb437-23"><a href="bootstrap-interval-estimation.html#cb437-23" aria-hidden="true" tabindex="-1"></a>Bootstrap_b1[i] <span class="ot">&lt;-</span> Mb<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="co"># record value of b1 (second coefficient)</span></span>
<span id="cb437-24"><a href="bootstrap-interval-estimation.html#cb437-24" aria-hidden="true" tabindex="-1"></a>Bootstrap_b2[i] <span class="ot">&lt;-</span> Mb<span class="sc">$</span>coefficients[<span class="dv">3</span>] <span class="co"># record value of b2 (third coefficient)</span></span>
<span id="cb437-25"><a href="bootstrap-interval-estimation.html#cb437-25" aria-hidden="true" tabindex="-1"></a>Bootstrap_b3[i] <span class="ot">&lt;-</span> Mb<span class="sc">$</span>coefficients[<span class="dv">4</span>] <span class="co"># record value of b3 (fourth coefficient)</span></span>
<span id="cb437-26"><a href="bootstrap-interval-estimation.html#cb437-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb437-27"><a href="bootstrap-interval-estimation.html#cb437-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-28"><a href="bootstrap-interval-estimation.html#cb437-28" aria-hidden="true" tabindex="-1"></a>Bootstrap_Q1 <span class="ot">&lt;-</span>  Bootstrap_b0 <span class="sc">+</span> <span class="dv">2000</span><span class="sc">*</span>Bootstrap_b1 <span class="sc">+</span> Bootstrap_b2 <span class="sc">+</span> <span class="dv">2000</span><span class="sc">*</span>Bootstrap_b3</span>
<span id="cb437-29"><a href="bootstrap-interval-estimation.html#cb437-29" aria-hidden="true" tabindex="-1"></a>Bootstrap_Q2 <span class="ot">&lt;-</span>  Bootstrap_b0 <span class="sc">+</span> <span class="dv">1500</span><span class="sc">*</span>Bootstrap_b1 </span>
<span id="cb437-30"><a href="bootstrap-interval-estimation.html#cb437-30" aria-hidden="true" tabindex="-1"></a>Bootstrap_Q3 <span class="ot">&lt;-</span>  Bootstrap_b2 <span class="sc">+</span> <span class="dv">1800</span><span class="sc">*</span>Bootstrap_b3</span>
<span id="cb437-31"><a href="bootstrap-interval-estimation.html#cb437-31" aria-hidden="true" tabindex="-1"></a>Bootstrap_Q4 <span class="ot">&lt;-</span>  <span class="dv">100</span><span class="sc">*</span>Bootstrap_b3</span>
<span id="cb437-32"><a href="bootstrap-interval-estimation.html#cb437-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-33"><a href="bootstrap-interval-estimation.html#cb437-33" aria-hidden="true" tabindex="-1"></a>Houses_Bootstrap_Results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Bootstrap_b0, Bootstrap_b1, Bootstrap_b2, Bootstrap_b3, Bootstrap_Q1, Bootstrap_Q2 , Bootstrap_Q3 , Bootstrap_Q4)  <span class="co">#save results as dataframe</span></span></code></pre></div>
<p><strong>Bootstrap Distribution for b_0 + 2000b_1 + b_2 + 2000b_3</strong></p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="bootstrap-interval-estimation.html#cb438-1" aria-hidden="true" tabindex="-1"></a>Houses_Bootstrap_Plot_Q1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Houses_Bootstrap_Results, </span>
<span id="cb438-2"><a href="bootstrap-interval-estimation.html#cb438-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">aes</span>(<span class="at">x=</span>Bootstrap_Q1)) <span class="sc">+</span>  </span>
<span id="cb438-3"><a href="bootstrap-interval-estimation.html#cb438-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb438-4"><a href="bootstrap-interval-estimation.html#cb438-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Expected Price of 2000 Sq. Ft. Waterfront House&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb438-5"><a href="bootstrap-interval-estimation.html#cb438-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>( <span class="st">&quot;Bootstrap Distribution b0+2000b1+b2+2000b3&quot;</span>) </span>
<span id="cb438-6"><a href="bootstrap-interval-estimation.html#cb438-6" aria-hidden="true" tabindex="-1"></a>Houses_Bootstrap_Plot_Q1</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-312-1.png" width="672" /></p>
<p>Standard Error:</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="bootstrap-interval-estimation.html#cb439-1" aria-hidden="true" tabindex="-1"></a>SE_Q1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(Houses_Bootstrap_Results<span class="sc">$</span>Bootstrap_Q1)</span>
<span id="cb439-2"><a href="bootstrap-interval-estimation.html#cb439-2" aria-hidden="true" tabindex="-1"></a>SE_Q1</span></code></pre></div>
<pre><code>## [1] 40.29367</code></pre>
<p>The bootstrap distribution is symmetric and bell-shaped, so we can use the standard error method to calculate a 95% confidence interval.</p>
<p>95% Confidence Interval:</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="bootstrap-interval-estimation.html#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(Sample_Q1 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_Q1, Sample_Q1 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_Q1) </span></code></pre></div>
<pre><code>## (Intercept) (Intercept) 
##    924.2863   1085.4610</code></pre>
<p>The 95% confidence interval is shown by the gold bar on the graph of the bootstrap distribution below.</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="bootstrap-interval-estimation.html#cb443-1" aria-hidden="true" tabindex="-1"></a>Houses_Bootstrap_Plot_Q1 <span class="sc">+</span> </span>
<span id="cb443-2"><a href="bootstrap-interval-estimation.html#cb443-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sample_Q1 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_Q1,<span class="at">xend=</span>Sample_Q1 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_Q1, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb443-3"><a href="bootstrap-interval-estimation.html#cb443-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;gold&quot;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-315-1.png" width="672" /></p>
<p>We are 95% confident that average price among all 2,000 square foot Seattle waterfront houses is between 924.2863407 and 1085.4610253 thousand dollars.</p>
<p><strong>Bootstrap Distribution for b_0 + 1500b_1</strong></p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="bootstrap-interval-estimation.html#cb444-1" aria-hidden="true" tabindex="-1"></a>Houses_Bootstrap_Plot_Q2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Houses_Bootstrap_Results, </span>
<span id="cb444-2"><a href="bootstrap-interval-estimation.html#cb444-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">aes</span>(<span class="at">x=</span>Bootstrap_Q2)) <span class="sc">+</span>  </span>
<span id="cb444-3"><a href="bootstrap-interval-estimation.html#cb444-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb444-4"><a href="bootstrap-interval-estimation.html#cb444-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Expected Price of 1500 Sq. Ft. Non-Waterfront House&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb444-5"><a href="bootstrap-interval-estimation.html#cb444-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>( <span class="st">&quot;Bootstrap Distribution b0+1500b1&quot;</span>) </span>
<span id="cb444-6"><a href="bootstrap-interval-estimation.html#cb444-6" aria-hidden="true" tabindex="-1"></a>Houses_Bootstrap_Plot_Q2</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-316-1.png" width="672" /></p>
<p>Standard Error:</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="bootstrap-interval-estimation.html#cb445-1" aria-hidden="true" tabindex="-1"></a>SE_Q2 <span class="ot">&lt;-</span> <span class="fu">sd</span>(Houses_Bootstrap_Results<span class="sc">$</span>Bootstrap_Q2)</span>
<span id="cb445-2"><a href="bootstrap-interval-estimation.html#cb445-2" aria-hidden="true" tabindex="-1"></a>SE_Q2</span></code></pre></div>
<pre><code>## [1] 5.859015</code></pre>
<p>The bootstrap distribution is symmetric and bell-shaped, so we can use the standard error method to calculate a 95% confidence interval.</p>
<p>95% Confidence Interval:</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="bootstrap-interval-estimation.html#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(Sample_Q2 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_Q2, Sample_Q2 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_Q2) </span></code></pre></div>
<pre><code>## (Intercept) (Intercept) 
##    383.2318    406.6679</code></pre>
<p>The 95% confidence interval is shown by the gold bar on the graph of the bootstrap distribution below.</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="bootstrap-interval-estimation.html#cb449-1" aria-hidden="true" tabindex="-1"></a>Houses_Bootstrap_Plot_Q2 <span class="sc">+</span> </span>
<span id="cb449-2"><a href="bootstrap-interval-estimation.html#cb449-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sample_Q2 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_Q2,<span class="at">xend=</span>Sample_Q2 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_Q2, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb449-3"><a href="bootstrap-interval-estimation.html#cb449-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;gold&quot;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-319-1.png" width="672" /></p>
<p>We are 95% confident that average price among all 1,500 square foot Seattle non-waterfront houses is between 383.2318261 and 406.6678858 thousand dollars.</p>
<p><strong>Bootstrap Distribution for b_2 + 1800b_3</strong></p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="bootstrap-interval-estimation.html#cb450-1" aria-hidden="true" tabindex="-1"></a>Houses_Bootstrap_Plot_Q3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Houses_Bootstrap_Results, </span>
<span id="cb450-2"><a href="bootstrap-interval-estimation.html#cb450-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">aes</span>(<span class="at">x=</span>Bootstrap_Q3)) <span class="sc">+</span>  </span>
<span id="cb450-3"><a href="bootstrap-interval-estimation.html#cb450-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb450-4"><a href="bootstrap-interval-estimation.html#cb450-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Expected Price Difference WF vs NWF for 1800 sq. Ft. House&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb450-5"><a href="bootstrap-interval-estimation.html#cb450-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>( <span class="st">&quot;Bootstrap Distribution b2+1800b3&quot;</span>) </span>
<span id="cb450-6"><a href="bootstrap-interval-estimation.html#cb450-6" aria-hidden="true" tabindex="-1"></a>Houses_Bootstrap_Plot_Q3</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-320-1.png" width="672" /></p>
<p>Standard Error:</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="bootstrap-interval-estimation.html#cb451-1" aria-hidden="true" tabindex="-1"></a>SE_Q3 <span class="ot">&lt;-</span> <span class="fu">sd</span>(Houses_Bootstrap_Results<span class="sc">$</span>Bootstrap_Q3)</span>
<span id="cb451-2"><a href="bootstrap-interval-estimation.html#cb451-2" aria-hidden="true" tabindex="-1"></a>SE_Q3</span></code></pre></div>
<pre><code>## [1] 40.66194</code></pre>
<p>The bootstrap distribution is symmetric and bell-shaped, so we can use the standard error method to calculate a 95% confidence interval.</p>
<p>95% Confidence Interval:</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="bootstrap-interval-estimation.html#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(Sample_Q3 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_Q3, Sample_Q3 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_Q3) </span></code></pre></div>
<pre><code>## waterfrontYes waterfrontYes 
##      332.8819      495.5297</code></pre>
<p>The 95% confidence interval is shown by the gold bar on the graph of the bootstrap distribution below.</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="bootstrap-interval-estimation.html#cb455-1" aria-hidden="true" tabindex="-1"></a>Houses_Bootstrap_Plot_Q3 <span class="sc">+</span> </span>
<span id="cb455-2"><a href="bootstrap-interval-estimation.html#cb455-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sample_Q3 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_Q3,<span class="at">xend=</span>Sample_Q3 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_Q3, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb455-3"><a href="bootstrap-interval-estimation.html#cb455-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;gold&quot;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-323-1.png" width="672" /></p>
<p>We are 95% confident that the average price among all 1800 square feet waterfront houses in Seattle is between 332.8818906 and 495.5296513 thousand dollars more than the average price among all non-waterfront houses of the same size.</p>
<p><strong>Bootstrap Distribution for 100b_3</strong></p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="bootstrap-interval-estimation.html#cb456-1" aria-hidden="true" tabindex="-1"></a>Houses_Bootstrap_Plot_Q4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Houses_Bootstrap_Results, </span>
<span id="cb456-2"><a href="bootstrap-interval-estimation.html#cb456-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">aes</span>(<span class="at">x=</span>Bootstrap_Q4)) <span class="sc">+</span>  </span>
<span id="cb456-3"><a href="bootstrap-interval-estimation.html#cb456-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb456-4"><a href="bootstrap-interval-estimation.html#cb456-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Expected Difference per 100 square feet&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb456-5"><a href="bootstrap-interval-estimation.html#cb456-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>( <span class="st">&quot;Bootstrap Distribution 100b3&quot;</span>) </span>
<span id="cb456-6"><a href="bootstrap-interval-estimation.html#cb456-6" aria-hidden="true" tabindex="-1"></a>Houses_Bootstrap_Plot_Q4</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-324-1.png" width="672" /></p>
<p>Standard Error:</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="bootstrap-interval-estimation.html#cb457-1" aria-hidden="true" tabindex="-1"></a>SE_Q4 <span class="ot">&lt;-</span> <span class="fu">sd</span>(Houses_Bootstrap_Results<span class="sc">$</span>Bootstrap_Q4)</span>
<span id="cb457-2"><a href="bootstrap-interval-estimation.html#cb457-2" aria-hidden="true" tabindex="-1"></a>SE_Q4</span></code></pre></div>
<pre><code>## [1] 2.224772</code></pre>
<p>The bootstrap distribution is symmetric and bell-shaped, so we can use the standard error method to calculate a 95% confidence interval.</p>
<p>95% Confidence Interval:</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="bootstrap-interval-estimation.html#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(Sample_Q4 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_Q4, Sample_Q4 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_Q4) </span></code></pre></div>
<pre><code>## sqft_living:waterfrontYes sqft_living:waterfrontYes 
##                  38.81716                  47.71625</code></pre>
<p>The 95% confidence interval is shown by the gold bar on the graph of the bootstrap distribution below.</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="bootstrap-interval-estimation.html#cb461-1" aria-hidden="true" tabindex="-1"></a>Houses_Bootstrap_Plot_Q4 <span class="sc">+</span> </span>
<span id="cb461-2"><a href="bootstrap-interval-estimation.html#cb461-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sample_Q4 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_Q4,<span class="at">xend=</span>Sample_Q4 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_Q4, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb461-3"><a href="bootstrap-interval-estimation.html#cb461-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;gold&quot;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-327-1.png" width="672" /></p>
<p>We are 95% confident that for each 100 square foot increase, the average price among all waterfront houses increases by between 38.8171639 and 47.7162531 thousand dollars more than the increase in average price among all non-waterfront.</p>
</div>
<div id="bootstrapping-cautions" class="section level3 hasAnchor" number="4.3.9">
<h3><span class="header-section-number">4.3.9</span> Bootstrapping Cautions<a href="bootstrap-interval-estimation.html#bootstrapping-cautions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While bootstrapping is a popular and robust procedure for calculating confidence intervals, it does have cautions and limitations. We should be sure to use the bootstrap procedure appropriate for our context. A standard-error bootstrap interval is appropriate when the sampling distribution for our statistic is roughly symmetric and bell-shaped. When this is not true, a percentile bootstrap interval can be used as long as there are no gaps or breaks in the bootstrap distribution. In situations where there are gaps and breaks in the bootstrap distribution, then the bootstrap distribution may not be a reasonable approximation of the sampling distribution we are interested in.</p>
</div>
</div>
<div id="estimating-standard-error" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Estimating Standard Error<a href="bootstrap-interval-estimation.html#estimating-standard-error" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="standard-error-vs-standard-deviation" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Standard Error vs Standard Deviation<a href="bootstrap-interval-estimation.html#standard-error-vs-standard-deviation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recall that standard error is the standard deviation of the distribution of a statistic (sample mean, proportion, regression coefficient, etc.). It describes the amount of variability in this statistic between samples of a given size.</p>
<p>This is different than the sample standard deviation, which pertains to the amount of variability between individuals in the sample.</p>
<p>For example, the histogram displays the distribution of mercury levels in our sample of 53 lakes in Florida.</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="bootstrap-interval-estimation.html#cb462-1" aria-hidden="true" tabindex="-1"></a>Lakes_Hist</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-328-1.png" width="672" /></p>
<p>Standard Deviation of Mercury Levels Between Lakes:</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="bootstrap-interval-estimation.html#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(FloridaLakes<span class="sc">$</span>Mercury)</span></code></pre></div>
<pre><code>## [1] 0.3410356</code></pre>
<p>The standard deviation in mercury levels between individual lakes is 0.341 ppm. This describes the amount of variability in mercury levels between individual lakes.</p>
<p>Bootstrap Distribution for Mean Mercury Level (<span class="math inline">\(n=53\)</span>)</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="bootstrap-interval-estimation.html#cb465-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Mean_Plot <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-330-1.png" width="672" /></p>
<p>Standard Error for Mean:</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="bootstrap-interval-estimation.html#cb466-1" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sd</span>(Lakes_Bootstrap_Results_Mean<span class="sc">$</span>Bootstrap_Mean); SE</span></code></pre></div>
<pre><code>## [1] 0.04655744</code></pre>
<p>The standard deviation in the distribution for mean mercury levels between different samples of 53 lakes is approximately 0.0465574 ppm. This describes the amount of variability in mean mercury levels between different samples of 53 lakes.</p>
<p>There is less variability in average among samples of size 53, than there is between mercury levels of individual lakes. Although mercury levels might vary quite a bit between individual lakes, in a sample of size 53, the higher and lower levels tend to average out to something in the middle, resulting in less variability associated with the average than with individual lakes.</p>
</div>
<div id="sample-size-and-standard-error" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Sample Size and Standard Error<a href="bootstrap-interval-estimation.html#sample-size-and-standard-error" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Question:</strong></p>
<p>Suppose the sample consisted of 10 lakes, or 30 lakes, or 100 lakes, instead of 53, and that the distribution of the lakes in the sample was otherwise similar to that of the original 53. Would you expect the mercury level of individual lakes to increase, decrease, or stay about the same? What about the standard error of the mean mercury level?</p>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-333-1.png" width="1152" /></p>
<p>The table shows the standard deviation in each of the samples.</p>
<table>
<thead>
<tr class="header">
<th align="right">Sample_Size</th>
<th align="right">SD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">10</td>
<td align="right">0.3831797</td>
</tr>
<tr class="even">
<td align="right">30</td>
<td align="right">0.3198103</td>
</tr>
<tr class="odd">
<td align="right">53</td>
<td align="right">0.3410356</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">0.3352758</td>
</tr>
</tbody>
</table>
<p>Sample size does not impact the amount of variability between individual lakes. Standard deviation in mercury levels between individual lakes does not systematically increase or decrease based on sample size (of course it varies a little based on the lakes randomly chosen in the sample).</p>
<p>Now, we’ll examine what happens to the standard error of the mean as the sample size changes.</p>
<p><strong>Distributions of Mean Between Different Samples</strong></p>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-336-1.png" width="1152" /></p>
<p>The table shows the standard error of the mean for samples of different size:</p>
<table>
<thead>
<tr class="header">
<th align="right">Sample_Size</th>
<th align="right">SE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">10</td>
<td align="right">0.1166601</td>
</tr>
<tr class="even">
<td align="right">30</td>
<td align="right">0.0579587</td>
</tr>
<tr class="odd">
<td align="right">53</td>
<td align="right">0.0465574</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">0.0331806</td>
</tr>
</tbody>
</table>
<p>As sample size increases, variability between means of different samples decreases. Standard error of the mean decreases. This is also true of standard errors for other statistics (i.e. difference in means, regression slopes, etc.)</p>
</div>
<div id="standard-error-formulas" class="section level3 hasAnchor" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> Standard Error Formulas<a href="bootstrap-interval-estimation.html#standard-error-formulas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So far, we’ve used simulation (permutation tests and bootstrap intervals) to determine the amount of variability associated with a test statistic or estimate, in order to perform hypotheses tests and create confidence intervals. In special situations, there are mathematical formulas, based on probability theory, that can be used to approximate the amount of variability without having to perform the simulations.</p>
<p>These approximations only exist for certain kinds of statistics, and they are only valid when the sampling distribution for the statistic is symmetric and bell-shaped. Thus, they cannot be used in all situations, and we should be careful to check whether they are appropriate before applying them. Nevertheless, when appropriate, they can allow us to bypass the computation required in a simulation.</p>
<p><strong>Theory-Based Standard Error Formulas</strong></p>
<table>
<colgroup>
<col width="64%" />
<col width="35%" />
</colgroup>
<thead>
<tr class="header">
<th>Scenario</th>
<th>Standard Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Single Mean</td>
<td><span class="math inline">\(SE(b_0)=\frac{s}{\sqrt{n}}\)</span></td>
</tr>
<tr class="even">
<td>Difference in Means</td>
<td><span class="math inline">\(SE(b_j)=s\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}\)</span></td>
</tr>
<tr class="odd">
<td>Single Proportion</td>
<td><span class="math inline">\(SE(\hat{p}) = \sqrt{\frac{\hat{p}(1-\hat{p})}{n}}\)</span></td>
</tr>
<tr class="even">
<td>Difference in Proportions</td>
<td><span class="math inline">\(SE(\hat{p}) = \sqrt{\left(\frac{\hat{p_1}(1-\hat{p}_1)}{n_1}+\frac{\hat{p_2}(1-\hat{p_2})}{n_2}\right)}\)</span></td>
</tr>
<tr class="odd">
<td>Intercept in Simple Linear Regression</td>
<td><span class="math inline">\(SE(b_0)=s\sqrt{\frac{1}{n}+\frac{\bar{x}^2}{\sum(x_i-\bar{x})^2}}\)</span></td>
</tr>
<tr class="even">
<td>Slope in Simple Linear Regression</td>
<td><span class="math inline">\(SE(b_1)=\sqrt{\frac{s^2}{\sum(x_i-\bar{x})^2}}=\sqrt{\frac{1}{n-2}\frac{{\sum(\hat{y}_i-y_i)^2}}{\sum(x_i-\bar{x})^2}}\)</span></td>
</tr>
</tbody>
</table>
<ul>
<li><p><span class="math inline">\(s=\sqrt{\frac{\displaystyle\sum_{i=1}^n(y_i-\hat{y}_i)^2}{(n-(p+1))}}\)</span>, (p is number of regression coefficients not including <span class="math inline">\(b_0\)</span>) is sample standard deviation. Note that in the one-sample case, this simplifies to the standard deviation formula we’ve seen previously.</p></li>
<li><p>In the 2nd formula, the standard error estimate <span class="math inline">\(s\sqrt{\frac{1}{n_1+n_2}}\)</span> is called a “pooled” estimate since it combines information from all groups. When there is reason to believe standard deviation differs between groups, we often use an “unpooled” standard error estimate of <span class="math inline">\(\sqrt{\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2}}\)</span>, where <span class="math inline">\(s_1, s_2\)</span> represent the standard deviation for groups 1 and 2.</p></li>
</ul>
<p>There is no theory-based formula for standard error associated with the median or standard deviation. For these, and many other statistics, we rely on simulation to estimate variability between samples.</p>
<p>There are formulas for standard errors associated with coefficients in multiple regression, but these require mathematics beyond what is assumed in this class. They involve linear algebra and matrix inversion, which you can read about <a href="https://web.stanford.edu/~mrosenfe/soc_meth_proj3/matrix_OLS_NYU_notes.pdf">here</a> if you are interested.</p>
</div>
<div id="one-sample-mean-example" class="section level3 hasAnchor" number="4.4.4">
<h3><span class="header-section-number">4.4.4</span> One-Sample Mean Example<a href="bootstrap-interval-estimation.html#one-sample-mean-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We use the first formula to calculate the standard error of the mean mercury concentration associated with samples of 53 lakes.</p>
<p><span class="math inline">\(SE(\bar{x})=\frac{s}{\sqrt{n}} = \frac{0.341}{\sqrt{53}}=0.04684\)</span></p>
<p>The calculation in R is shown below.</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="bootstrap-interval-estimation.html#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(FloridaLakes<span class="sc">$</span>Mercury)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">53</span>)</span></code></pre></div>
<pre><code>## [1] 0.04684485</code></pre>
<p>The standard error column in the R summary output is calculated using the theory-based formulas.</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="bootstrap-interval-estimation.html#cb470-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span><span class="dv">1</span>)</span>
<span id="cb470-2"><a href="bootstrap-interval-estimation.html#cb470-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Mercury ~ 1, data = FloridaLakes)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.48717 -0.25717 -0.04717  0.24283  0.80283 
## 
## Coefficients:
##             Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)  0.52717    0.04684   11.25 0.00000000000000151 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.341 on 52 degrees of freedom</code></pre>
<p>Let’s compare this to the standard error we obtained using 10,000 bootstrap simulations.</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="bootstrap-interval-estimation.html#cb472-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Mean_Plot</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-340-1.png" width="672" /></p>
<p>Bootstrap standard error:</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="bootstrap-interval-estimation.html#cb473-1" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sd</span>(Lakes_Bootstrap_Results_Mean<span class="sc">$</span>Bootstrap_Mean); SE</span></code></pre></div>
<pre><code>## [1] 0.04655744</code></pre>
<p>The theory-based formula gives a standard error estimate very close to the one we obtained via bootstrap simulation.</p>
</div>
<div id="difference-in-means-example" class="section level3 hasAnchor" number="4.4.5">
<h3><span class="header-section-number">4.4.5</span> Difference in Means Example<a href="bootstrap-interval-estimation.html#difference-in-means-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We use the probability-based formula to calculate the standard error for difference in means between 33 lakes in North Florida, and 20 lakes in South Florida</p>
<p><span class="math display">\[
SE(\bar{x}_1-\bar{x}_2)=s\sqrt{\frac{1}{n_1}+\frac{1}{n_2}},
\]</span></p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="bootstrap-interval-estimation.html#cb475-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(Lakes_M<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">53-2</span>))</span>
<span id="cb475-2"><a href="bootstrap-interval-estimation.html#cb475-2" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> s<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">20</span><span class="sc">+</span><span class="dv">1</span><span class="sc">/</span><span class="dv">33</span>); SE</span></code></pre></div>
<pre><code>## [1] 0.08984774</code></pre>
<p>R model summary output:</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="bootstrap-interval-estimation.html#cb477-1" aria-hidden="true" tabindex="-1"></a>Lakes_M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>Location)</span>
<span id="cb477-2"><a href="bootstrap-interval-estimation.html#cb477-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Lakes_M)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Mercury ~ Location, data = FloridaLakes)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.65650 -0.23455 -0.08455  0.24350  0.67545 
## 
## Coefficients:
##             Estimate Std. Error t value       Pr(&gt;|t|)    
## (Intercept)  0.42455    0.05519   7.692 0.000000000441 ***
## LocationS    0.27195    0.08985   3.027        0.00387 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3171 on 51 degrees of freedom
## Multiple R-squared:  0.1523, Adjusted R-squared:  0.1357 
## F-statistic: 9.162 on 1 and 51 DF,  p-value: 0.003868</code></pre>
<p>Comparison to Bootstrap standard error:</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="bootstrap-interval-estimation.html#cb479-1" aria-hidden="true" tabindex="-1"></a>NS_Lakes_Bootstrap_Plot_b1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>NS_Lakes_Bootstrap_Results, <span class="fu">aes</span>(<span class="at">x=</span>Bootstrap_b1)) <span class="sc">+</span>  </span>
<span id="cb479-2"><a href="bootstrap-interval-estimation.html#cb479-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb479-3"><a href="bootstrap-interval-estimation.html#cb479-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;b1 in Bootstrap Sample&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb479-4"><a href="bootstrap-interval-estimation.html#cb479-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Northern vs Southern Lakes: Bootstrap Distribution for b1&quot;</span>) </span>
<span id="cb479-5"><a href="bootstrap-interval-estimation.html#cb479-5" aria-hidden="true" tabindex="-1"></a>NS_Lakes_Bootstrap_Plot_b1 </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-344-1.png" width="672" /></p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="bootstrap-interval-estimation.html#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(NS_Lakes_Bootstrap_Results<span class="sc">$</span>Bootstrap_b1)</span></code></pre></div>
<pre><code>## [1] 0.09620419</code></pre>
<p>The mathematical standard error approximation is close to the one observed in our simulation, though not exact.</p>
</div>
<div id="regression-example" class="section level3 hasAnchor" number="4.4.6">
<h3><span class="header-section-number">4.4.6</span> Regression Example<a href="bootstrap-interval-estimation.html#regression-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We use the theory-based approach to calculate standard error associated with the slope of the regression line relating mercury level and pH in Florida lakes.</p>
<p><span class="math inline">\(SE(b_1)=\sqrt{\frac{s^2}{\sum(x_i-\bar{x})^2}}=\sqrt{\frac{1}{n-2}\frac{{\sum(\hat{y}_i-y_i)^2}}{\sum(x_i-\bar{x})^2}}\)</span></p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="bootstrap-interval-estimation.html#cb482-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>pH) <span class="co"># fit model</span></span>
<span id="cb482-2"><a href="bootstrap-interval-estimation.html#cb482-2" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(M<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">53-2</span>) <span class="co">#calculate s^2</span></span>
<span id="cb482-3"><a href="bootstrap-interval-estimation.html#cb482-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> FloridaLakes<span class="sc">$</span>pH</span>
<span id="cb482-4"><a href="bootstrap-interval-estimation.html#cb482-4" aria-hidden="true" tabindex="-1"></a>SSx <span class="ot">&lt;-</span> <span class="fu">sum</span>((x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">2</span>) <span class="co">#calculate denominator</span></span>
<span id="cb482-5"><a href="bootstrap-interval-estimation.html#cb482-5" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(s2<span class="sc">/</span>SSx) <span class="co"># calculate SE</span></span>
<span id="cb482-6"><a href="bootstrap-interval-estimation.html#cb482-6" aria-hidden="true" tabindex="-1"></a>SE</span></code></pre></div>
<pre><code>## [1] 0.03031326</code></pre>
<p>R model summary output:</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="bootstrap-interval-estimation.html#cb484-1" aria-hidden="true" tabindex="-1"></a>Lakes_M_pH <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>pH)</span>
<span id="cb484-2"><a href="bootstrap-interval-estimation.html#cb484-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Lakes_M_pH)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Mercury ~ pH, data = FloridaLakes)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.48895 -0.19188 -0.05774  0.09456  0.71134 
## 
## Coefficients:
##             Estimate Std. Error t value       Pr(&gt;|t|)    
## (Intercept)  1.53092    0.20349   7.523 0.000000000814 ***
## pH          -0.15230    0.03031  -5.024 0.000006572811 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2816 on 51 degrees of freedom
## Multiple R-squared:  0.3311, Adjusted R-squared:  0.318 
## F-statistic: 25.24 on 1 and 51 DF,  p-value: 0.000006573</code></pre>
<p>Comparison to bootstrap standard error:</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="bootstrap-interval-estimation.html#cb486-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Plot_Slope</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-348-1.png" width="672" /></p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="bootstrap-interval-estimation.html#cb487-1" aria-hidden="true" tabindex="-1"></a>SE_b1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(Lakes_Bootstrap_Slope_Results<span class="sc">$</span>Bootstrap_b1)</span>
<span id="cb487-2"><a href="bootstrap-interval-estimation.html#cb487-2" aria-hidden="true" tabindex="-1"></a>SE_b1</span></code></pre></div>
<pre><code>## [1] 0.02676588</code></pre>
<p>The mathematical standard error approximation is again close to the one observed in our simulation.</p>
</div>
<div id="theory-based-confidence-intervals" class="section level3 hasAnchor" number="4.4.7">
<h3><span class="header-section-number">4.4.7</span> Theory-Based Confidence Intervals<a href="bootstrap-interval-estimation.html#theory-based-confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If the sampling distribution for a statistic is symmetric and bell-shaped, we can obtain an approximate 95% confidence interval using the formula:</p>
<p><span class="math display">\[
\text{Statistic} \pm 2\times{\text{Standard Error}},
\]</span></p>
<p>where the standard error is calculated by formula, rather than via bootstrap simulations.</p>
<p>The <code>confint</code> command in R provides confidence intervals associate with each of the model parameters, which are calculated using the theory-based standard errors</p>
<p><strong>Confidence Intervals for N vs S Florida Lakes</strong></p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="bootstrap-interval-estimation.html#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(Lakes_M)</span></code></pre></div>
<pre><code>##                  2.5 %    97.5 %
## (Intercept) 0.31374083 0.5353501
## LocationS   0.09157768 0.4523314</code></pre>
<p><strong>Intercept Interval:</strong></p>
<p><span class="math inline">\(\approx 0.42455 \pm 2\times0.05519\)</span></p>
<p>We are 95% confident that the average mercury level among all lakes in North Florida is between 0.313 and 0.535 ppm.</p>
<p><strong>LocationS Interpretation</strong></p>
<p><span class="math inline">\(\approx -0.27195 \pm 2\times 0.08985\)</span></p>
<p>We are 95% confident that the average mercury level among all lakes in South Florida is between 0.09 and 0.45 ppm higher than the average mercury concentration among all lakes in North Florida.</p>
<p>Note that the use of 2 in the confidence interval formula is an approximation, though one that is reasonable and widely used. Rather than using 2, R uses a value very close to 2, which varies depending on the sample size. Thus R’s calculations will not exactly match the formulas shown, but are similar enough for practical purposes. Remember that in statistics, everything is an approximation.</p>
<p><strong>Confidence Intervals for pH and Mercury in Florida Lakes</strong></p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="bootstrap-interval-estimation.html#cb491-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(Lakes_M_pH)</span></code></pre></div>
<pre><code>##                  2.5 %      97.5 %
## (Intercept)  1.1223897  1.93944769
## pH          -0.2131573 -0.09144445</code></pre>
<p><strong>Intercept Interval:</strong></p>
<p><span class="math inline">\(\approx 1.53092 \pm 2\times 0.20349\)</span></p>
<p>We are 95% confident that the average mercury concentration among all lakes with pH level 0 is between 1.12 and 1.94 ppm. This is not a meaningful interpretation, since none of the lakes in our sample have a pH level anywhere close to 0.</p>
<p><strong>pH Interval</strong></p>
<p><span class="math inline">\(\approx -0.15230 \pm 2\times 0.03031\)</span></p>
<p>We are 95% confident that for each one-unit increase in pH, mercury level is expected to decrease between 0.09 and 0.21 ppm, on average.</p>
</div>
<div id="ci-method-comparison" class="section level3 hasAnchor" number="4.4.8">
<h3><span class="header-section-number">4.4.8</span> CI Method Comparison<a href="bootstrap-interval-estimation.html#ci-method-comparison" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ve now seen 3 different ways to obtain confidence intervals based on statistics calculated from data.</p>
<p>The table below tells us what must be true of the sampling distribution for a statistic in order to use each technique.</p>
<table>
<thead>
<tr class="header">
<th>Technique</th>
<th>No Gaps</th>
<th>Bell-Shaped</th>
<th>Known Formula for SE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bootstrap Percentile</td>
<td>x</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Bootstrap Standard Error</td>
<td>x</td>
<td>x</td>
<td></td>
</tr>
<tr class="odd">
<td>Theory-Based</td>
<td>x</td>
<td>x</td>
<td>x</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="hypothesis-testing-via-permutation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="normal-error-regression-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Stat255-LU/Notes/edit/master/04-Interval_Estimation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/Stat255-LU/Notes/blob/master/04-Interval_Estimation.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
